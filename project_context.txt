
# =================================================================
# Arquivo: .\.eslintrc.json
# =================================================================

{
  "extends": "next/core-web-vitals"
}


# =================================================================
# Arquivo: .\.gitignore
# =================================================================

# See https://help.github.com/articles/ignoring-files/ for more about ignoring files.

# dependencies
/node_modules
/.pnp
.pnp.js

# testing
/coverage

# next.js
/.next/
/out/

# production
/build

# misc
.DS_Store
*.pem

# debug
npm-debug.log*
yarn-debug.log*
yarn-error.log*

# local env files
.env*.local
.env

# vercel
.vercel

# typescript
*.tsbuildinfo
next-env.d.ts


# =================================================================
# Arquivo: .\Chat-widget.js
# =================================================================

// Chat Widget Script
(function() {
    // Create and inject styles
    const styles = `
        .n8n-chat-widget {
            --chat--color-primary: var(--n8n-chat-primary-color, #854fff);
            --chat--color-secondary: var(--n8n-chat-secondary-color, #6b3fd4);
            --chat--color-background: var(--n8n-chat-background-color, #ffffff);
            --chat--color-font: var(--n8n-chat-font-color, #333333);
            font-family: 'Geist Sans', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Open Sans', 'Helvetica Neue', sans-serif;
        }

        .n8n-chat-widget .chat-container {
            position: fixed;
            bottom: 20px;
            right: 20px;
            z-index: 1000;
            display: none;
            width: 380px;
            height: 600px;
            background: var(--chat--color-background);
            border-radius: 12px;
            box-shadow: 0 8px 32px rgba(133, 79, 255, 0.15);
            border: 1px solid rgba(133, 79, 255, 0.2);
            overflow: hidden;
            font-family: inherit;
        }

        .n8n-chat-widget .chat-container.position-left {
            right: auto;
            left: 20px;
        }

        .n8n-chat-widget .chat-container.open {
            display: flex;
            flex-direction: column;
        }

        .n8n-chat-widget .brand-header {
            padding: 16px;
            display: flex;
            align-items: center;
            gap: 12px;
            border-bottom: 1px solid rgba(133, 79, 255, 0.1);
            position: relative;
        }

        .n8n-chat-widget .close-button {
            position: absolute;
            right: 16px;
            top: 50%;
            transform: translateY(-50%);
            background: none;
            border: none;
            color: var(--chat--color-font);
            cursor: pointer;
            padding: 4px;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: color 0.2s;
            font-size: 20px;
            opacity: 0.6;
        }

        .n8n-chat-widget .close-button:hover {
            opacity: 1;
        }

        .n8n-chat-widget .brand-header img {
            width: 32px;
            height: 32px;
        }

        .n8n-chat-widget .brand-header span {
            font-size: 18px;
            font-weight: 500;
            color: var(--chat--color-font);
        }

        .n8n-chat-widget .new-conversation {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            padding: 20px;
            text-align: center;
            width: 100%;
            max-width: 300px;
        }

        .n8n-chat-widget .welcome-text {
            font-size: 24px;
            font-weight: 600;
            color: var(--chat--color-font);
            margin-bottom: 24px;
            line-height: 1.3;
        }

        .n8n-chat-widget .new-chat-btn {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
            width: 100%;
            padding: 16px 24px;
            background: linear-gradient(135deg, var(--chat--color-primary) 0%, var(--chat--color-secondary) 100%);
            color: white;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-size: 16px;
            transition: transform 0.3s;
            font-weight: 500;
            font-family: inherit;
            margin-bottom: 12px;
        }

        .n8n-chat-widget .new-chat-btn:hover {
            transform: scale(1.02);
        }

        .n8n-chat-widget .message-icon {
            width: 20px;
            height: 20px;
        }

        .n8n-chat-widget .response-text {
            font-size: 14px;
            color: var(--chat--color-font);
            opacity: 0.7;
            margin: 0;
        }

        .n8n-chat-widget .chat-interface {
            display: none;
            flex-direction: column;
            height: 100%;
        }

        .n8n-chat-widget .chat-interface.active {
            display: flex;
        }

        .n8n-chat-widget .chat-messages {
            flex: 1;
            overflow-y: auto;
            padding: 20px;
            background: var(--chat--color-background);
            display: flex;
            flex-direction: column;
        }

        .n8n-chat-widget .chat-message {
            padding: 12px 16px;
            margin: 8px 0;
            border-radius: 12px;
            max-width: 80%;
            word-wrap: break-word;
            font-size: 14px;
            line-height: 1.5;
        }

        .n8n-chat-widget .chat-message.user {
            background: linear-gradient(135deg, var(--chat--color-primary) 0%, var(--chat--color-secondary) 100%);
            color: white;
            align-self: flex-end;
            box-shadow: 0 4px 12px rgba(133, 79, 255, 0.2);
            border: none;
        }

        .n8n-chat-widget .chat-message.bot {
            background: var(--chat--color-background);
            border: 1px solid rgba(133, 79, 255, 0.2);
            color: var(--chat--color-font);
            align-self: flex-start;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.05);
        }

        .n8n-chat-widget .chat-input {
            padding: 16px;
            background: var(--chat--color-background);
            border-top: 1px solid rgba(133, 79, 255, 0.1);
            display: flex;
            gap: 8px;
        }

        .n8n-chat-widget .chat-input textarea {
            flex: 1;
            padding: 12px;
            border: 1px solid rgba(133, 79, 255, 0.2);
            border-radius: 8px;
            background: var(--chat--color-background);
            color: var(--chat--color-font);
            resize: none;
            font-family: inherit;
            font-size: 14px;
        }

        .n8n-chat-widget .chat-input textarea::placeholder {
            color: var(--chat--color-font);
            opacity: 0.6;
        }

        .n8n-chat-widget .chat-input button {
            background: linear-gradient(135deg, var(--chat--color-primary) 0%, var(--chat--color-secondary) 100%);
            color: white;
            border: none;
            border-radius: 8px;
            padding: 0 20px;
            cursor: pointer;
            transition: transform 0.2s;
            font-family: inherit;
            font-weight: 500;
        }

        .n8n-chat-widget .chat-input button:hover {
            transform: scale(1.05);
        }

        .n8n-chat-widget .chat-toggle {
            position: fixed;
            bottom: 20px;
            right: 20px;
            width: 60px;
            height: 60px;
            border-radius: 30px;
            background: linear-gradient(135deg, var(--chat--color-primary) 0%, var(--chat--color-secondary) 100%);
            color: white;
            border: none;
            cursor: pointer;
            box-shadow: 0 4px 12px rgba(133, 79, 255, 0.3);
            z-index: 999;
            transition: transform 0.3s;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .n8n-chat-widget .chat-toggle.position-left {
            right: auto;
            left: 20px;
        }

        .n8n-chat-widget .chat-toggle:hover {
            transform: scale(1.05);
        }

        .n8n-chat-widget .chat-toggle svg {
            width: 24px;
            height: 24px;
            fill: currentColor;
        }

        .n8n-chat-widget .chat-footer {
            padding: 8px;
            text-align: center;
            background: var(--chat--color-background);
            border-top: 1px solid rgba(133, 79, 255, 0.1);
        }

        .n8n-chat-widget .chat-footer a {
            color: var(--chat--color-primary);
            text-decoration: none;
            font-size: 12px;
            opacity: 0.8;
            transition: opacity 0.2s;
            font-family: inherit;
        }

        .n8n-chat-widget .chat-footer a:hover {
            opacity: 1;
        }
    `;

    // Load Geist font
    const fontLink = document.createElement('link');
    fontLink.rel = 'stylesheet';
    fontLink.href = 'https://cdn.jsdelivr.net/npm/geist@1.0.0/dist/fonts/geist-sans/style.css';
    document.head.appendChild(fontLink);

    // Inject styles
    const styleSheet = document.createElement('style');
    styleSheet.textContent = styles;
    document.head.appendChild(styleSheet);

    // Default configuration
    const defaultConfig = {
        webhook: {
            url: '',
            route: ''
        },
        branding: {
            logo: '',
            name: '',
            welcomeText: '',
            responseTimeText: '',
            poweredBy: {
                text: 'Powered by n8n',
                link: 'https://n8n.partnerlinks.io/m8a94i19zhqq?utm_source=nocodecreative.io'
            }
        },
        style: {
            primaryColor: '',
            secondaryColor: '',
            position: 'right',
            backgroundColor: '#ffffff',
            fontColor: '#333333'
        }
    };

    // Merge user config with defaults
    const config = window.ChatWidgetConfig ? 
        {
            webhook: { ...defaultConfig.webhook, ...window.ChatWidgetConfig.webhook },
            branding: { ...defaultConfig.branding, ...window.ChatWidgetConfig.branding },
            style: { ...defaultConfig.style, ...window.ChatWidgetConfig.style }
        } : defaultConfig;

    // Prevent multiple initializations
    if (window.N8NChatWidgetInitialized) return;
    window.N8NChatWidgetInitialized = true;

    let currentSessionId = '';

    // Create widget container
    const widgetContainer = document.createElement('div');
    widgetContainer.className = 'n8n-chat-widget';
    
    // Set CSS variables for colors
    widgetContainer.style.setProperty('--n8n-chat-primary-color', config.style.primaryColor);
    widgetContainer.style.setProperty('--n8n-chat-secondary-color', config.style.secondaryColor);
    widgetContainer.style.setProperty('--n8n-chat-background-color', config.style.backgroundColor);
    widgetContainer.style.setProperty('--n8n-chat-font-color', config.style.fontColor);

    const chatContainer = document.createElement('div');
    chatContainer.className = `chat-container${config.style.position === 'left' ? ' position-left' : ''}`;
    
    const newConversationHTML = `
        <div class="brand-header">
            <img src="${config.branding.logo}" alt="${config.branding.name}">
            <span>${config.branding.name}</span>
            <button class="close-button">√ó</button>
        </div>
        <div class="new-conversation">
            <h2 class="welcome-text">${config.branding.welcomeText}</h2>
            <button class="new-chat-btn">
                <svg class="message-icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
                    <path fill="currentColor" d="M20 2H4c-1.1 0-2 .9-2 2v18l4-4h14c1.1 0 2-.9 2-2V4c0-1.1-.9-2-2-2zm0 14H5.2L4 17.2V4h16v12z"/>
                </svg>
                Send us a message
            </button>
            <p class="response-text">${config.branding.responseTimeText}</p>
        </div>
    `;

    const chatInterfaceHTML = `
        <div class="chat-interface">
            <div class="brand-header">
                <img src="${config.branding.logo}" alt="${config.branding.name}">
                <span>${config.branding.name}</span>
                <button class="close-button">√ó</button>
            </div>
            <div class="chat-messages"></div>
            <div class="chat-input">
                <textarea placeholder="Type your message here..." rows="1"></textarea>
                <button type="submit">Send</button>
            </div>
            <div class="chat-footer">
                <a href="${config.branding.poweredBy.link}" target="_blank">${config.branding.poweredBy.text}</a>
            </div>
        </div>
    `;
    
    chatContainer.innerHTML = newConversationHTML + chatInterfaceHTML;
    
    const toggleButton = document.createElement('button');
    toggleButton.className = `chat-toggle${config.style.position === 'left' ? ' position-left' : ''}`;
    toggleButton.innerHTML = `
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
            <path d="M12 2C6.477 2 2 6.477 2 12c0 1.821.487 3.53 1.338 5L2.5 21.5l4.5-.838A9.955 9.955 0 0012 22c5.523 0 10-4.477 10-10S17.523 2 12 2zm0 18c-1.476 0-2.886-.313-4.156-.878l-3.156.586.586-3.156A7.962 7.962 0 014 12c0-4.411 3.589-8 8-8s8 3.589 8 8-3.589 8-8 8z"/>
        </svg>`;
    
    widgetContainer.appendChild(chatContainer);
    widgetContainer.appendChild(toggleButton);
    document.body.appendChild(widgetContainer);

    const newChatBtn = chatContainer.querySelector('.new-chat-btn');
    const chatInterface = chatContainer.querySelector('.chat-interface');
    const messagesContainer = chatContainer.querySelector('.chat-messages');
    const textarea = chatContainer.querySelector('textarea');
    const sendButton = chatContainer.querySelector('button[type="submit"]');

    function generateUUID() {
        return crypto.randomUUID();
    }

    async function startNewConversation() {
        currentSessionId = generateUUID();
        const data = [{
            action: "loadPreviousSession",
            sessionId: currentSessionId,
            route: config.webhook.route,
            metadata: {
                userId: ""
            }
        }];

        try {
            const response = await fetch(config.webhook.url, {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json'
                },
                body: JSON.stringify(data)
            });

            const responseData = await response.json();
            chatContainer.querySelector('.brand-header').style.display = 'none';
            chatContainer.querySelector('.new-conversation').style.display = 'none';
            chatInterface.classList.add('active');

            const botMessageDiv = document.createElement('div');
            botMessageDiv.className = 'chat-message bot';
            botMessageDiv.textContent = Array.isArray(responseData) ? responseData[0].output : responseData.output;
            messagesContainer.appendChild(botMessageDiv);
            messagesContainer.scrollTop = messagesContainer.scrollHeight;
        } catch (error) {
            console.error('Error:', error);
        }
    }

    async function sendMessage(message) {
        const messageData = {
            action: "sendMessage",
            sessionId: currentSessionId,
            route: config.webhook.route,
            chatInput: message,
            metadata: {
                userId: ""
            }
        };

        const userMessageDiv = document.createElement('div');
        userMessageDiv.className = 'chat-message user';
        userMessageDiv.textContent = message;
        messagesContainer.appendChild(userMessageDiv);
        messagesContainer.scrollTop = messagesContainer.scrollHeight;

        try {
            const response = await fetch(config.webhook.url, {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json'
                },
                body: JSON.stringify(messageData)
            });
            
            const data = await response.json();
            
            const botMessageDiv = document.createElement('div');
            botMessageDiv.className = 'chat-message bot';
            botMessageDiv.textContent = Array.isArray(data) ? data[0].output : data.output;
            messagesContainer.appendChild(botMessageDiv);
            messagesContainer.scrollTop = messagesContainer.scrollHeight;
        } catch (error) {
            console.error('Error:', error);
        }
    }

    newChatBtn.addEventListener('click', startNewConversation);
    
    sendButton.addEventListener('click', () => {
        const message = textarea.value.trim();
        if (message) {
            sendMessage(message);
            textarea.value = '';
        }
    });
    
    textarea.addEventListener('keypress', (e) => {
        if (e.key === 'Enter' && !e.shiftKey) {
            e.preventDefault();
            const message = textarea.value.trim();
            if (message) {
                sendMessage(message);
                textarea.value = '';
            }
        }
    });
    
    toggleButton.addEventListener('click', () => {
        chatContainer.classList.toggle('open');
    });

    // Add close button handlers
    const closeButtons = chatContainer.querySelectorAll('.close-button');
    closeButtons.forEach(button => {
        button.addEventListener('click', () => {
            chatContainer.classList.remove('open');
        });
    });
})();

# =================================================================
# Arquivo: .\components.json
# =================================================================

{
  "$schema": "https://ui.shadcn.com/schema.json",
  "style": "default",
  "rsc": true,
  "tsx": true,
  "tailwind": {
    "config": "tailwind.config.ts",
    "css": "app/globals.css",
    "baseColor": "neutral",
    "cssVariables": true,
    "prefix": ""
  },
  "aliases": {
    "components": "@/components",
    "utils": "@/lib/utils",
    "ui": "@/components/ui",
    "lib": "@/lib",
    "hooks": "@/hooks"
  }
}


# =================================================================
# Arquivo: .\extract code.py
# =================================================================

import os

# --- CONFIGURA√á√ÉO ---
ROOT_DIR = '.'
OUTPUT_FILE = 'project_context.txt'
FOLDERS_TO_IGNORE = {'node_modules', '.git', '.next', '.vscode', '__pycache__', 'out', 'build'}
FILES_TO_IGNORE = {'package-lock.json', '.env.local', OUTPUT_FILE}
EXTENSIONS_TO_IGNORE = {
    '.png', '.jpg', '.jpeg', '.gif', '.svg', '.ico',
    '.woff', '.woff2', '.ttf', '.eot', '.mp4', '.webm', '.lock'
}
# --- FIM DA CONFIGURA√á√ÉO ---

def extract_code():
    print("Iniciando a extra√ß√£o do c√≥digo...")
    with open(OUTPUT_FILE, 'w', encoding='utf-8', errors='ignore') as outfile:
        for root, dirs, files in os.walk(ROOT_DIR, topdown=True):
            # Remove as pastas ignoradas da lista de diret√≥rios a serem percorridos
            dirs[:] = [d for d in dirs if d not in FOLDERS_TO_IGNORE]
            
            for filename in files:
                if filename in FILES_TO_IGNORE:
                    continue
                
                if os.path.splitext(filename)[1].lower() in EXTENSIONS_TO_IGNORE:
                    continue

                filepath = os.path.join(root, filename)
                
                try:
                    with open(filepath, 'r', encoding='utf-8', errors='ignore') as infile:
                        content = infile.read()
                        
                        outfile.write(f"\n# =================================================================\n")
                        outfile.write(f"# Arquivo: {filepath}\n")
                        outfile.write(f"# =================================================================\n\n")
                        outfile.write(content)
                        outfile.write("\n")
                except Exception as e:
                    print(f"Erro ao ler o arquivo {filepath}: {e}")

    print(f"Processo conclu√≠do! Todo o c√≥digo foi salvo em \"{OUTPUT_FILE}\".")

if __name__ == '__main__':
    extract_code()

# =================================================================
# Arquivo: .\middleware.ts
# =================================================================

import { NextResponse } from 'next/server';
import type { NextRequest } from 'next/server';
import { createMiddlewareClient } from '@supabase/auth-helpers-nextjs';

export async function middleware(req: NextRequest) {
  const res = NextResponse.next();

  // --- Prote√ß√£o b√°sica para /admin ---
  if (
    req.nextUrl.pathname.startsWith("/admin") &&
    !req.nextUrl.pathname.startsWith("/admin/login")
  ) {
    const isAuthed = req.cookies.get("admin_authed")?.value === "true";

    if (!isAuthed) {
      return NextResponse.redirect(new URL("/admin/login", req.url));
    }
  }

  // --- Autentica√ß√£o Supabase para /dashboard ---
  const supabaseUrlConfigured = !!process.env.NEXT_PUBLIC_SUPABASE_URL;
  const supabaseKeyConfigured = !!process.env.NEXT_PUBLIC_SUPABASE_ANON_KEY;

  if (!supabaseUrlConfigured || !supabaseKeyConfigured) {
    if (process.env.NODE_ENV === 'development') {
      console.warn(
        'Supabase n√£o est√° configurado. Middleware pulado.'
      );
    } else {
      console.error(
        'ALERTA: Supabase URL ou Anon Key n√£o configurados no ambiente.'
      );
    }
    return res;
  }

  const supabase = createMiddlewareClient({ req, res });

  try {
    const {
      data: { session },
    } = await supabase.auth.getSession();

    if (session && (
      req.nextUrl.pathname === '/login' ||
      req.nextUrl.pathname === '/signup' ||
      req.nextUrl.pathname === '/forgot-password'
    )) {
      return NextResponse.redirect(new URL('/dashboard', req.url));
    }

    if (!session && req.nextUrl.pathname.startsWith('/dashboard')) {
      return NextResponse.redirect(new URL('/login', req.url));
    }

    return res;
  } catch (error) {
    console.error('Middleware error com Supabase:', error);
    return res;
  }
}

export const config = {
  matcher: [
    '/dashboard/:path*',
    '/login',
    '/signup',
    '/forgot-password',
    '/admin/:path*', // üëà protege /admin
  ],
};


# =================================================================
# Arquivo: .\next-env.d.ts
# =================================================================

/// <reference types="next" />
/// <reference types="next/image-types/global" />
/// <reference types="next/navigation-types/compat/navigation" />

// NOTE: This file should not be edited
// see https://nextjs.org/docs/app/building-your-application/configuring/typescript for more information.


# =================================================================
# Arquivo: .\next.config.js
# =================================================================

/** @type {import('next').NextConfig} */
const nextConfig = {
  eslint: {
    ignoreDuringBuilds: true,
  },
  images: { unoptimized: true },
  experimental: {
    optimizeCss: true,
  },
};

module.exports = nextConfig;

# =================================================================
# Arquivo: .\package.json
# =================================================================

{
  "name": "bloomed-dreams",
  "version": "0.1.0",
  "private": true,
  "scripts": {
    "dev": "next dev",
    "build": "next build",
    "start": "next start",
    "lint": "next lint"
  },
  "dependencies": {
    "@hookform/resolvers": "^3.3.4",
    "@n8n/chat": "^0.27.1",
    "@radix-ui/react-accordion": "^1.2.10",
    "@radix-ui/react-alert-dialog": "^1.1.13",
    "@radix-ui/react-aspect-ratio": "^1.1.6",
    "@radix-ui/react-avatar": "^1.1.9",
    "@radix-ui/react-checkbox": "^1.3.1",
    "@radix-ui/react-collapsible": "^1.1.10",
    "@radix-ui/react-context-menu": "^2.2.14",
    "@radix-ui/react-dialog": "^1.1.13",
    "@radix-ui/react-dropdown-menu": "^2.1.14",
    "@radix-ui/react-form": "^0.1.6",
    "@radix-ui/react-hover-card": "^1.1.13",
    "@radix-ui/react-label": "^2.1.6",
    "@radix-ui/react-menubar": "^1.1.14",
    "@radix-ui/react-navigation-menu": "^1.2.12",
    "@radix-ui/react-popover": "^1.1.13",
    "@radix-ui/react-progress": "^1.1.6",
    "@radix-ui/react-radio-group": "^1.3.6",
    "@radix-ui/react-scroll-area": "^1.2.8",
    "@radix-ui/react-select": "^2.2.4",
    "@radix-ui/react-separator": "^1.1.6",
    "@radix-ui/react-slider": "^1.3.4",
    "@radix-ui/react-slot": "^1.2.2",
    "@radix-ui/react-switch": "^1.2.4",
    "@radix-ui/react-tabs": "^1.1.11",
    "@radix-ui/react-toast": "^1.2.13",
    "@radix-ui/react-toggle": "^1.1.8",
    "@radix-ui/react-toggle-group": "^1.1.9",
    "@radix-ui/react-tooltip": "^1.2.6",
    "@radix-ui/react-visually-hidden": "^1.2.2",
    "@supabase/auth-helpers-nextjs": "^0.9.0",
    "@supabase/supabase-js": "^2.39.7",
    "@upstash/ratelimit": "^2.0.5",
    "@upstash/redis": "^1.34.9",
    "@vercel/analytics": "^1.5.0",
    "@vercel/kv": "^3.0.0",
    "@vercel/speed-insights": "^1.2.0",
    "@voiceflow/react-chat": "^1.0.0",
    "canvas-confetti": "^1.9.3",
    "class-variance-authority": "^0.7.0",
    "clsx": "^2.1.0",
    "cmdk": "^1.1.1",
    "date-fns": "^3.6.0",
    "embla-carousel-react": "^8.6.0",
    "framer-motion": "^11.0.3",
    "input-otp": "^1.4.2",
    "lucide-react": "^0.344.0",
    "next": "^14.2.28",
    "next-themes": "^0.2.1",
    "react": "^18.2.0",
    "react-day-picker": "^8.10.1",
    "react-dom": "^18.2.0",
    "react-hook-form": "^7.50.0",
    "react-markdown": "^10.1.0",
    "react-resizable-panels": "^3.0.1",
    "react-textarea-autosize": "^8.5.9",
    "recharts": "^2.15.3",
    "remark-gfm": "^4.0.1",
    "sonner": "^2.0.3",
    "tailwind-merge": "^2.2.1",
    "tailwindcss-animate": "^1.0.7",
    "uuid": "^11.1.0",
    "vaul": "^1.1.2",
    "zod": "^3.22.4",
    "zustand": "^5.0.6"
  },
  "devDependencies": {
    "@types/node": "^20.11.20",
    "@types/react": "^18.2.58",
    "@types/react-dom": "^18.2.19",
    "@types/uuid": "^10.0.0",
    "autoprefixer": "^10.4.17",
    "critters": "^0.0.23",
    "eslint": "^8.57.0",
    "eslint-config-next": "14.1.0",
    "postcss": "^8.4.35",
    "tailwindcss": "^3.4.1",
    "typescript": "^5.3.3"
  }
}


# =================================================================
# Arquivo: .\postcss.config.js
# =================================================================

module.exports = {
  plugins: {
    tailwindcss: {},
    autoprefixer: {},
  },
};


# =================================================================
# Arquivo: .\tailwind.config.ts
# =================================================================

import type { Config } from 'tailwindcss';

const config: Config = {
  darkMode: ["class"],
  content: [
    './pages/**/*.{ts,tsx}',
    './components/**/*.{ts,tsx}',
    './app/**/*.{ts,tsx}',
    './src/**/*.{ts,tsx}',
  ],
  theme: {
    container: {
      center: true,
      padding: "2rem",
      screens: {
        "2xl": "1400px",
      },
    },
    extend: {
      fontFamily: { // <--- ADICIONE ESTA SE√á√ÉO
        sans: ['var(--font-inter)', 'sans-serif'], 
        'display-cormorant': ['var(--font-cormorant-garamond)', 'serif'],
        'display-marcellus': ['var(--font-marcellus)', 'serif'],
        display: ['var(--font-manrope)', 'serif'],
      },
      fontSize: {
        '2xs': '0.625rem', // 10px
        '3xs': '0.55rem',   // 8px (novo, exemplo)
      },
      colors: {
        border: "hsl(var(--border))",
        input: "hsl(var(--input))",
        ring: "hsl(var(--ring))",
        background: "hsl(var(--background))",
        foreground: "hsl(var(--foreground))",
        primary: {
          DEFAULT: "hsl(var(--primary))",
          foreground: "hsl(var(--primary-foreground))",
        },
        secondary: {
          DEFAULT: "hsl(var(--secondary))",
          foreground: "hsl(var(--secondary-foreground))",
        },
        destructive: {
          DEFAULT: "hsl(var(--destructive))",
          foreground: "hsl(var(--destructive-foreground))",
        },
        muted: {
          DEFAULT: "hsl(var(--muted))",
          foreground: "hsl(var(--muted-foreground))",
        },
        accent: {
          DEFAULT: "hsl(var(--accent))",
          foreground: "hsl(var(--accent-foreground))",
        },
        popover: {
          DEFAULT: "hsl(var(--popover))",
          foreground: "hsl(var(--popover-foreground))",
        },
        card: {
          DEFAULT: "hsl(var(--card))",
          foreground: "hsl(var(--card-foreground))",
        },
      },
      borderRadius: {
        lg: "var(--radius)",
        md: "calc(var(--radius) - 2px)",
        sm: "calc(var(--radius) - 4px)",
      },
      animation: {
        'float': 'float 1.5s ease-in-out',
      },
    },
  },
  plugins: [require("tailwindcss-animate")],
};

export default config;

# =================================================================
# Arquivo: .\tsconfig.json
# =================================================================

{
  "compilerOptions": {
    "target": "es5",
    "lib": ["dom", "dom.iterable", "esnext"],
    "allowJs": true,
    "skipLibCheck": true,
    "strict": true,
    "noEmit": true,
    "esModuleInterop": true,
    "module": "esnext",
    "moduleResolution": "bundler",
    "resolveJsonModule": true,
    "isolatedModules": true,
    "jsx": "preserve",
    "incremental": true,
    "plugins": [
      {
        "name": "next"
      }
    ],
    "paths": {
      "@/*": ["./*"]
    }
  },
  "include": ["next-env.d.ts", "**/*.ts", "**/*.tsx", ".next/types/**/*.ts"],
  "exclude": ["node_modules"]
}


# =================================================================
# Arquivo: .\.bolt\config.json
# =================================================================

{
  "template": "nextjs-shadcn"
}


# =================================================================
# Arquivo: .\.bolt\ignore
# =================================================================

components/ui/*
hooks/use-toast.ts


# =================================================================
# Arquivo: .\.bolt\prompt
# =================================================================

For all designs I ask you to make, have them be beautiful, not cookie cutter. Make webpages that are fully featured and worthy for production.

When using client-side hooks (useState and useEffect) in a component that's being treated as a Server Component by Next.js, always add the "use client" directive at the top of the file.

Do not write code that will trigger this error: "Warning: Extra attributes from the server: %s%s""class,style"

By default, this template supports JSX syntax with Tailwind CSS classes, the shadcn/ui library, React hooks, and Lucide React for icons. Do not install other packages for UI themes, icons, etc unless absolutely necessary or I request them.

Use icons from lucide-react for logos.

Use stock photos from unsplash where appropriate, only valid URLs you know exist.


# =================================================================
# Arquivo: .\app\globals.css
# =================================================================

@tailwind base;
@tailwind components;
@tailwind utilities;
@import url('https://api.fontshare.com/v2/css?f[]=clash-display@600,700,400,300&display=swap');
@import url('https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap');

@layer base {
  :root {
    --background: 240 10% 3.9%;
    --foreground: 0 0% 98%;
    --card: 240 10% 3.9%;
    --card-foreground: 0 0% 98%;
    --popover: 240 10% 3.9%;
    --popover-foreground: 0 0% 98%;
    --primary: 252 100% 69%;
    --primary-foreground: 0 0% 98%;
    --secondary: 240 3.7% 15.9%;
    --secondary-foreground: 0 0% 98%;
    --muted: 240 3.7% 15.9%;
    --muted-foreground: 240 5% 64.9%;
    --accent: 240 3.7% 15.9%;
    --accent-foreground: 0 0% 98%;
    --destructive: 0 62.8% 30.6%;
    --destructive-foreground: 0 0% 98%;
    --border: 240 3.7% 15.9%;
    --input: 240 3.7% 15.9%;
    --ring: 252 100% 69%;
  }

  body {
    @apply antialiased overflow-x-hidden;
    font-family: 'Inter', system-ui, -apple-system, sans-serif;
    /* Fundo com profundidade (astro noir) */
    background:
      radial-gradient(1200px 800px at 18% -10%, #0b0720 0%, rgba(3,0,20,0.85) 55%),
      radial-gradient(900px 600px at 85% 120%, rgba(88,28,135,0.15) 0%, rgba(3,0,20,0) 60%),
      #030014;
  }

  /* Mobile scrolling melhorado */
  .mobile-scroll {
    -webkit-overflow-scrolling: touch;
    scrollbar-width: none;
    -ms-overflow-style: none;
  }
  .mobile-scroll::-webkit-scrollbar { display: none; }
}

/* Cart√£o base (matte, sem glow forte) */
.dashboard-card {
  @apply relative rounded-xl;
  border: 1px solid rgba(168,85,247,0.3); /* More visible purple border */
  background: rgba(5, 5, 18, 0.7); /* Slightly more opaque background */
  backdrop-filter: blur(6px);
  box-shadow: 0 8px 25px rgba(0,0,0,0.4); /* More pronounced shadow */
  transition: transform .22s cubic-bezier(0.2,0.6,0.2,1),
              box-shadow .22s cubic-bezier(0.2,0.6,0.2,1),
              border-color .22s ease;
}
.dashboard-card:hover {
  transform: translateY(-2px); /* Slightly more lift on hover */
  border-color: rgba(168,85,247,0.5); /* Brighter purple border on hover */
  box-shadow: 0 12px 35px rgba(0,0,0,0.5); /* Stronger shadow on hover */
}

/* Scrollbar sutil */
* { scrollbar-width: thin; scrollbar-color: rgb(30, 28, 41) #030014; }
*::-webkit-scrollbar { width: 6px; background-color: #030014; }
*::-webkit-scrollbar-track { background-color: #030014; }
*::-webkit-scrollbar-thumb { background-color: rgb(30, 28, 41); border-radius: 9999px; border: none; transition: background-color 0.2s ease; }
*::-webkit-scrollbar-thumb:hover { background-color: rgb(42, 40, 52); }

/* Mobile optimizations */
@media (max-width: 640px) {
  .dashboard-card { @apply p-4; }
  .stats-card { @apply p-3; }
}

/* Overlay para menus mobile (se usar) */
.mobile-menu-overlay { @apply fixed inset-0 bg-black/60 backdrop-blur-sm z-40 lg:hidden; animation: fadeIn 0.2s ease-out; }
@keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }

/* n8n Chat Widget (coment√°rios corrigidos) */
/* Header do chat */
.n8n-chat-widget .n8n-chat-header {
  background-color: #581c87; /* Dark Purple */
  color: #e9d5ff; /* Light Purple Text */
  border-bottom: 1px solid #a855f7; /* Medium Purple Border */
}
/* Bot√£o flutuante */
.n8n-chat-launcher {
  background-color: #9333ea !important; /* Medium Purple */
  box-shadow: 0 0 15px rgba(168, 85, 247, 0.5);
}
.n8n-chat-launcher:hover {
  background-color: #a855f7 !important; /* Lighter Purple */
  box-shadow: 0 0 25px rgba(168, 85, 247, 0.7);
}
.n8n-chat-launcher svg { fill: #ffffff !important; }
/* Mensagens do usu√°rio */
.n8n-chat-widget .n8n-chat-message-bubble.user {
  background-color: #9333ea; color: #ffffff;
}
/* Mensagens do agente */
.n8n-chat-widget .n8n-chat-message-bubble.agent {
  background-color: #581c87; color: #e9d5ff;
}

.depth-card {
  border: 1px solid rgba(168,85,247,0.3); /* More visible purple border */
  background: rgba(5, 5, 18, 0.7); /* Slightly more opaque background */
  backdrop-filter: blur(6px);
  box-shadow: 0 8px 25px rgba(0,0,0,0.4); /* More pronounced shadow */
  transition: transform .22s cubic-bezier(0.2,0.6,0.2,1),
              box-shadow .22s cubic-bezier(0.2,0.6,0.2,1),
              border-color .22s ease;
}
.depth-card:hover {
  transform: translateY(-2px); /* Slightly more lift on hover */
  box-shadow: 0 12px 35px rgba(0,0,0,0.5); /* Stronger shadow on hover */
  border-color: rgba(168,85,247,0.5); /* Brighter purple border on hover */
}

.glass-pill {
  background: rgba(255,255,255,0.05);
  border: 1px solid rgba(255,255,255,0.10);
  backdrop-filter: blur(6px);
}

.input-reset {
  background: transparent !important;
  border: 0 !important;
  outline: 0 !important;
  box-shadow: none !important;
}

/* --- Pill buttons (clean) --- */
.pill-btn {
  border: 1px solid rgba(255,255,255,0.10);
  background: rgba(255,255,255,0.05);
  backdrop-filter: blur(6px);
  height: 44px;
  padding: 0 16px;
  border-radius: 9999px;
  transition: background-color .15s ease, border-color .15s ease, transform .1s ease;
}
.pill-btn:hover {
  background: rgba(255,255,255,0.07);   /* s√≥ um tom acima */
  border-color: rgba(255,255,255,0.16); /* sem glow */
  transform: translateY(-1px);          /* lift sutil */
}
.pill-btn:active {
  transform: translateY(0);             /* sensa√ß√£o de ‚Äúclicado‚Äù */
}
.pill-btn:focus-visible {
  outline: none;
  box-shadow: 0 0 0 2px rgba(168,85,247,0.35); /* foco acess√≠vel, discreto */
}

.pill-btn.active-filter {
  background: rgba(168,85,247,0.15); /* Slightly more prominent background */
  border-color: rgba(168,85,247,0.4); /* Purple border */
  color: #e9d5ff; /* Lighter text color */
}

.pill-btn.active-filter:hover {
  background: rgba(168,85,247,0.2);
  border-color: rgba(168,85,247,0.5);
}

.custom-scrollbar {
  scrollbar-width: thin;
  scrollbar-color: rgb(30,28,41) #030014;
}
.custom-scrollbar::-webkit-scrollbar { width: 6px }
.custom-scrollbar::-webkit-scrollbar-track { background-color: #030014 }
.custom-scrollbar::-webkit-scrollbar-thumb {
  background-color: rgb(30,28,41); border-radius: 9999px;
}
.custom-scrollbar::-webkit-scrollbar-thumb:hover { background-color: rgb(42,40,52) }

.search-pill-bordered {
  @apply bg-black/40 border border-purple-500/30 backdrop-blur-sm shadow-inner;
}

/* Para os bot√µes de filtro */
.pill-btn-bordered {
  @apply h-11 px-4 rounded-full transition-colors duration-200;
  @apply bg-black/40 border border-purple-500/30 backdrop-blur-sm;
  @apply hover:bg-purple-500/10 hover:border-purple-500/50;
}

.pill-btn-bordered.active-filter {
  @apply bg-purple-500/15 border-purple-500/40 text-purple-100;
}

/* --- Dream Card Surface (sutil, sem mudar sizing) --- */
/* --- Dream Card Surface (sutil, sem mudar tamanho) --- */
.dream-surface {
  position: relative;
  background:
    linear-gradient(180deg, rgba(17,14,31,0.72) 0%, rgba(10,8,20,0.72) 100%);
  border: 1x solid rgba(168,85,247,0.18);
  box-shadow:
    inset 0 1px 0 rgba(255,255,255,0.04),
    0 8px 24px rgba(0,0,0,0.35);
  transition:
    border-color .2s ease,
    box-shadow .2s ease,
    transform .2s cubic-bezier(0.2,0.6,0.2,1);
}

.dream-surface::before {
  content: "";
  position: absolute;
  inset: 0;
  pointer-events: none;
  /* dois spotlights discretos */
  background:
    radial-gradient(120% 180% at 14% -10%, rgba(168,85,247,0.08) 0%, rgba(168,85,247,0) 40%),
    radial-gradient(120% 160% at 86% 120%, rgba(59,130,246,0.06) 0%, rgba(59,130,246,0) 45%);
  mix-blend-mode: screen;
  opacity: .8;
}

.dream-surface:hover {
  border-color: rgba(168,85,247,0.35);
  box-shadow:
    inset 0 1px 0 rgba(255,255,255,0.05),
    0 12px 32px rgba(0,0,0,0.45);
  transform: translateY(-1px);
} 

# =================================================================
# Arquivo: .\app\layout.tsx
# =================================================================

import type { Metadata } from 'next';
import { Inter, Marcellus, Cormorant_Garamond, Manrope } from 'next/font/google';
import { ThemeProvider } from '@/components/theme-provider';
import { AuthProvider } from '@/components/auth/auth-provider';
import { Analytics } from "@vercel/analytics/next"
import { SpeedInsights } from '@vercel/speed-insights/next';
import { cn } from '@/lib/utils';
import Script from 'next/script'; // <--- ADD THIS LINE
import './globals.css';

const inter = Inter({ subsets: ['latin'] });

const cormorantGaramond = Cormorant_Garamond({
  subsets: ['latin'],
  weight: ['400', '700'], // Escolha os pesos que voc√™ vai usar (ex: regular e bold)
  variable: '--font-cormorant-garamond', // Vari√°vel CSS para sua nova fonte display
});

const marcellus = Marcellus({
  subsets: ['latin'],
  weight: ['400'], // Marcellus no Google Fonts geralmente s√≥ oferece '400'
  variable: '--font-marcellus', // Vari√°vel CSS para sua nova fonte display
  display: 'swap', // Boa pr√°tica para performance
});

const manrope = Manrope({
  subsets: ['latin'],
  weight: ['200', '300', '400'], // Escolha os pesos que voc√™ vai usar (ex: regular e bold)
  variable: '--font-manrope', // Vari√°vel CSS para sua nova fonte display~
  display: 'swap',
});

export const metadata: Metadata = {
  title: 'bloomed dreams | Your Dream Interpreter',
  description: 'Unlock the mysteries of your dreams with AI-powered analysis',
};

export default async function RootLayout({
  children,
}: {
  children: React.ReactNode;
}) {
  return (
    <html lang="en" suppressHydrationWarning className={`${marcellus.variable} ${cormorantGaramond.variable} ${manrope.variable}`}>
      <body className={cn(inter.className, 'custom-scrollbar')}>
        <ThemeProvider
          attribute="class"
          defaultTheme="dark"
          enableSystem
          disableTransitionOnChange
        >
          <AuthProvider>
            {children}
          </AuthProvider>
        </ThemeProvider>
        <script
        id="n8n-chat-options"
        dangerouslySetInnerHTML={{
          __html: `
            window.n8nChatOptions = {
              // IMPORTANT: Paste your Agent ID here!
              agentId: 'YOUR_N8N_AGENT_ID_HERE',

              // --- Optional Basic Theme Settings ---
              // theme: {
              //    primaryColor: '#9333ea', // Example: A purple color
              //    font: { family: 'inherit' }
              // }
              // --- End Optional Basic Theme ---
            };
          `,
        }}
      />
      <Script
        strategy="lazyOnload" // Loads the script after the page is interactive
        src="https://cdn.jsdelivr.net/npm/@n8n/chat/dist/esm/chat.mjs"
      />
      {/* END: n8n Chat Widget Code */}
      <SpeedInsights />
      <Analytics /> 
      </body>
    </html>
  );
}

# =================================================================
# Arquivo: .\app\manifest.json
# =================================================================

{
  "name": "Bloomed Dreams",
  "short_name": "Bloomed",
  "icons": [
    {
      "src": "/web-app-manifest-192x192.png",
      "sizes": "192x192",
      "type": "image/png",
      "purpose": "maskable"
    },
    {
      "src": "/web-app-manifest-512x512.png",
      "sizes": "512x512",
      "type": "image/png",
      "purpose": "maskable"
    }
  ],
  "theme_color": "#000000",
  "background_color": "#000000",
  "display": "standalone"
}

# =================================================================
# Arquivo: .\app\page.tsx
# =================================================================

// FILE: src/app/page.tsx
'use client';

import { useState, useEffect, useCallback, useRef } from 'react';
import Link from 'next/link';
import { Button } from '@/components/ui/button';
import { PageBackground } from '@/components/page-background';
import { Logo } from '@/components/brand/logo';
import { motion } from 'framer-motion';
import { cn } from '@/lib/utils';
import { ChatWidget, ChatToggleButton } from '@/components/chat/chat-widget';
import { useAuth } from '@/components/auth/auth-provider';
import { ArrowRight, MoonStar, User } from 'lucide-react';
import {
  Drawer,
  DrawerContent,
  DrawerTrigger,
  DrawerHeader,
  DrawerTitle,
  DrawerDescription,
} from "@/components/ui/drawer";
import TextareaAutosize from 'react-textarea-autosize';

export default function Home() {
  const { user, loading } = useAuth();
  const [dream, setDream] = useState('');
  const [isChatOpen, setIsChatOpen] = useState(false);
  const [dreamToPass, setDreamToPass] = useState<string | null>(null);
  
  const observerRef = useRef<MutationObserver | null>(null);

  // ===== A SOLU√á√ÉO FINAL COM MutationObserver =====
  useEffect(() => {
    // Seleciona os elementos "flutuantes" que precisam ser sincronizados.
    const chatToggle = document.querySelector('.chat-toggle') as HTMLElement | null;
    const portalButton = document.getElementById('portal-button-container');

    // A fun√ß√£o que ser√° chamada sempre que o 'style' do body mudar.
    const handleMutation = () => {
      // L√™ o padding que a 'vaul' aplicou. Se n√£o houver, ser√° uma string vazia.
      const bodyPaddingRight = document.body.style.paddingRight;
      
      // Aplica o MESMO padding como uma margem ou padding aos elementos flutuantes.
      if (chatToggle) {
        chatToggle.style.marginRight = bodyPaddingRight;
      }
      if (portalButton) {
        portalButton.style.paddingRight = bodyPaddingRight;
      }
    };

    // Cria o observador que chama nossa fun√ß√£o quando o atributo 'style' do body muda.
    const observer = new MutationObserver(handleMutation);
    observerRef.current = observer;

    // Come√ßa a observar.
    observer.observe(document.body, {
      attributes: true, // Queremos saber sobre mudan√ßas de atributos
      attributeFilter: ['style'], // Especificamente o atributo 'style'
    });

    // Fun√ß√£o de limpeza: para de observar quando o componente √© desmontado.
    return () => {
      if (observerRef.current) {
        observerRef.current.disconnect();
      }
    };
  }, []); // O array vazio [] garante que este efeito rode apenas uma vez.

  async function handleInterpret() {
    const trimmedDream = dream.trim();
    if (!trimmedDream) return;
    setDreamToPass(trimmedDream);
    setIsChatOpen(true);
    setDream('');
  }

  useEffect(() => { if (isChatOpen && dreamToPass) { const timer = setTimeout(() => setDreamToPass(null), 150); return () => clearTimeout(timer); } }, [isChatOpen, dreamToPass]);
  useEffect(() => { if (!isChatOpen && dreamToPass !== null) { setDreamToPass(null); } }, [isChatOpen, dreamToPass]);
  const handleCloseChat = useCallback(() => setIsChatOpen(false), []);

  const portalButtonBaseClasses = "bg-purple-500/10 border border-purple-500/20 text-purple-200 hover:bg-purple-500/20 rounded-full flex items-center justify-center transition-all duration-300";

  return (
    <PageBackground>
      
      {/* Adicionamos um ID para que nosso useEffect possa encontr√°-lo */}
      <div id="portal-button-container" className="absolute top-0 right-0 p-4 sm:p-6 z-20">
        <motion.div initial={{ opacity: 0, scale: 0.5 }} animate={{ opacity: 1, scale: 1 }} transition={{ duration: 0.5, delay: 0.2 }}>
          {!loading && (
            user ? (
              <Link href="/dashboard">
                <Button className={cn(portalButtonBaseClasses, "px-3 sm:px-4 py-2")}>
                  <User className="h-4 w-4 sm:mr-2" />
                  <span className="hidden sm:inline text-xs">Dashboard</span>
                </Button>
              </Link>
            ) : (
              // O Drawer agora controla seu pr√≥prio estado interno.
              <Drawer>
                <DrawerTrigger asChild>
                  <Button className={cn(portalButtonBaseClasses, "px-3 sm:px-4 py-2")}>
                    <User className="h-4 w-4 sm:mr-2" />
                    <span className="hidden sm:inline text-xs">Login / Sign Up</span>
                  </Button>
                </DrawerTrigger>
                <DrawerContent className="bg-[#080b1d]/90 backdrop-blur-md border-purple-500/20">
                  <DrawerHeader className="sr-only">
                    <DrawerTitle>Where dreams begin to bloom.</DrawerTitle>
                    <DrawerDescription>Create an account or log in to access your dream journal.</DrawerDescription>
                  </DrawerHeader>
                  <div className="mx-auto w-full max-w-sm text-center py-8 px-4">
                    <div className="flex flex-col items-center gap-5"> 
                      <MoonStar className="w-10 h-10 text-purple-300" />
                      <div className="space-y-3">
                        <h2 className="text-2xl font-medium text-purple-100 font-display-marcellus">
                          Where dreams begin to bloom.
                        </h2>
                        <p className="text-sm text-purple-300/80 leading-relaxed font-sans font-light px-2">
                          More than a dream journal.
                          <br />
                          A personal guide that learns your unique dream language.
                          <br />
                          Self-knowledge begins here.
                        </p>
                      </div>
                      <div className="w-full space-y-3 pt-4">
                        <Link href="/signup" className="w-full">
                          {/* ===== BOT√ÉO PRINCIPAL REFINADO ===== */}
                          <Button className="w-full bg-purple-600 hover:bg-purple-500 transform hover:scale-[1.03] transition-all duration-500 shadow-lg hover:shadow-purple-500/25 rounded-full">
                            Begin My Journey
                          </Button>
                        </Link>
                        <Link href="/login" className="w-full">
                          {/* ===== BOT√ÉO SECUND√ÅRIO REFINADO ===== */}
                          <Button 
                            variant="ghost" 
                            className="w-full text-purple-300 hover:text-purple-100 hover:bg-purple-500/10 rounded-full transition-all duration-500 hover:scale-[1.03]"
                          >
                            Returning Dreamer? Log In
                          </Button>
                        </Link>
                      </div>
                    </div>
                  </div>
                </DrawerContent>
              </Drawer>
            )
          )}
        </motion.div>
      </div>

      <div className="relative z-10 max-w-4xl mx-auto px-4 flex flex-col min-h-screen pt-6 pb-28 items-center text-center justify-center">
        <motion.div initial={{ opacity: 0, y: -20 }} animate={{ opacity: 1, y: 0 }} transition={{ duration: 0.8 }} className="mb-12 flex flex-col items-center">
          <Logo />
        </motion.div>

        <div className="w-full max-w-3xl mx-auto">
          <motion.div initial={{ opacity: 0, y: 20 }} animate={{ opacity: 1, y: 0 }} transition={{ duration: 0.8, delay: 0.2 }} className="mb-10">
            <h2 className={cn("text-[26px] sm:text-3xl md:text-4xl lg:text-[42px]", "leading-snug md:leading-tight", "tracking-wide text-gray-200/90 font-light font-display")}>
              Your dreams are encrypted messages.<br />We help you decode them.
            </h2>
          </motion.div>

          <motion.div initial={{ opacity: 0, y: 20 }} animate={{ opacity: 1, y: 0 }} transition={{ duration: 0.8, delay: 0.5 }} className="w-full max-w-md mx-auto space-y-4">
            <TextareaAutosize
              value={dream}
              onChange={(e) => setDream(e.target.value)}
              placeholder="Describe your dream here, in any language..."
              minRows={5}
              className={cn(
              "w-full resize-none rounded-2xl p-4 sm:p-5 text-white placeholder:text-purple-200/60",
              "bg-purple-950/20 backdrop-blur-sm border border-purple-400/20 shadow-lg shadow-purple-500/10",
              "transition-all duration-300 focus:outline-none focus:ring-2 focus:ring-purple-400/70 focus:border-transparent focus:bg-purple-950/40 focus:shadow-purple-500/20",
              "text-sm font-light leading-relaxed")} onKeyDown={(e) => { if (e.key === 'Enter' && !e.shiftKey) { e.preventDefault(); handleInterpret(); } }} />
            <div className="mt-6">
              <Button onClick={handleInterpret} disabled={dream.trim() === ''} className="w-full bg-purple-700 hover:bg-purple-700 py-3 font-medium transition-all duration-300 shadow-[0_0_15px_rgba(168,85,247,0.5)] hover:shadow-[0_0_25px_rgba(168,85,247,0.7)] bg-purple-900/50 disabled:bg-purple-900/30 disabled:text-purple-300/50 disabled:shadow-none disabled:cursor-not-allowed">
                Decode my Dream
              </Button>
            </div>
            <div className="text-center space-y-1 pt-4">
              <p className="text-center text-2xs text-purple-300/80">AI + Jungian Psychology</p>
              <p className="text-center text-2xs text-purple-300/80">No login required. No tracking. Just meaning.</p>
            </div>
          </motion.div>
        </div>
      </div>

      {!isChatOpen && (<ChatToggleButton onClick={() => { setDreamToPass(null); setIsChatOpen(true); }} />)}
      <ChatWidget isOpenProp={isChatOpen} onClose={handleCloseChat} initialDream={dreamToPass} />
      <script dangerouslySetInnerHTML={{ __html: ` document.addEventListener('DOMContentLoaded', function() { const adjustViewport = () => { const vh = window.innerHeight * 0.01; document.documentElement.style.setProperty('--vh', \`\${vh}px\`); }; window.addEventListener('resize', adjustViewport); adjustViewport(); }); ` }} />
    </PageBackground>
  );
}

# =================================================================
# Arquivo: .\app\(auth)\layout.tsx
# =================================================================

// Em: app/(auth)/layout.tsx
"use client";

import { PageBackground } from '@/components/page-background';

export default function AuthLayout({
  children,
}: {
  children: React.ReactNode;
}) {
  // Este layout agora apenas cria o fundo e centraliza o conte√∫do.
  // A logo e o card ser√£o responsabilidade dos componentes filhos (LoginForm, SignupForm).
  return (
    <PageBackground>
      <div className="flex flex-col items-center justify-center min-h-screen p-4">
        <div className="max-w-sm w-full bg-black/40 backdrop-blur-sm p-6 sm:p-8 rounded-2xl border border-white/10 shadow-2xl shadow-purple-500/10">
          {children}
        </div>
      </div>
    </PageBackground>
  );
}

# =================================================================
# Arquivo: .\app\(auth)\forgot-password\page.tsx
# =================================================================

"use client";

import { ForgotPasswordForm } from '@/components/auth/forgot-password-form';

export default function ForgotPasswordPage() {
  return <ForgotPasswordForm />;
}

# =================================================================
# Arquivo: .\app\(auth)\login\page.tsx
# =================================================================

"use client";

import { LoginForm } from '@/components/auth/login-form';

export default function LoginPage() {
  return <LoginForm />;
}

# =================================================================
# Arquivo: .\app\(auth)\signup\page.tsx
# =================================================================

"use client";

import { SignupForm } from '@/components/auth/signup-form';

export default function SignupPage() {
  return <SignupForm />;
}

# =================================================================
# Arquivo: .\app\(dashboard)\layout.tsx
# =================================================================

// ARQUIVO FINAL E CORRIGIDO: app/(dashboard)/layout.tsx

"use client";

import { useEffect } from 'react';
import { useRouter } from 'next/navigation';
import { useAuth } from '@/components/auth/auth-provider';
import { DashboardLayout } from '@/components/layouts/dashboard-layout';
// 1. Importar AMBOS os componentes do chat: o widget e o bot√£o flutuante
import { ChatWidget, ChatToggleButton } from '@/components/chat/chat-widget'; 
import { useChatWidget } from '@/hooks/use-chat-widget';

export default function DashboardRootLayout({
  children,
}: {
  children: React.ReactNode;
}) {
  const { user, loading } = useAuth();
  const router = useRouter();
  // 2. Obter 'isOpen' e 'onOpen' para controlar a visibilidade de ambos os componentes
  const { isOpen, onOpen, onClose } = useChatWidget();

  useEffect(() => {
    if (!loading && !user) {
      router.replace('/login');
    }
  }, [user, loading, router]);

  if (loading || !user) {
    return null;
  }

  return (
    <DashboardLayout>
      {children}

      {/* O widget principal do chat (a janela), que fica escondido at√© 'isOpen' ser true */}
      <ChatWidget
        isOpenProp={isOpen}
        onClose={onClose}
      />

      {/* 
        3. A L√ìGICA ADICIONADA:
        Renderiza o bot√£o flutuante SOMENTE se a janela do chat N√ÉO estiver aberta.
        Quando clicado, ele chama a fun√ß√£o 'onOpen' para abrir o widget.
      */}
      {!isOpen && (
        <ChatToggleButton onClick={onOpen} />
      )}
    </DashboardLayout>
  );
}

# =================================================================
# Arquivo: .\app\(dashboard)\dashboard\page.tsx
# =================================================================

// app/(dashboard)/dashboard/page.tsx (DEPOIS - SIMPLES E CORRETO)

"use client";

import { DreamJournal } from '@/components/journal/dream-journal';
import { motion } from 'framer-motion';

export default function DashboardPage() {
  // A p√°gina volta a ter uma √∫nica responsabilidade:
  // mostrar a √°rea de conte√∫do principal, que √© o Journal.
  return (
    <motion.div
      initial={{ opacity: 0 }}
      animate={{ opacity: 1 }}
      transition={{ duration: 0.5 }}
    >
      <DreamJournal />
    </motion.div>
  );
}

# =================================================================
# Arquivo: .\app\(dashboard)\dashboard\decoder\page.tsx
# =================================================================

"use client";

import { useState } from 'react';
import { BackgroundEffects } from '@/components/background-effects';
import { Textarea } from '@/components/ui/textarea';
import { Button } from '@/components/ui/button';
import { useToast } from '@/hooks/use-toast';

export default function DecoderPage() {
  const [dream, setDream] = useState('');
  const [interpretation, setInterpretation] = useState<string | null>(null);
  const [loading, setLoading] = useState(false);
  const { toast } = useToast();

  const handleDecodeDream = async () => {
    if (!dream.trim()) {
      toast({
        title: 'Input Missing',
        description: 'Please enter your dream before decoding.',
        variant: 'destructive',
      });
      return;
    }

    setLoading(true);
    setInterpretation(null); // Clear previous interpretation

    try {
      const response = await fetch('/api/interpret-dream', {
        method: 'POST',
        headers: {
          'Content-Type': 'application/json',
        },
        body: JSON.stringify({ dream }),
      });

      if (!response.ok) {
        const errorData = await response.json();
        throw new Error(errorData.error || 'Failed to decode dream');
      }

      const data = await response.json();
      setInterpretation(data.interpretation);

    } catch (error: any) {
      toast({
        title: 'Decoding Failed',
        description: error.message,
        variant: 'destructive',
      });
      setInterpretation(`Error: ${error.message}`); // Display error in interpretation area
    } finally {
      setLoading(false);
    }
  };

  return (
    <>
      <BackgroundEffects />
      <div className="space-y-8 relative z-10">
        <div className="space-y-2">
          <h1 className="text-3xl font-bold tracking-tight bg-clip-text text-transparent bg-gradient-to-r from-violet-200 to-purple-200">
            Dream Decoder
          </h1>
          <p className="text-lg text-violet-200/80">
            Uncover patterns and insights from your dreams
          </p>
        </div>

        <div className="bg-black/40 backdrop-blur-sm rounded-lg border border-white/5 p-8 space-y-4">
          <div>
            <Textarea
              placeholder="Enter your dream here..."
              value={dream}
              onChange={(e) => setDream(e.target.value)}
              rows={8}
              className="bg-white/5 border-white/10 text-violet-100 placeholder:text-violet-200/50 focus:border-purple-500"
            />
          </div>
          <Button
            onClick={handleDecodeDream}
            disabled={loading}
            className="w-full bg-purple-600 hover:bg-purple-700 text-white"
          >
            {loading ? 'Decoding...' : 'Decode My Dream'}
          </Button>

          <div className="mt-4">
            <h2 className="text-xl font-semibold text-violet-200 mb-2">Interpretation:</h2>
            <div className="bg-white/5 border border-white/10 rounded-md p-4 text-violet-100 min-h-[100px] whitespace-pre-wrap">
              {loading ? (
                <p className="text-purple-200/60">Getting interpretation...</p>
              ) : interpretation ? (
                interpretation
              ) : (
                <p className="text-purple-200/60">Your dream analysis insights will appear here</p>
              )}
            </div>
          </div>
        </div>
      </div>
    </>
  );
}


# =================================================================
# Arquivo: .\app\(dashboard)\dashboard\journal\page.tsx
# =================================================================

"use client";

import { DreamJournal } from '@/components/journal/dream-journal';

export default function JournalPage() {
  return <DreamJournal />;
}

# =================================================================
# Arquivo: .\app\(dashboard)\dashboard\path\page.tsx
# =================================================================

"use client";

import { BackgroundEffects } from '@/components/background-effects';

export default function PathPage() {
  return (
    <>
      <BackgroundEffects />
      <div className="space-y-8 relative z-10">
        <div className="space-y-2">
          <h1 className="text-3xl font-bold tracking-tight bg-clip-text text-transparent bg-gradient-to-r from-violet-200 to-purple-200">
            Blooming Path
          </h1>
          <p className="text-lg text-violet-200/80">
            Track your dream journey progress
          </p>
        </div>

        <div className="bg-black/40 backdrop-blur-sm rounded-lg border border-white/5 p-8">
          <div className="text-center">
            <p className="text-purple-200/60">
              Your achievements and progress will be shown here
            </p>
          </div>
        </div>
      </div>
    </>
  );
}

# =================================================================
# Arquivo: .\app\(dashboard)\dashboard\space\page.tsx
# =================================================================

"use client";

import { BackgroundEffects } from '@/components/background-effects';

export default function SpacePage() {
  return (
    <>
      <BackgroundEffects />
      <div className="space-y-8 relative z-10">
        <div className="space-y-2">
          <h1 className="text-3xl font-bold tracking-tight bg-clip-text text-transparent bg-gradient-to-r from-violet-200 to-purple-200">
            My Space
          </h1>
          <p className="text-lg text-violet-200/80">
            Manage your account and preferences
          </p>
        </div>

        <div className="bg-black/40 backdrop-blur-sm rounded-lg border border-white/5 p-8">
          <div className="text-center">
            <p className="text-purple-200/60">
              Your account settings and preferences will appear here
            </p>
          </div>
        </div>
      </div>
    </>
  );
}

# =================================================================
# Arquivo: .\app\admin\dashboard\page.tsx
# =================================================================

// FILE: src/app/admin/dashboard/page.tsx
"use client";

import React, { useEffect, useState } from "react";
import { Card, CardContent, CardHeader, CardTitle } from "@/components/ui/card";
import { Skeleton } from "@/components/ui/skeleton";
import { Button } from "@/components/ui/button";
import { RefreshCw, User, MessageSquare, AlertTriangle, ListChecks, ZapOff } from "lucide-react"; // Adicionado ZapOff para rate limit
import { cn } from "@/lib/utils";

interface Metrics {
  totalUniqueUsers: number;
  totalMessages: number;
  totalErrors: number;
  totalWaitlist: number;
  totalRateLimited: number; // Nova m√©trica
}

export default function AdminDashboard() {
  const [data, setData] = useState<Metrics | null>(null);
  const [loading, setLoading] = useState(false);
  const [error, setError] = useState<string | null>(null);

  const fetchMetrics = async () => {
    setLoading(true);
    setError(null);
    try {
      const res = await fetch("/api/admin/metrics");
      if (!res.ok) {
        const errorBody = await res.json().catch(() => ({ message: `Request failed: ${res.status}` }));
        throw new Error(errorBody.message || `Request failed: ${res.status}`);
      }
      const json: Metrics = await res.json();
      setData(json);
    } catch (e: any) {
      setError(e.message || "Failed to fetch metrics");
      setData(null); // Limpar dados em caso de erro para n√£o mostrar dados antigos
    } finally {
      setLoading(false);
    }
  };

  useEffect(() => {
    fetchMetrics();
  }, []);

  const Item = ({
    label,
    value,
    icon: Icon,
    iconColorClass = "text-primary", // Cor padr√£o pode ser ajustada
   }: {
    label: string;
    value: number;
    icon?: React.ElementType; // LucideReact.LucideIcon ou similar
    iconColorClass?: string;
   }) => (
    <Card className="shadow-lg">
      <CardHeader className="flex flex-row items-center justify-between space-y-0 pb-2">
        <CardTitle className="text-sm font-medium text-muted-foreground">
          {label}
        </CardTitle>
        {Icon && <Icon className={cn("h-5 w-5 text-muted-foreground", iconColorClass)} />}
      </CardHeader>
      <CardContent>
        {loading ? (
          <Skeleton className="h-10 w-24 rounded-md" /> // Ajustado tamanho do skeleton
        ) : (
          <div className="text-3xl font-bold">{value?.toLocaleString() ?? "0"}</div> // Formatado e com fallback
        )}
      </CardContent>
    </Card>
  );

  return (
    <main className="max-w-4xl mx-auto p-6 space-y-6">
      <div className="flex items-center justify-between">
        <h1 className="text-2xl font-bold">Dream Decoder ¬∑ Admin Dashboard</h1>
        <Button
          variant="outline" // Mudei para outline para menos destaque
          size="icon"
          onClick={fetchMetrics}
          disabled={loading}
          className={cn(loading && "animate-spin")}
          aria-label="Refresh metrics"
        >
          <RefreshCw className="w-5 h-5" />
        </Button>
      </div>

      {error && (
        <div className="text-red-600 bg-red-100 border border-red-400 rounded-md p-3 text-sm">
          <strong>Error:</strong> {error}
        </div>
      )}

      <section className="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4"> {/* Ajustado para lg:grid-cols-3 */}
        <Item label="Unique Users" value={data?.totalUniqueUsers || 0} icon={User} />
        <Item label="Total Messages" value={data?.totalMessages || 0} icon={MessageSquare} />
        <Item label="Rate Limited" value={data?.totalRateLimited || 0} icon={ZapOff} iconColorClass="text-yellow-500" />
        <Item label="Errors" value={data?.totalErrors || 0} icon={AlertTriangle} iconColorClass="text-red-500" />
        <Item label="Waitlist" value={data?.totalWaitlist || 0} icon={ListChecks} />
        {/* Voc√™ pode adicionar mais itens ou reorganizar */}
      </section>
    </main>
  );
}

# =================================================================
# Arquivo: .\app\admin\login\page.tsx
# =================================================================

"use client";

import { useState } from "react";
import { useRouter } from "next/navigation";

export default function AdminLogin() {
  const [password, setPassword] = useState("");
  const [error, setError] = useState("");
  const router = useRouter();

  const handleSubmit = async (e: React.FormEvent) => {
    e.preventDefault();
    setError("");

    const res = await fetch("/api/admin/login", {
      method: "POST",
      headers: { "Content-Type": "application/json" },
      body: JSON.stringify({ password }),
    });

    if (res.ok) {
      router.push("/admin/dashboard");
    } else {
      setError("Senha incorreta");
    }
  };

  return (
    <main className="flex flex-col items-center justify-center min-h-screen p-6">
      <form onSubmit={handleSubmit} className="w-full max-w-sm space-y-4">
        <h1 className="text-xl font-bold text-center">Login do Admin</h1>
        <input
          type="password"
          placeholder="Senha"
          value={password}
          onChange={(e) => setPassword(e.target.value)}
          className="w-full border border-gray-300 rounded px-3 py-2"
        />
        {error && <p className="text-sm text-red-600">{error}</p>}
        <button
          type="submit"
          className="w-full bg-black text-white py-2 rounded hover:bg-gray-900"
        >
          Entrar
        </button>
      </form>
    </main>
  );
}


# =================================================================
# Arquivo: .\app\api\admin\login\route.ts
# =================================================================

// FILE: src/app/api/admin/login/route.ts
import { NextResponse } from "next/server";

export async function POST(req: Request) {
  const { password } = await req.json();

  if (password !== process.env.ADMIN_PASSWORD) {
    return NextResponse.json({ error: "Unauthorized" }, { status: 401 });
  }

  const res = NextResponse.json({ success: true });
  res.cookies.set("admin_authed", "true", {
    httpOnly: true,
    path: "/",
    secure: process.env.NODE_ENV === "production",
    sameSite: "strict",
    maxAge: 60 * 60 * 6, // 6 horas
  });

  return res;
}


# =================================================================
# Arquivo: .\app\api\admin\metrics\route.ts
# =================================================================

// FILE: src/app/api/admin/metrics/route.ts (ou onde estiver seu arquivo de m√©tricas)
import { NextResponse } from "next/server";
import { Redis } from '@upstash/redis';

const redis = new Redis({
  url: process.env.UPSTASH_REDIS_REST_URL!,
  token: process.env.UPSTASH_REDIS_REST_TOKEN!,
});

const REDIS_KEY_UNIQUE_USERS_SET = "dreamchat:users";
const REDIS_KEY_TOTAL_MESSAGES = "dreamchat:total_messages";
const REDIS_KEY_TOTAL_ERRORS = "dreamchat:total_errors";
const REDIS_KEY_WAITLIST_SET = "dreamchat:waitlist"; // Assumindo que waitlist √© um SET
const REDIS_KEY_RATE_LIMITED_REQUESTS = 'dreamchat:total_rate_limited'; // Nova chave

export async function GET() {
  try {
    const [
        users,
        messages,
        errors,
        waitlist,
        rateLimited // Adicionada nova m√©trica
    ] = await Promise.all([
      redis.scard(REDIS_KEY_UNIQUE_USERS_SET),
      redis.get<number>(REDIS_KEY_TOTAL_MESSAGES) || 0,
      redis.get<number>(REDIS_KEY_TOTAL_ERRORS) || 0,
      redis.scard(REDIS_KEY_WAITLIST_SET) || 0, // Se waitlist for um contador simples, use .get()
      redis.get<number>(REDIS_KEY_RATE_LIMITED_REQUESTS) || 0, // Buscar nova m√©trica
    ]);

    return NextResponse.json({
      totalUniqueUsers: users,
      totalMessages: Number(messages),
      totalErrors: Number(errors),
      totalWaitlist: waitlist,
      totalRateLimited: Number(rateLimited), // Incluir nova m√©trica
    });
  } catch (error) {
      console.error("Erro ao buscar m√©tricas do Redis:", error);
      return NextResponse.json({ error: "Falha ao buscar m√©tricas" }, { status: 500 });
  }
}

# =================================================================
# Arquivo: .\app\api\dream\route.ts
# =================================================================

import { NextResponse } from 'next/server';
import { Ratelimit } from '@upstash/ratelimit';
import { Redis } from '@upstash/redis';
import { createRouteHandlerClient } from '@supabase/auth-helpers-nextjs';
import { cookies } from 'next/headers';
import { analyzeDreamInput } from '@/lib/services/ai-services';

let redis: Redis | null = null;
let ratelimitHour: Ratelimit | null = null;
let ratelimitDay: Ratelimit | null = null;

const REDIS_KEY_TOTAL_MESSAGES = 'dreamchat:total_messages';
const REDIS_KEY_TOTAL_ERRORS = 'dreamchat:total_errors';
const REDIS_KEY_UNIQUE_USERS_SET = 'dreamchat:users';

if (process.env.UPSTASH_REDIS_REST_URL && process.env.UPSTASH_REDIS_REST_TOKEN) {
  try {
    redis = new Redis({
      url: process.env.UPSTASH_REDIS_REST_URL,
      token: process.env.UPSTASH_REDIS_REST_TOKEN,
    });

    ratelimitHour = new Ratelimit({
      redis,
      limiter: Ratelimit.slidingWindow(5, '1h'),
      analytics: true,
      prefix: 'ratelimit_dream_api_handler_hourly_v2',
    });

    ratelimitDay = new Ratelimit({
      redis,
      limiter: Ratelimit.slidingWindow(10, '1d'),
      analytics: true,
      prefix: 'ratelimit_dream_api_handler_daily_v2',
    });
  } catch (error) {
    console.error('[Upstash] Failed to initialize Redis/Ratelimit:', error);
  }
} else {
  console.warn('[Upstash] Redis env vars not configured. Metrics/rate-limit disabled.');
}

const N8N_INTERNAL_WEBHOOK_URL = process.env.N8N_INTERNAL_WEBHOOK_URL;

async function safeRedisIncr(key: string) {
  if (!redis) return;
  try {
    await redis.incr(key);
  } catch (error) {
    console.error(`[Redis] Failed to increment key "${key}". Continuing.`, error);
  }
}

async function safeRedisTrackMessage(sessionId: string) {
  if (!redis) return;
  try {
    const pipeline = redis.pipeline();
    pipeline.sadd(REDIS_KEY_UNIQUE_USERS_SET, sessionId);
    pipeline.incr(REDIS_KEY_TOTAL_MESSAGES);
    await pipeline.exec();
  } catch (error) {
    console.error('[Redis] Metrics pipeline failed. Continuing.', error);
  }
}

export async function POST(request: Request) {
  const supabase = createRouteHandlerClient({ cookies });

  if (!N8N_INTERNAL_WEBHOOK_URL) {
    console.error('[Config] N8N_INTERNAL_WEBHOOK_URL is not configured.');
    await safeRedisIncr(REDIS_KEY_TOTAL_ERRORS);
    return NextResponse.json({ error: 'Internal server configuration error.' }, { status: 500 });
  }

  try {
    const body = await request.json();
    const { dreamText, timestamp, sessionId } = body ?? {};

    if (!dreamText || typeof dreamText !== 'string' || dreamText.trim().length === 0) {
      await safeRedisIncr(REDIS_KEY_TOTAL_ERRORS);
      return NextResponse.json({ error: 'Dream text cannot be empty.' }, { status: 400 });
    }

    let session: Awaited<ReturnType<typeof supabase.auth.getSession>>['data']['session'] | null = null;
    try {
      const { data } = await supabase.auth.getSession();
      session = data?.session ?? null;
    } catch (error) {
      console.error('[Supabase] getSession failed. Continuing without session.', error);
      session = null;
    }

    const [n8nResult, analysisResult] = await Promise.allSettled([
      fetch(N8N_INTERNAL_WEBHOOK_URL, {
        method: 'POST',
        headers: { 'Content-Type': 'application/json', Accept: 'application/json' },
        body: JSON.stringify({ dreamText, timestamp, sessionId }),
      }),
      analyzeDreamInput(dreamText),
    ]);

    if (n8nResult.status === 'rejected') {
      console.error('[Core] n8n request failed:', n8nResult.reason);
      await safeRedisIncr(REDIS_KEY_TOTAL_ERRORS);
      return NextResponse.json({ error: 'n8n core service is unavailable.' }, { status: 502 });
    }

    if (analysisResult.status === 'rejected') {
      console.error('[Core] LLM analysis failed:', analysisResult.reason);
      await safeRedisIncr(REDIS_KEY_TOTAL_ERRORS);
      return NextResponse.json({ error: 'LLM core analysis failed.' }, { status: 502 });
    }

    const n8nResponse = n8nResult.value;

    if (!n8nResponse.ok) {
      const errorText = await n8nResponse.text().catch(() => '');
      console.error(`[Core] n8n failed with status ${n8nResponse.status}: ${errorText}`);
      await safeRedisIncr(REDIS_KEY_TOTAL_ERRORS);
      return NextResponse.json({ error: `n8n failed ${n8nResponse.status}` }, { status: 502 });
    }

    let interpretation = '';
    try {
      const n8nData = await n8nResponse.json();
      interpretation = n8nData?.output ?? '';
    } catch (error) {
      console.error('[Core] Failed to parse n8n response JSON:', error);
      await safeRedisIncr(REDIS_KEY_TOTAL_ERRORS);
      return NextResponse.json({ error: 'Invalid n8n response format.' }, { status: 502 });
    }

    const dreamAnalysis = analysisResult.value;
    let savedDreamData = null;

    if (dreamAnalysis.isDream && session) {
      try {
        const { data: newDream, error: dbError } = await supabase
          .from('dreams')
          .insert({
            user_id: session.user.id,
            content: dreamText,
            interpretation,
            title: dreamAnalysis.title,
            mood: dreamAnalysis.mood,
            tags: dreamAnalysis.tags,
          })
          .select()
          .single();

        if (dbError) {
          console.error('[Supabase] Failed to save dream. Continuing without persistence:', dbError);
        } else {
          savedDreamData = newDream;
        }
      } catch (error) {
        console.error('[Supabase] Exception while saving dream. Continuing.', error);
      }
    }

    if (sessionId && typeof sessionId === 'string') {
      await safeRedisTrackMessage(sessionId);
    }

    return NextResponse.json(
      {
        interpretation,
        savedDream: savedDreamData,
      },
      { status: 200 },
    );
  } catch (error) {
    console.error('[API /dream] Unexpected handler error:', error);
    await safeRedisIncr(REDIS_KEY_TOTAL_ERRORS);
    return NextResponse.json({ error: 'An unexpected error occurred on the server.' }, { status: 500 });
  }
}


# =================================================================
# Arquivo: .\app\api\join-waitlist\route.ts
# =================================================================

// FILE: app/api/join-waitlist/route.ts
import { NextResponse } from 'next/server';
import { Redis } from '@upstash/redis'; // Voc√™ j√° instalou isso para o rate limiter

// Vari√°veis para o cliente Redis (escopo do m√≥dulo)
let redisClient: Redis | null = null;

// Tenta inicializar o cliente Redis UMA VEZ quando este m√≥dulo √© carregado
// (em ambientes serverless, isso pode rodar em cada "cold start" da fun√ß√£o)
if (process.env.UPSTASH_REDIS_REST_URL && process.env.UPSTASH_REDIS_REST_TOKEN) {
  try {
    redisClient = new Redis({
      url: process.env.UPSTASH_REDIS_REST_URL,
      token: process.env.UPSTASH_REDIS_REST_TOKEN,
    });
    console.log("Cliente Upstash Redis inicializado para /api/join-waitlist");
  } catch (error) {
    console.error("Falha ao inicializar cliente Upstash Redis para /api/join-waitlist:", error);
  }
} else {
  console.warn(
    'Vari√°veis de ambiente do Upstash Redis n√£o configuradas. API /api/join-waitlist n√£o poder√° salvar emails.'
  );
}

export async function POST(request: Request) {
  // Verifica se o cliente Redis foi inicializado com sucesso
  if (!redisClient) {
    console.error("Servi√ßo de armazenamento (Redis) n√£o est√° configurado ou falhou ao inicializar.");
    return NextResponse.json({ error: 'Service not available. Please try again later.' }, { status: 503 });
  }

  try {
    const body = await request.json();
    const { email } = body;

    // Valida√ß√£o b√°sica do email
    if (!email || typeof email !== 'string' || !/\S+@\S+\.\S+/.test(email)) {
      return NextResponse.json({ error: 'A valid email address is required.' }, { status: 400 });
    }

    // Nome da chave no Redis onde os emails ser√£o armazenados (um conjunto)
    const redisKeyForWaitlist = 'dreamchat:waitlist';

    // Adiciona o email ao conjunto no Redis
    // O comando 'sadd' adiciona o membro ao conjunto.
    // Retorna 1 se o membro foi adicionado, 0 se o membro j√° existia.
    const result = await redisClient.sadd(redisKeyForWaitlist, email);

    if (result === 1) {
      console.log(`Email ${email} adicionado √† lista de espera (${redisKeyForWaitlist}).`);
    } else {
      console.log(`Email ${email} j√° estava na lista de espera (${redisKeyForWaitlist}).`);
    }

    return NextResponse.json({ message: 'Thank you! You have been added to our waitlist.' }, { status: 200 });

  } catch (error: any) {
    console.error('Error in /api/join-waitlist handler:', error);
    // Se for um erro espec√≠fico do Redis, voc√™ pode querer log√°-lo de forma diferente
    // if (error.name === 'RedisError') { ... }
    return NextResponse.json({ error: 'An unexpected error occurred while trying to join the waitlist.' }, { status: 500 });
  }
}

# =================================================================
# Arquivo: .\app\api\journal\route.ts
# =================================================================

import { NextResponse } from 'next/server';
import { createRouteHandlerClient } from '@supabase/auth-helpers-nextjs';
import { cookies } from 'next/headers';
import { Database } from '@/lib/types/database.types';

export async function GET() {
  const supabase = createRouteHandlerClient<Database>({ cookies });

  let session: Awaited<ReturnType<typeof supabase.auth.getSession>>['data']['session'] | null = null;
  try {
    const { data } = await supabase.auth.getSession();
    session = data?.session ?? null;
  } catch (error) {
    console.error('[Journal API] Supabase session check failed. Returning empty list.', error);
    return NextResponse.json([], { status: 200 });
  }

  if (!session) {
    return NextResponse.json([], { status: 200 });
  }

  try {
    const { data: dreams, error } = await supabase
      .from('dreams')
      .select('*')
      .eq('user_id', session.user.id)
      .order('created_at', { ascending: false });

    if (error) {
      console.error('[Journal API] Supabase query error. Returning empty list.', error);
      return NextResponse.json([], { status: 200 });
    }

    return NextResponse.json(dreams ?? [], { status: 200 });
  } catch (error) {
    console.error('[Journal API] Unexpected fetch error. Returning empty list.', error);
    return NextResponse.json([], { status: 200 });
  }
}


# =================================================================
# Arquivo: .\app\waitlist\page.tsx
# =================================================================

// FILE: app/waitlist/page.tsx
"use client";

import { useState } from "react";
import Link from "next/link";
import { motion } from "framer-motion";
import { Logo } from "@/components/brand/logo";
import { PageBackground } from "@/components/page-background";
import { Button } from "@/components/ui/button";
import { Input } from "@/components/ui/input";
import { cn } from "@/lib/utils";
import { Mail, CheckCircle, Loader2 } from "lucide-react";

export default function WaitlistPage() {
  const [email, setEmail] = useState("");
  const [isSubmitting, setIsSubmitting] = useState(false);
  const [submitted, setSubmitted] = useState(false);
  const [error, setError] = useState("");

  const titleDisplayFontClass = 'font-display-cormorant'; // ou 'font-display-marcellus'
  const titleFontWeightClass = 'font-semibold';

  const handleSubmit = async (e: React.FormEvent) => {
    e.preventDefault();
    setError(""); // Limpa erros anteriores

    if (!email.trim() || !/\S+@\S+\.\S+/.test(email)) {
      setError("Please enter a valid email address.");
      // N√£o precisa setar isSubmitting se a valida√ß√£o falhar no cliente
      return;
    }

    setIsSubmitting(true); // Come√ßa o loading

    try {
      // --- CHAMADA REAL √Ä API ---
      const response = await fetch('/api/join-waitlist', { // Chama seu endpoint
        method: 'POST',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify({ email }), // Envia o email no corpo da requisi√ß√£o
      });

      const data = await response.json(); // Tenta parsear a resposta da API

      if (!response.ok) {
        // Se a resposta da API n√£o for OK (ex: status 400, 500),
        // usa a mensagem de erro da API ou uma padr√£o.
        throw new Error(data.error || "Something went wrong. Please try again.");
      }

      // Se chegou aqui, a inscri√ß√£o foi bem-sucedida (status 200 ou 201 da API)
      console.log("WaitlistPage: Email submission successful:", data.message);
      setSubmitted(true); // Mostra a mensagem de sucesso

    } catch (err: any) {
      console.error("WaitlistPage: Error submitting email:", err);
      setError(err.message || "An error occurred. Please try again.");
      setSubmitted(false); // Garante que o formul√°rio ainda seja mostrado se houver erro na API
    } finally {
      setIsSubmitting(false); // Para o loading independentemente do resultado
    }
    // --- FIM DA CHAMADA REAL √Ä API ---
  };

  return (
    <PageBackground>
      <div className="relative z-10 flex flex-col items-center justify-center min-h-screen px-4 py-6 text-center">
        <motion.div
          initial={{ opacity: 0, y: -30 }}
          animate={{ opacity: 1, y: 0 }}
          transition={{ duration: 0.7, delay: 0.1 }}
          className="mb-10 md:mb-12"
        >
          <Logo variant="large" />
        </motion.div>

        <motion.div
          initial={{ opacity: 0, scale: 0.95, y: 20 }}
          animate={{ opacity: 1, scale: 1, y: 0 }}
          transition={{ duration: 0.7, delay: 0.3, ease: "easeOut" }}
          className="bg-gradient-to-br from-[#1e1133]/80 via-[#23103f]/80 to-[#2a1a46]/80 backdrop-blur-md p-6 sm:p-8 md:p-10 rounded-2xl shadow-2xl max-w-md w-full border border-purple-500/20"
        >
          {!submitted ? (
            <>
              <Mail className="w-10 h-10 sm:w-12 sm:h-12 text-purple-400 mx-auto mb-5 sm:mb-6" />
              <h1
                className={cn(
                  "text-2xl sm:text-3xl md:text-4xl text-purple-100 mb-3", // Removi tracking-tight daqui, ajuste se necess√°rio
                  titleDisplayFontClass,
                  titleFontWeightClass
                )}
              >
                dream without limits.
              </h1>
              <p className="text-purple-200/80 mb-6 sm:mb-8 text-sm sm:text-base leading-relaxed font-sans">
                <br />
                Your dreams are ready to bloom into something more: Unlimited interpretations, your personal dream journal, in-depth pattern analysis.
                <br />
                <br />
                Join our waitlist and be the first to decode the messages your dreams have been sending you.
              </p>
              <form onSubmit={handleSubmit} className="space-y-5 sm:space-y-6">
                <div>
                  <Input
                    type="email"
                    name="email"
                    id="waitlist-email"
                    placeholder="Enter your email address"
                    value={email}
                    onChange={(e) => setEmail(e.target.value)}
                    required
                    disabled={isSubmitting}
                    className="w-full bg-black/50 border-purple-500/30 text-purple-100 placeholder-purple-300/60 focus:ring-purple-500 focus:border-purple-500 h-11 text-sm sm:text-base"
                  />
                  {error && <p className="text-red-400 text-xs text-left mt-2 px-1">{error}</p>}
                </div>
                <Button
                  type="submit"
                  disabled={isSubmitting}
                  className="w-full bg-purple-600 hover:bg-purple-700 text-white py-3 text-sm sm:text-base font-medium transition-all duration-300 shadow-lg hover:shadow-purple-500/40 disabled:opacity-70"
                >
                  {isSubmitting ? (
                    <Loader2 className="w-5 h-5 animate-spin" />
                  ) : (
                    "Join Waitlist"
                  )}
                </Button>
              </form>
            </>
          ) : (
            // Mensagem de Sucesso (como voc√™ j√° tinha)
            <div className="text-center py-8">
              <motion.div
                initial={{ scale: 0.5, opacity: 0 }}
                animate={{ scale: 1, opacity: 1 }}
                transition={{ type: "spring", stiffness: 260, damping: 20, delay: 0.2 }}
              >
                <CheckCircle className="w-16 h-16 sm:w-20 sm:h-20 text-green-400 mx-auto mb-6" />
                <h2
                  className={cn(
                    "text-xl sm:text-2xl md:text-3xl text-purple-100 mb-3",
                    titleDisplayFontClass,
                    titleFontWeightClass
                  )}
                >
                  You're On The List!
                </h2>
                <p className="text-purple-200/80 mb-8 text-sm sm:text-base font-sans">
                  Thank you for your interest. We'll be in touch soon with updates on new features.
                </p>
                <Link href="/">
                  <Button
                    variant="outline"
                    className="border-purple-500/40 text-purple-200 hover:bg-purple-500/10 hover:text-purple-100 text-sm sm:text-base"
                  >
                    Back to Dream Decoder
                  </Button>
                </Link>
              </motion.div>
            </div>
          )}
        </motion.div>
        <p className="text-xs text-purple-300/60 mt-10 sm:mt-12">
          ¬© {new Date().getFullYear()} Bloomed Dreams.
        </p>
      </div>
    </PageBackground>
  );
}


# =================================================================
# Arquivo: .\components\background-effects.tsx
# =================================================================

"use client";

export function BackgroundEffects() {
  return (
    <div className="absolute inset-0">
      <div className="animated-gradient absolute inset-0 opacity-40" />
    </div>
  );
}

# =================================================================
# Arquivo: .\components\benefits.tsx
# =================================================================

"use client";

import { useCallback, useRef } from 'react';
import { motion } from 'framer-motion';
import { DreamClock } from './icons/dream-clock';
import { DreamEye } from './icons/dream-eye';
import { DreamGrowth } from './icons/dream-growth';

const benefits = [
  {
    icon: DreamClock,
    title: "Instant Dream Insights",
    description: "Unlock the meaning of your dreams in real time with personalized guidance"
  },
  {
    icon: DreamEye,
    title: "Decode the Hidden Language",
    description: "Discover the secret messages your subconscious sends while you sleep"
  },
  {
    icon: DreamGrowth,
    title: "Bloom Through Your Dreams",
    description: "Let your dreams guide you toward the person you're meant to become"
  }
];

export function Benefits() {
  const containerRef = useRef<HTMLDivElement>(null); // containerRef n√£o est√° sendo usado, mas n√£o causa erro.

  const animateIcon = useCallback((e: React.MouseEvent<HTMLDivElement>) => {
    const iconElement = e.currentTarget.querySelector('.benefit-icon');

    // Verifique se iconElement existe E se √© uma inst√¢ncia de HTMLElement
    if (iconElement instanceof HTMLElement) {
      // Dentro deste bloco, o TypeScript agora sabe que iconElement √© um HTMLElement
      iconElement.classList.remove('animate-float');
      void iconElement.offsetWidth; // Isso agora √© seguro
      iconElement.classList.add('animate-float');
    } else if (iconElement) {
      // Opcional: Se for um Element mas n√£o HTMLElement, voc√™ pode logar um aviso
      // ou lidar com isso de outra forma, mas para offsetWidth, precisa ser HTMLElement.
      console.warn("Benefit icon found, but it's not an HTMLElement:", iconElement);
    }
  }, []);

  return (
    <div
      ref={containerRef} // containerRef n√£o parece ser usado para nada neste trecho
      className="grid grid-cols-1 md:grid-cols-3 gap-4 md:gap-6 px-4 max-w-[1200px] mx-auto"
    >
      {benefits.map((benefit, index) => (
        <motion.div
          key={index}
          initial={{ opacity: 0, y: 20 }}
          whileInView={{ opacity: 1, y: 0 }}
          transition={{ duration: 0.5, delay: index * 0.1 }}
          viewport={{ once: true }}
          whileHover={{
            y: -3,
            transition: { duration: 0.5, ease: [0.4, 0, 0.2, 1] }
          }}
          className="relative flex flex-col items-center p-6 md:p-8
            backdrop-blur-[2px] rounded-2xl
            bg-gradient-to-b from-purple-100/[0.05] to-transparent
            hover:from-purple-100/[0.1] hover:to-transparent
            transition-all duration-400 group
            border border-purple-300/5 hover:border-purple-300/10
            shadow-[0_8px_24px_-8px_rgba(139,92,246,0.15)]
            hover:shadow-[0_16px_32px_-8px_rgba(139,92,246,0.25)]
            max-w-[320px] mx-auto w-full min-h-[240px] md:min-h-[280px]"
          onMouseEnter={animateIcon} // A fun√ß√£o animateIcon √© chamada aqui
        >
          {/* O elemento com a classe 'benefit-icon' √© este div abaixo */}
          <div className="text-purple-400 mb-4 md:mb-6 benefit-icon transition-all duration-700
            group-hover:scale-105 group-hover:rotate-[4deg]
            [filter:drop-shadow(0_0_12px_rgba(167,139,250,0.2))]
            group-hover:[filter:drop-shadow(0_0_16px_rgba(167,139,250,0.3))]
            animate-pulse-subtle">
            <benefit.icon /> {/* Seus componentes de √≠cone SVG */}
          </div>

          <div className="text-center space-y-2 md:space-y-5 relative">
            <h3 className="text-base md:text-[18px] font-semibold tracking-tight
              bg-gradient-to-r from-purple-200/95 via-purple-300 to-purple-200/95
              bg-clip-text text-transparent
              [text-shadow:0_0_30px_rgba(233,213,255,0.15)]
              group-hover:from-purple-100 group-hover:to-purple-400
              transition-all duration-500">
              {benefit.title}
            </h3>

            <p className="text-[#E9D5FF]/70 text-[14px] leading-relaxed tracking-wide font-light
              max-w-[260px] group-hover:text-[#E9D5FF]/80 transition-colors duration-500
              [text-shadow:0_0_20px_rgba(233,213,255,0.1)]">
              {benefit.description}
            </p>
          </div>

          {/* Subtle star pattern */}
          <div className="absolute inset-0 opacity-[0.03] group-hover:opacity-[0.05]
            transition-opacity duration-500 pointer-events-none">
            <div className="absolute inset-0"
              style={{
                backgroundImage: `radial-gradient(circle at 50% 50%, rgba(139, 92, 246, 0.2) 0%, transparent 50%),
                                radial-gradient(circle at 80% 20%, rgba(139, 92, 246, 0.1) 0%, transparent 20%),
                                radial-gradient(circle at 20% 80%, rgba(139, 92, 246, 0.1) 0%, transparent 20%)`,
                backgroundSize: '100% 100%, 50% 50%, 50% 50%',
                backgroundPosition: 'center, top right, bottom left',
                backgroundRepeat: 'no-repeat'
              }}
            />
          </div>

          {/* Glow border */}
          <div className="absolute -inset-[1px] rounded-2xl bg-gradient-to-b
            from-purple-300/5 to-transparent opacity-0 group-hover:opacity-100
            transition-opacity duration-500 pointer-events-none blur-[1px]" />
        </motion.div>
      ))}
    </div>
  );
}

# =================================================================
# Arquivo: .\components\page-background.tsx
# =================================================================

// ARQUIVO CORRIGIDO: components/page-background.tsx

"use client";

import { StarField } from './star-field';
import { BackgroundEffects } from './background-effects';

export function PageBackground({ children }: { children: React.ReactNode }) {
  return (
    <div className="min-h-screen bg-gradient-to-b from-[#050008] via-[#0F001A] to-[#050008] relative">
      {/* Background layers */}
      {/* 
        A MUDAN√áA EST√Å AQUI:
        Adicionamos 'pointer-events-none' a este container.
        Agora, esta camada inteira (estrelas, gradientes) ser√° invis√≠vel para o mouse,
        permitindo que voc√™ clique e selecione o conte√∫do abaixo dela.
      */}
      <div className="fixed inset-0 pointer-events-none">
        {/* Stars layer na base */}
        <div className="absolute inset-0 z-[0]">
          <StarField />
        </div>

        {/* Animated gradient por cima das estrelas */}
        <div className="absolute inset-0 z-[1]">
          <BackgroundEffects />
        </div>
        
        {/* Gradientes radiais por cima de tudo */}
        <div className="absolute inset-0 z-[2]">
          <div className="absolute inset-0 bg-[radial-gradient(circle_at_center,rgba(139,92,246,0.06),transparent_50%)]" />
          <div className="absolute inset-0 bg-[radial-gradient(circle_at_center,rgba(88,28,135,0.08),transparent_40%)]" />
        </div>
      </div>
      
      {/* Content layer */}
      {/* 
        Como o conte√∫do est√° em um container irm√£o e com z-index maior, 
        ele continuar√° vis√≠vel, mas agora receber√° os cliques.
      */}
      <div className="relative z-[3]">
        {children}
      </div>
    </div>
  );
}

# =================================================================
# Arquivo: .\components\profile-menu.tsx
# =================================================================

// ARQUIVO ATUALIZADO: components/profile-menu.tsx

"use client";

import { useState, useEffect } from 'react';
import { useAuth } from '@/components/auth/auth-provider';
import {
  DropdownMenu,
  DropdownMenuContent,
  DropdownMenuItem,
  DropdownMenuLabel,
  DropdownMenuSeparator,
  DropdownMenuTrigger,
} from '@/components/ui/dropdown-menu';
import { Button } from '@/components/ui/button';
import { LogOut, User, Settings, Bell, HelpCircle } from 'lucide-react';

export function ProfileMenu() {
  const { user, signOut } = useAuth();
  const [isOpen, setIsOpen] = useState(false);

  // Handle body class when dropdown opens/closes
  useEffect(() => {
   
  }, [isOpen]);

  if (!user) return null;
  
  return (
    <DropdownMenu open={isOpen} onOpenChange={setIsOpen} modal={false}>
      <DropdownMenuTrigger asChild>
        {/* A MUDAN√áA EST√Å AQUI: Usando size="icon" que define h-10 w-10 */}
        <Button 
          variant="avatar"
          size="icon" 
          className="relative rounded-full overflow-hidden border border-purple-500/20
            bg-gradient-to-br from-purple-500/20 via-purple-400/10 to-indigo-500/20
            shadow-[0_0_10px_rgba(168,85,247,0.15)]"
        >
          {/* √çcone aumentado para h-5 w-5 para melhor propor√ß√£o */}
          <User className="h-5 w-5 text-purple-200/90" />
        </Button>
      </DropdownMenuTrigger>
      <DropdownMenuContent 
        align="end"
        className="min-w-[180px] max-w-[240px] bg-black/90 backdrop-blur-sm border-purple-500/20 text-purple-100"
        forceMount
      >
        <DropdownMenuLabel className="font-display tracking-wide py-2">
          <div className="space-y-0.5">
            <p className="text-xs text-purple-300/60 font-normal truncate">
              {user.email}
            </p>
          </div>
        </DropdownMenuLabel>
        <DropdownMenuSeparator className="bg-purple-500/20" />
        <DropdownMenuItem 
          onClick={() => signOut()}
          className="flex items-center gap-3 text-[13px] py-2 cursor-pointer group text-red-400 focus:text-red-400"
        >
          <LogOut className="w-4 h-4 group-hover:text-red-300" />
          <span className="group-hover:text-red-300">Log out</span>
        </DropdownMenuItem>
      </DropdownMenuContent>
    </DropdownMenu>
  );
}

# =================================================================
# Arquivo: .\components\star-field.tsx
# =================================================================

"use client";

import { useEffect, useRef, useState } from 'react';

export function StarField() {
  const canvasRef = useRef<HTMLCanvasElement>(null);
  const containerRef = useRef<HTMLDivElement>(null);
  const [stars] = useState(() => Array.from({ length: 350 }, () => ({
    x: Math.random() * 100,
    y: Math.random() * 100,
    size: Math.random() * 1.3,
    opacity: Math.random(),
    speed: Math.random() * 0.02
  })));

  useEffect(() => {
    const canvas = canvasRef.current;
    const container = containerRef.current;
    if (!canvas || !container) return;

    const ctx = canvas.getContext('2d');
    if (!ctx) return;

    const setCanvasSize = () => {
      const rect = container.getBoundingClientRect();
      const scale = window.devicePixelRatio || 1;
      
      // Definir o tamanho real do canvas
      canvas.width = rect.width * scale;
      canvas.height = rect.height * scale;
      
      // Definir o tamanho de exibi√ß√£o do canvas
      canvas.style.width = `${rect.width}px`;
      canvas.style.height = `${rect.height}px`;
      
      // N√£o precisamos mais fazer ctx.scale aqui pois j√° aplicamos a escala no tamanho do canvas
    };

    setCanvasSize();
    window.addEventListener('resize', setCanvasSize);

    const renderStars = () => {
      ctx.clearRect(0, 0, canvas.width, canvas.height);
      
      // Usar as dimens√µes reais do canvas para o c√°lculo
      stars.forEach(star => {
        ctx.beginPath();
        const currentOpacity = star.opacity * (Math.sin(Date.now() * star.speed) * 0.2 + 0.8);
        ctx.fillStyle = `rgba(233, 213, 255, ${currentOpacity})`;
        
        // Calcular posi√ß√£o usando as dimens√µes reais do canvas
        const x = (star.x * canvas.width) / 100;
        const y = (star.y * canvas.height) / 100;
        
        // Ajustar o tamanho da estrela baseado na escala
        const scale = window.devicePixelRatio || 1;
        ctx.arc(x, y, star.size * scale, 0, Math.PI * 2);
        ctx.fill();
      });
    };

    renderStars();

    const animate = () => {
      renderStars();
      return requestAnimationFrame(animate);
    };

    const animationFrame = animate();

    return () => {
      window.removeEventListener('resize', setCanvasSize);
      cancelAnimationFrame(animationFrame);
    };
  }, [stars]);

  return (
    <div ref={containerRef} className="absolute inset-0 w-full h-full">
      <canvas
        ref={canvasRef}
        className="absolute inset-0 w-full h-full"
        style={{ mixBlendMode: 'screen' }}
      />
    </div>
  );
}

# =================================================================
# Arquivo: .\components\theme-provider.tsx
# =================================================================

"use client";

import * as React from "react";
import { ThemeProvider as NextThemesProvider } from "next-themes";
import { type ThemeProviderProps } from "next-themes/dist/types";

export function ThemeProvider({ children, ...props }: ThemeProviderProps) {
  return <NextThemesProvider {...props}>{children}</NextThemesProvider>;
}

# =================================================================
# Arquivo: .\components\auth\auth-prompt.tsx
# =================================================================

// Em: components/auth/auth-prompt.tsx
"use client";

import Link from 'next/link';
import { useAuth } from './auth-provider';
import { ArrowRight } from 'lucide-react';

export function AuthPrompt() {
  const { user, loading } = useAuth();

  // N√£o renderiza nada enquanto carrega para evitar "piscar"
  if (loading) {
    return <div className="h-10" />; // Placeholder de altura
  }

  return (
    <div className="text-center mt-8 p-4 border-t border-purple-500/10 w-full max-w-md mx-auto">
      {user ? (
        // Mensagem para usu√°rio LOGADO
        <div className="space-y-2">
          <p className="text-sm text-purple-200/80">Welcome back, Dreamer.</p>
          <Link href="/dashboard" className="inline-flex items-center text-md font-semibold text-purple-300 hover:text-purple-100 transition-colors">
            Go to your Dashboard
            <ArrowRight className="w-4 h-4 ml-2" />
          </Link>
        </div>
      ) : (
        // Mensagem para VISITANTE
        <p className="text-xs text-purple-300/70">
          Want to save your dreams and discover patterns?{' '}
          <Link href="/login" className="font-semibold text-purple-300 hover:text-purple-100 underline underline-offset-2 transition-colors">
            Login
          </Link>
          {' or '}
          <Link href="/signup" className="font-semibold text-purple-300 hover:text-purple-100 underline underline-offset-2 transition-colors">
            Create an Account
          </Link>.
        </p>
      )}
    </div>
  );
}

# =================================================================
# Arquivo: .\components\auth\auth-provider.tsx
# =================================================================

'use client';

import { createContext, useContext, useEffect, useState } from 'react';
import { useRouter } from 'next/navigation';
import type { Session, User } from '@supabase/supabase-js';
import { supabase } from '@/lib/supabase/client';

type AuthContextType = {
  user: User | null;
  session: Session | null;
  loading: boolean;
  signIn: (email: string, password: string) => Promise<void>;
  signUp: (email: string, password: string) => Promise<void>;
  signOut: () => Promise<void>;
  resendConfirmation: (email: string) => Promise<void>;
  signInWithGoogle: () => Promise<void>;
};

const AuthContext = createContext<AuthContextType | undefined>(undefined);

export function AuthProvider({ children }: { children: React.ReactNode }) {
  const [user, setUser] = useState<User | null>(null);
  const [session, setSession] = useState<Session | null>(null);
  const [loading, setLoading] = useState(true);
  const router = useRouter();

  useEffect(() => {
    const getSession = async () => {
      try {
        const { data: { session } } = await supabase.auth.getSession();
        setSession(session);
        setUser(session?.user ?? null);
      } catch (error) {
        console.error('[Auth] Failed to load session. Continuing signed-out.', error);
        setSession(null);
        setUser(null);
      } finally {
        setLoading(false);
      }
    };

    getSession();

    let unsubscribe: (() => void) | null = null;

    try {
      const { data: { subscription } } = supabase.auth.onAuthStateChange((_event, nextSession) => {
        setSession(nextSession);
        setUser(nextSession?.user ?? null);
        setLoading(false);
      });

      unsubscribe = () => subscription.unsubscribe();
    } catch (error) {
      console.error('[Auth] Failed to subscribe auth state changes.', error);
    }

    return () => {
      if (unsubscribe) unsubscribe();
    };
  }, [router]);

  const signIn = async (email: string, password: string) => {
    const { error } = await supabase.auth.signInWithPassword({ email, password });
    if (error) throw error;
    router.push('/dashboard');
    router.refresh();
  };

  const signUp = async (email: string, password: string) => {
    const { error } = await supabase.auth.signUp({
      email,
      password,
      options: {
        emailRedirectTo: `${window.location.origin}/login`,
      },
    });
    if (error) throw error;
    router.refresh();
  };

  const signOut = async () => {
    const { error } = await supabase.auth.signOut();
    if (error) throw error;
    router.push('/');
    router.refresh();
  };

  const resendConfirmation = async (email: string) => {
    const { error } = await supabase.auth.resend({
      type: 'signup',
      email,
    });

    if (error) {
      console.error('[Auth] Failed to resend confirmation email:', error);
      throw error;
    }
  };

  const signInWithGoogle = async () => {
    const { error } = await supabase.auth.signInWithOAuth({
      provider: 'google',
      options: {
        redirectTo: `${window.location.origin}/auth/callback`,
      },
    });
    if (error) throw error;
  };

  const value = {
    session,
    user,
    loading,
    signIn,
    signUp,
    signOut,
    resendConfirmation,
    signInWithGoogle,
  };

  return <AuthContext.Provider value={value}>{children}</AuthContext.Provider>;
}

export function useAuth() {
  const context = useContext(AuthContext);
  if (context === undefined) {
    throw new Error('useAuth must be used within an AuthProvider');
  }
  return context;
}


# =================================================================
# Arquivo: .\components\auth\forgot-password-form.tsx
# =================================================================

"use client";

import { useState } from 'react';
import Link from 'next/link';
import { useForm } from 'react-hook-form';
import { zodResolver } from '@hookform/resolvers/zod';
import * as z from 'zod';
import { Button } from '@/components/ui/button';
import { Input } from '@/components/ui/input';
import { Label } from '@/components/ui/label';
import { ArrowLeft } from 'lucide-react';
import { resetPassword } from '@/lib/auth';

const forgotPasswordSchema = z.object({
  email: z.string().email('Invalid email address'),
});

type ForgotPasswordFormData = z.infer<typeof forgotPasswordSchema>;

export function ForgotPasswordForm() {
  const [error, setError] = useState('');
  const [success, setSuccess] = useState(false);
  
  const { register, handleSubmit, formState: { errors, isSubmitting } } = useForm<ForgotPasswordFormData>({
    resolver: zodResolver(forgotPasswordSchema),
  });

  const onSubmit = async (data: ForgotPasswordFormData) => {
    try {
      const { error } = await resetPassword(data.email);
      if (error) throw error;
      
      setSuccess(true);
      setError('');
    } catch (err) {
      setError('Error sending reset instructions. Please try again.');
      setSuccess(false);
    }
  };

  if (success) {
    return (
      <div className="space-y-6 text-center">
        <div className="space-y-2">
          <h2 className="text-2xl font-semibold text-gray-200/90 font-display">Check Your Email</h2>
          <p className="text-purple-200/60 text-sm font-light">
            We've sent password reset instructions to your email address.
          </p>
        </div>
        
        <Link 
          href="/login" 
          className="inline-flex items-center text-sm text-purple-200/60 hover:text-purple-300 transition-colors"
        >
          <ArrowLeft className="w-4 h-4 mr-2" />
          Back to login
        </Link>
      </div>
    );
  }

  return (
    <div className="space-y-6">
      <div className="space-y-2 text-center">
        <h2 className="text-2xl font-semibold text-gray-200/90 font-display">Reset Password</h2>
        <p className="text-purple-200/60 text-sm font-light">
          Enter your email to receive reset instructions
        </p>
      </div>

      <form onSubmit={handleSubmit(onSubmit)} className="space-y-6">
        {error && (
          <p className="text-sm text-red-400/90 text-center">{error}</p>
        )}
        <div className="space-y-2">
          <Label htmlFor="email" className="text-purple-200/80 font-light">Email</Label>
          <Input
            id="email"
            type="email"
            {...register('email')}
            placeholder="hello@example.com"
            disabled={isSubmitting}
            className="bg-white/5 border-white/10 text-purple-100 placeholder:text-purple-200/30"
          />
          {errors.email && (
            <p className="text-sm text-red-400/90">{errors.email.message}</p>
          )}
        </div>
        <Button 
          type="submit" 
          className="w-full bg-gradient-to-r from-[#9F7AEA] to-[#9F7AEA] hover:from-[#805AD5] hover:to-[#6B46C1]
            transform hover:scale-[1.02] transition-all duration-500 shadow-lg hover:shadow-purple-500/25
            text-white/90 font-medium rounded-[6px]"
          disabled={isSubmitting}
        >
          {isSubmitting ? 'Sending...' : 'Send Reset Instructions'}
        </Button>
      </form>

      <div className="text-center">
        <Link 
          href="/login" 
          className="inline-flex items-center text-sm text-purple-200/60 hover:text-purple-300 transition-colors"
        >
          <ArrowLeft className="w-4 h-4 mr-2" />
          Back to login
        </Link>
      </div>
    </div>
  );
}

# =================================================================
# Arquivo: .\components\auth\login-form Funcional
# =================================================================

"use client";

import { useState } from 'react';
import Link from 'next/link';
import { useForm } from 'react-hook-form';
import { zodResolver } from '@hookform/resolvers/zod';
import * as z from 'zod';
import { Button } from '@/components/ui/button';
import { Input } from '@/components/ui/input';
import { Label } from '@/components/ui/label';
import { ArrowLeft } from 'lucide-react';
import { useAuth } from '@/components/auth-provider';

const loginSchema = z.object({
  email: z.string().email('Invalid email address'),
  password: z.string().min(6, 'Password must be at least 6 characters'),
});

type LoginFormData = z.infer<typeof loginSchema>;

export function LoginForm() {
  const { signIn } = useAuth();
  const [error, setError] = useState('');
  
  const { register, handleSubmit, formState: { errors, isSubmitting } } = useForm<LoginFormData>({
    resolver: zodResolver(loginSchema),
  });

  const onSubmit = async (data: LoginFormData) => {
    try {
      await signIn(data.email, data.password);
    } catch (err) {
      setError('Invalid email or password');
    }
  };

  return (
    <div className="space-y-6">
      <div className="space-y-2 text-center">
        <h2 className="text-2xl font-semibold text-gray-200/90 font-display">Welcome Back</h2>
        <p className="text-purple-200/60 text-sm font-light">Enter your credentials to continue</p>
      </div>

      <form onSubmit={handleSubmit(onSubmit)} className="space-y-6">
        {error && (
          <p className="text-sm text-red-400/90 text-center">{error}</p>
        )}
        <div className="space-y-2">
          <Label htmlFor="email" className="text-purple-200/80 font-light">Email</Label>
          <Input
            id="email"
            type="email"
            {...register('email')}
            placeholder="hello@example.com"
            disabled={isSubmitting}
            className="bg-white/5 border-white/10 text-purple-100 placeholder:text-purple-200/30"
          />
          {errors.email && (
            <p className="text-sm text-red-400/90">{errors.email.message}</p>
          )}
        </div>
        <div className="space-y-2">
          <div className="flex justify-between items-center">
            <Label htmlFor="password" className="text-purple-200/80 font-light">Password</Label>
            <Link 
              href="/forgot-password" 
              className="text-sm text-purple-300 hover:text-purple-200 transition-colors"
            >
              Forgot password?
            </Link>
          </div>
          <Input
            id="password"
            type="password"
            {...register('password')}
            disabled={isSubmitting}
            className="bg-white/5 border-white/10 text-purple-100"
          />
          {errors.password && (
            <p className="text-sm text-red-400/90">{errors.password.message}</p>
          )}
        </div>
        <div className="pt-2">
          <Button 
            type="submit" 
            className="w-full bg-gradient-to-r from-[#9F7AEA] to-[#9F7AEA] hover:from-[#805AD5] hover:to-[#6B46C1]
              transform hover:scale-[1.02] transition-all duration-500 shadow-lg hover:shadow-purple-500/25
              text-white/90 font-medium rounded-[6px]"
            disabled={isSubmitting}
          >
            {isSubmitting ? 'Signing in...' : 'Sign In'}
          </Button>
        </div>
      </form>

      <div className="text-center space-y-2">
        <p className="text-sm text-purple-200/60">
          Don't have an account?{' '}
          <Link href="/signup" className="text-purple-400 hover:text-purple-300 transition-colors">
            Sign up
          </Link>
        </p>
        <Link 
          href="/" 
          className="inline-flex items-center text-sm text-purple-200/60 hover:text-purple-300 transition-colors"
        >
          <ArrowLeft className="w-4 h-4 mr-2" />
          Back to home
        </Link>
      </div>
    </div>
  );
}

# =================================================================
# Arquivo: .\components\auth\login-form.tsx
# =================================================================

// Em: components/auth/login-form.tsx
"use client";

import { useState } from 'react';
import Link from 'next/link';
import { useForm } from 'react-hook-form';
import { zodResolver } from '@hookform/resolvers/zod';
import * as z from 'zod';
import { Button } from '@/components/ui/button';
import { Input } from '@/components/ui/input';
import { Label } from '@/components/ui/label';
import { ArrowLeft } from 'lucide-react';
import { useAuth } from '@/components/auth/auth-provider';
import { Logo } from '@/components/brand/logo'; // 1. IMPORTAR A LOGO
import { cn } from '@/lib/utils'; // 2. IMPORTAR CN

const loginSchema = z.object({
  email: z.string().email('Invalid email address'),
  password: z.string().min(6, 'Password must be at least 6 characters'),
});

type LoginFormData = z.infer<typeof loginSchema>;

export function LoginForm() {
  const { signIn } = useAuth();
  const [error, setError] = useState('');
  
  const { register, handleSubmit, formState: { errors, isSubmitting } } = useForm<LoginFormData>({
    resolver: zodResolver(loginSchema),
  });

  const onSubmit = async (data: LoginFormData) => {
    try {
      setError('');
      await signIn(data.email, data.password);
    } catch (err: any) {
      console.error("ERRO DETALHADO NO LOGIN:", err);
      if (err.message === 'Email not confirmed') {
        setError('Your account is waiting for activation. Please check your email for the confirmation link.');
      } else {
        setError('Invalid email or password. Please try again.');
      }
    }
  };

  return (
    // 3. ESTRUTURA ATUALIZADA (MESMA DO SIGNUP)
    <div className="space-y-10">
      <div className="flex flex-col items-center text-center mb-6">
        <Logo variant="small" />
      </div>

      <div className="space-y-1 text-center">
        <h2 className={cn(
          "text-2xl font-semibold text-gray-200/90",
          'font-display-marcellus'
        )}>
          Welcome Back
        </h2>
        <p className="text-purple-200/60 text-xs font-light">
          Enter your credentials to continue
        </p>
      </div>

      <form onSubmit={handleSubmit(onSubmit)} className="space-y-4">
        {error && (
          <p className="text-sm text-red-400/90 text-center">{error}</p>
        )}
        <div className="space-y-2">
          <Label htmlFor="email" className="text-purple-200/80 text-xs font-light">Email</Label>
          <Input
            id="email"
            type="email"
            {...register('email')}
            placeholder="hello@example.com"
            disabled={isSubmitting}
            className="bg-white/5 border-white/10 text-purple-100 placeholder:text-purple-200/30 text-xs"
          />
          {errors.email && (
            <p className="text-sm text-red-400/90">{errors.email.message}</p>
          )}
        </div>
        <div className="space-y-2">
          <div className="flex justify-between items-center">
            <Label htmlFor="password" className="text-purple-200/80 text-xs font-light">Password</Label>
            <Link 
              href="/forgot-password" 
              className="text-xs text-purple-300 hover:text-purple-200 transition-colors"
            >
              Forgot password?
            </Link>
          </div>
          <Input
            id="password"
            type="password"
            {...register('password')}
            disabled={isSubmitting}
            className="bg-white/5 border-white/10 text-purple-100 text-xs"
          />
          {errors.password && (
            <p className="text-sm text-red-400/90">{errors.password.message}</p>
          )}
        </div>
        <div className="pt-4">
          <Button 
            type="submit" 
            className="w-full bg-gradient-to-r from-[#9F7AEA] to-[#9F7AEA] hover:from-[#805AD5] hover:to-[#6B46C1]
              transform hover:scale-[1.02] transition-all duration-500 shadow-lg hover:shadow-purple-500/25
              text-white/90 font-medium rounded-[6px]"
            disabled={isSubmitting}
          >
            {isSubmitting ? 'Signing in...' : 'Sign In'}
          </Button>
        </div>
      </form>

      <div className="text-center space-y-2">
        <p className="text-xs text-purple-200/60">
          Don't have an account?{' '}
          <Link href="/signup" className="text-purple-400 hover:text-purple-300 transition-colors">
            Sign up
          </Link>
        </p>
        <Link 
          href="/" 
          className="inline-flex items-center text-xs text-purple-200/60 hover:text-purple-300 transition-colors"
        >
          <ArrowLeft className="w-4 h-4 mr-2" />
          Back to home
        </Link>
      </div>
    </div>
  );
}

# =================================================================
# Arquivo: .\components\auth\signup-confirmation.tsx
# =================================================================

// Em: components/auth/signup-confirmation.tsx
"use client";

import { useState, useEffect } from 'react';
import Link from 'next/link';
import { MailCheck, Loader2 } from 'lucide-react';
import { motion } from 'framer-motion';
import { Button } from '@/components/ui/button';
import { useAuth } from '@/components/auth/auth-provider';
import { cn } from '@/lib/utils';

interface SignupConfirmationProps {
  email: string;
}

export function SignupConfirmation({ email }: SignupConfirmationProps) {
  const { resendConfirmation } = useAuth();
  const [isLoading, setIsLoading] = useState(false);
  const [statusMessage, setStatusMessage] = useState('');
  const [isError, setIsError] = useState(false);
  
  const [cooldown, setCooldown] = useState(0);
  const [isCountingDown, setIsCountingDown] = useState(false);

  useEffect(() => {
    let timer: NodeJS.Timeout;
    if (isCountingDown && cooldown > 0) {
      timer = setTimeout(() => {
        setCooldown(prev => prev - 1);
      }, 1000);
    } else if (cooldown === 0) {
      setIsCountingDown(false);
    }
    return () => clearTimeout(timer);
  }, [cooldown, isCountingDown]);

  const parseCooldownSeconds = (message: string): number => {
    const match = message.match(/after (\d+) seconds/);
    return match ? parseInt(match[1], 10) : 60; 
  };
  
  const handleResend = async () => {
    if (isCountingDown) return;

    setIsLoading(true);
    setStatusMessage('');
    setIsError(false);

    try {
      await resendConfirmation(email);
      setStatusMessage('A new confirmation link has been sent!');
      setIsError(false);
    } catch (err: any) {
      // Adicionado para depura√ß√£o - isso nos mostrar√° a estrutura exata do erro no console
      console.error("Full resend error object:", err);

      const errorMessage = err.message || 'Failed to resend.';
      
      // --- A CORRE√á√ÉO EST√Å AQUI ---
      // Verificamos err.status diretamente, em vez de err.response.status
      if (err.status === 429) {
        const seconds = parseCooldownSeconds(errorMessage);
        setCooldown(seconds);
        setIsCountingDown(true);
        setStatusMessage(''); 
      } else {
        setStatusMessage('Failed to resend. Please try again later.');
        setIsError(true);
      }
    } finally {
      setIsLoading(false);
      setTimeout(() => {
        // S√≥ limpa a mensagem de status se N√ÉO estivermos no meio de uma contagem regressiva
        if (!isCountingDown) {
          setStatusMessage('');
        }
      }, 5000);
    }
  };

  const renderResendButton = () => {
    if (isCountingDown) {
        return (
          <Button variant="link" className="text-xs text-purple-300/100 p-0 h-auto cursor-not-allowed" disabled>
            Try again in {cooldown} seconds...
          </Button>
        );
      }
  
      if (isLoading) {
        return (
          <Button variant="link" className="text-xs text-purple-300/70 p-0 h-auto" disabled>
            <span className="flex items-center gap-2">
              <Loader2 className="w-3 h-3 animate-spin" />
              Sending...
            </span>
          </Button>
        );
      }
  
      return (
        <Button
          variant="link"
          className="text-xs text-purple-300/70 hover:text-purple-200 p-0 h-auto"
          onClick={handleResend}
        >
          Click here to resend the confirmation email
        </Button>
      );
  };

  // O JSX do return permanece o mesmo
  return (
    <motion.div
      initial={{ opacity: 0, y: 20 }}
      animate={{ opacity: 1, y: 0 }}
      transition={{ duration: 0.5, ease: "easeOut" }}
      className="space-y-8 text-center"
    >
      <div className="flex justify-center">
        <div className="p-4 bg-purple-500/10 rounded-full border border-purple-500/20">
          <MailCheck className="w-10 h-10 text-purple-300" />
        </div>
      </div>
      
      <div className="space-y-3">
        <h2 className="text-2xl font-semibold text-gray-200/90 font-display">
          Just one more step...
        </h2>
        <p className="text-purple-200/70 text-sm font-light leading-relaxed max-w-sm mx-auto">
          We've sent a confirmation link to <br />
          <strong className="font-medium text-purple-200">{email}</strong>.
        </p>
        <p className="text-purple-200/60 text-xs font-light">
          Please click the link in that email to activate your account.
        </p>
      </div>
      
      <div className="pt-4">
        <Link href="/login">
          <Button 
            variant="outline"
            className="w-full border-purple-500/20 text-purple-200 hover:bg-purple-500/10"
          >
            Back to Login
          </Button>
        </Link>
      </div>

      <div className="text-xs text-purple-300/50 space-y-2">
        <p>Didn't receive the email? Check your spam folder, or</p>
        <div className="h-6 flex items-center justify-center">
          {statusMessage ? (
            <p className={cn('transition-opacity duration-300', isError ? 'text-red-400' : 'text-green-400')}>
              {statusMessage}
            </p>
          ) : (
            renderResendButton()
          )}
        </div>
      </div>
    </motion.div>
  );
}

# =================================================================
# Arquivo: .\components\auth\signup-form.tsx
# =================================================================

// Em: components/auth/signup-form.tsx
"use client";

import { useState } from 'react';
import Link from 'next/link';
import { useForm } from 'react-hook-form';
import { zodResolver } from '@hookform/resolvers/zod';
import * as z from 'zod';
import { Button } from '@/components/ui/button';
import { Input } from '@/components/ui/input';
import { Label } from '@/components/ui/label';
import { ArrowLeft } from 'lucide-react';
import { useAuth } from '@/components/auth/auth-provider'; // Verifique se o caminho est√° correto
import { SignupConfirmation } from './signup-confirmation'; // <-- 1. IMPORTAR O NOVO COMPONENTE
import { Logo } from '@/components/brand/logo'
import { cn } from '@/lib/utils';

const signupSchema = z.object({
  email: z.string().email('Invalid email address'),
  password: z.string().min(6, 'Password must be at least 6 characters'),
});

type SignupFormData = z.infer<typeof signupSchema>;

export function SignupForm() {
  const { signUp } = useAuth();
  const [error, setError] = useState('');
  // --- 2. ADICIONAR NOVO ESTADO ---
  const [isSubmitted, setIsSubmitted] = useState(false);
  const [submittedEmail, setSubmittedEmail] = useState('');
  // ------------------------------

  const { register, handleSubmit, formState: { errors, isSubmitting } } = useForm<SignupFormData>({
    resolver: zodResolver(signupSchema),
  });

  const onSubmit = async (data: SignupFormData) => {
    try {
      setError('');
      await signUp(data.email, data.password);
      setSubmittedEmail(data.email);
      setIsSubmitted(true);
      // ---------------------------------------------
    } catch (err: any) {
      console.error("ERRO DETALHADO NO SIGNUP:", err);
      // Aqui podemos ser mais espec√≠ficos se quisermos
      if (err.message?.includes('User already registered')) {
        setError('An account with this email already exists.');
      } else {
        setError(err.message || 'Error creating account. Please try again.');
      }
      setIsSubmitted(false); // Garante que o formul√°rio continue vis√≠vel em caso de erro
    }
  };

  if (isSubmitted) {
    return <SignupConfirmation email={submittedEmail} />;
  }
  // ------------------------------------

  return (
    // O seu JSX do formul√°rio existente permanece aqui
    <div className="space-y-10">
      <div className="flex flex-col items-center text-center mb-6">
        <Logo 
          variant="small" // <-- √â esta linha que garante que o formul√°rio use a vers√£o compacta.
        />
      </div>
      <div className="space-y-1 text-center">
        <h2 className={cn(
          "text-2xl font-semibold text-gray-200/90",
          'font-display-marcellus' 
        )}>
          Create Account
        </h2>
        <p className="text-purple-200/60 text-xs font-light">
          Begin your journey of dream exploration
        </p>
      </div>

      <form onSubmit={handleSubmit(onSubmit)} className="space-y-4">
        {error && (
          <p className="text-sm text-red-400/90 text-center">{error}</p>
        )}
        <div className="space-y-2">
          <Label htmlFor="email" className="text-purple-200/80 text-xs font-light">Email</Label>
          <Input
            id="email"
            type="email"
            {...register('email')}
            placeholder="hello@example.com"
            disabled={isSubmitting}
            className="bg-white/5 border-white/10 text-purple-100 placeholder:text-purple-200/30 text-xs"
          />
          {errors.email && (
            <p className="text-sm text-red-400/90">{errors.email.message}</p>
          )}
        </div>
        <div className="space-y-2">
          <Label htmlFor="password" className="text-purple-200/80 text-xs font-light">Password</Label>
          <Input
            id="password"
            type="password"
            {...register('password')}
            disabled={isSubmitting}
            className="bg-white/5 border-white/10 text-purple-100"
          />
          {errors.password && (
            <p className="text-sm text-red-400/90">{errors.password.message}</p>
          )}
        </div>
        <div className="pt-4">
          <Button 
            type="submit" 
            className="w-full bg-gradient-to-r from-[#9F7AEA] to-[#9F7AEA] hover:from-[#805AD5] hover:to-[#6B46C1]
              transform hover:scale-[1.02] transition-all duration-500 shadow-lg hover:shadow-purple-500/25
              text-white/90 font-medium rounded-[6px]"
            disabled={isSubmitting}
          >
            {isSubmitting ? 'Creating account...' : 'Sign Up'}
          </Button>
        </div>
      </form>

      <div className="text-center space-y-2">
        <p className="text-xs text-purple-200/60">
          Already have an account?{' '}
          <Link href="/login" className="text-purple-400 hover:text-purple-300 transition-colors">
            Sign in
          </Link>
        </p>
        <Link 
          href="/" 
          className="inline-flex items-center text-xs text-purple-200/60 hover:text-purple-300 transition-colors"
        >
          <ArrowLeft className="w-4 h-4 mr-2" />
          Back to home
        </Link>
      </div>
    </div>
  );
}

# =================================================================
# Arquivo: .\components\auth\social-logins.tsx
# =================================================================

// Em: components/auth/social-logins.tsx
"use client";

import { Button } from "@/components/ui/button";
import { useAuth } from "./auth-provider";
import { Chrome } from "lucide-react";

export function SocialLogins() {
  const { signInWithGoogle } = useAuth();

  return (
    <>
      {/* ===== 1. SEPARADOR MELHORADO ===== */}
      <div className="relative my-4">
        <div className="absolute inset-0 flex items-center">
          <span className="w-full border-t border-purple-500/20" />
        </div>
        <div className="relative flex justify-center text-xs">
          <span className="bg-[#0e0321] px-2 text-purple-200/60 font-light">
            OR
          </span>
        </div>
      </div>
      
      {/* ===== 2. BOT√ÉO DO GOOGLE ESTILIZADO ===== */}
      <div className="grid grid-cols-1">
        <Button 
          variant="outline" 
          className="w-full bg-white/5 border-purple-500/20 text-purple-200/80 hover:bg-purple-500/10 hover:text-purple-100 transition-colors" 
          onClick={signInWithGoogle}
        >
          <Chrome className="mr-2 h-4 w-4" />
          Continue with Google
        </Button>
      </div>
    </>
  );
}

# =================================================================
# Arquivo: .\components\brand\header-logo.tsx
# =================================================================

// ARQUIVO ATUALIZADO E RESPONSIVO: components/brand/header-logo.tsx

"use client";

import Link from 'next/link';
import Image from 'next/image';
import { cn } from '@/lib/utils';

export function HeaderLogo() {
  return (
    <Link 
      href="/dashboard" 
      className="inline-flex items-center gap-2 sm:gap-3 group"
    >
      <Image
        src="/images/Logo-Bloomed-Dreams.png" // Certifique-se que o caminho da imagem est√° correto
        alt="Bloomed Dreams Mushroom Logo"
        width={36}
        height={36}
        className="flex-shrink-0" // Impede que a imagem seja espremida
      />
      
      {/* 
        A M√ÅGICA EST√Å AQUI:
        - text-xl: Tamanho da fonte em telas pequenas.
        - sm:text-2xl: A fonte aumenta em telas um pouco maiores.
        - whitespace-nowrap: Pro√≠be o navegador de quebrar a linha.
      */}
      <h1 className={cn(
        "font-display-marcellus text-white/90 tracking-normal leading-none",
        "text-xl sm:text-2xl", 
        "whitespace-nowrap"
      )}>
        bloomed dreams.
      </h1>
    </Link>
  );
}

# =================================================================
# Arquivo: .\components\brand\logo.tsx
# =================================================================

// Em: components/brand/logo.tsx
"use client";

import Link from 'next/link';
import Image from 'next/image';
import { cn } from '@/lib/utils';

interface LogoProps {
  className?: string;
  variant?: 'large' | 'small'; // Prop para controlar o tamanho
}

export function Logo({ className = "", variant = 'large' }: LogoProps) {
  const isLarge = variant === 'large';
  const displayFontClass = 'font-display-marcellus';
  const fontWeightClass = 'font-normal';

  // --- L√ìGICA DE TAMANHO REFINADA ---
  // A imagem na variante 'large' agora √© maior, mas o texto continua igual.
  const imageContainerSize = isLarge ? "w-[80px] h-[80px] sm:w-[90px] sm:h-[90px] md:w-[100px] md:h-[100px]" : "w-[60px] h-[60px]";
  const imageIntrinsicSize = isLarge ? 100 : 60; // Tamanho para otimiza√ß√£o do Next/Image

  // O tamanho do texto permanece o mesmo de antes.
  const titleSize = isLarge ? "text-4xl sm:text-5xl md:text-6xl" : "text-4xl";
  const subtitleSize = isLarge ? "text-3xs sm:text-2xs" : "text-3xs";

  return (
    <Link 
      href="/" 
      className={cn(
        'flex flex-col items-center group',
        isLarge ? 'space-y-1 sm:space-y-2' : 'space-y-1',
        className
    )}>
      <div className={cn(
        "logo-image-container group-hover:scale-105 transition-transform duration-300",
        imageContainerSize
      )}>
        <Image
          src="/images/Logo-Bloomed-Dreams.png"
          alt="Bloomed Dreams Icon"
          width={imageIntrinsicSize}
          height={imageIntrinsicSize}
          priority
          className="w-full h-full object-contain"
        />
      </div>

      <h1 className={cn(
          titleSize,
          "bg-gradient-to-r from-purple-300/90 via-purple-400/90 to-purple-300/90 text-transparent bg-clip-text",
          "tracking-tight",
          displayFontClass,
          fontWeightClass
      )}>
        bloomed dreams.
      </h1>

      <p className={cn(
        "font-light uppercase",
        subtitleSize,
        "text-purple-300/75",
        "tracking-wider sm:tracking-[0.1em]",
        "leading-snug sm:leading-normal"
      )}>
        Dream. Decode. Get bloomed.
      </p>
    </Link>
  );
}

# =================================================================
# Arquivo: .\components\chat\chat-widget.tsx
# =================================================================

// FILE: src/components/chat/chat-widget.tsx
"use client"

import React, { useState, useRef, useEffect, useCallback, useMemo, ReactNode, HTMLAttributes } from "react";
import { motion, AnimatePresence } from "framer-motion";
import TextareaAutosize from 'react-textarea-autosize';
import { Button } from "@/components/ui/button";
import { X, Send, Loader2, Moon, Sparkles, Copy, Heart } from "lucide-react";
import { toast } from "sonner";
import ReactMarkdown, { Components } from 'react-markdown';
import remarkGfm from 'remark-gfm';
import { cn } from '@/lib/utils';
import { v4 as uuidv4 } from 'uuid';
import { useDreamStore } from "@/hooks/use-dream-store";
import { useAuth } from "@/components/auth/auth-provider";

interface Message {
  id: string;
  text: string;
  isUser: boolean; // Correctly cased here
  timestamp: Date;
}

interface N8NRawResponse {
  output?: string;
  error?: string;
}

interface CosmicDreamDecoderProps {
  isOpenProp: boolean;
  onClose: () => void;
  initialDream?: string | null;
}

const customMarkdownComponents: Components = {
  // Seus componentes existentes:
  p: ({node, ...props}) => <p className="mb-1 last:mb-0" {...props} />,
  ul: ({node, ...props}) => <ul className="my-1 pl-4 list-disc" {...props} />,
  ol: ({node, ...props}) => <ol className="my-1 pl-4 list-decimal" {...props} />,
  li: ({node, ...props}) => <li className="mb-1" {...props} />,
  code: ({
      node, inline, className, children, ...props
  } : {
      node?: any; inline?: boolean; className?: string; children?: ReactNode;
  } & HTMLAttributes<HTMLElement> ) => {
      const match = /language-(\w+)/.exec(className || '');
      return !inline ? (
          <pre className="my-1 rounded bg-black/20 p-0 overflow-x-auto">
              <code className={`block p-2 text-xs font-mono ${className || ''}`} {...props}>
                  {children}
              </code>
          </pre>
      ) : (
          <code className={`bg-[#9d6bff]/20 px-1 py-0.5 rounded text-xs font-mono ${className || ''}`} {...props}>
              {children}
          </code>
      );
  },

  // --- ADI√á√ÉO PARA ESTILIZAR LINKS ---
  a: ({node, href, ...props}) => (
    <a
      href={href} // √â importante passar o href para o elemento <a>
      {...props} // Passa outras props como 'children' (o texto do link)
      className="text-purple-400 hover:text-purple-300 font-semibold cursor-pointer"
      target={href && (href.startsWith('http://') || href.startsWith('https://')) ? '_blank' : undefined}
      rel={href && (href.startsWith('http://') || href.startsWith('https://')) ? 'noopener noreferrer' : undefined}
    />
  ),
  // --- FIM DA ADI√á√ÉO PARA LINKS ---
};


export function ChatWidget({ // This component is exported
  isOpenProp,
  onClose,
  initialDream
}: CosmicDreamDecoderProps) {
  const [message, setMessage] = useState("");
  const [messages, setMessages] = useState<Message[]>([]);
  const [isLoading, setIsLoading] = useState(false);
  const [copyTooltip, setCopyTooltip] = useState<string | null>(null);
  const [likedMessages, setLikedMessages] = useState<Set<string>>(new Set());
  const messagesEndRef = useRef<HTMLDivElement>(null);
  const [processedInitialDream, setProcessedInitialDream] = useState<string | null>(null);
  const abortControllerRef = useRef<AbortController | null>(null);
  const [sessionId, setSessionId] = useState<string | null>(null);
  const { addDream } = useDreamStore();
  const { user } = useAuth();


  useEffect(() => {
    if (isOpenProp && !sessionId) {
      const newSessionId = uuidv4();
      setSessionId(newSessionId);
      console.log("ChatWidget: Generated new sessionId:", newSessionId);
    }
  }, [isOpenProp, sessionId]);

  const scrollToBottom = useCallback(() => {
    messagesEndRef.current?.scrollIntoView({ behavior: "smooth" });
  }, []);

  const handleCopy = (text: string, id: string) => {
    navigator.clipboard.writeText(text).then(() => {
      setCopyTooltip(id);
      setTimeout(() => setCopyTooltip(null), 1500);
    }).catch(err => {
      console.error('ChatWidget: Failed to copy text: ', err);
      toast.error('Failed to copy message');
    });
  };

  const handleLikeToggle = (id: string) => {
    setLikedMessages(prev => {
      const newSet = new Set(prev);
      if (newSet.has(id)) {
        newSet.delete(id);
      } else {
        newSet.add(id);
      }
      return newSet;
    });
  };

  const sendDreamToAPI = useCallback(async (dreamText: string, userMessageId: string) => {
    console.log(`ChatWidget: sendDreamToAPI called for userMessageId: ${userMessageId}. Current isLoading: ${isLoading}`);
    const apiEndpoint = '/api/dream';

    if (!sessionId) {
      toast.error("Session ID is missing. Please try reopening the chat.");
      setIsLoading(false);
      console.log("ChatWidget: sendDreamToAPI bailing - no sessionId. isLoading set to false.");
      return;
    }

    if (abortControllerRef.current) {
      console.log("ChatWidget: sendDreamToAPI - Aborting previous request.");
      abortControllerRef.current.abort();
    }

    const controller = new AbortController();
    abortControllerRef.current = controller;
    console.log("ChatWidget: sendDreamToAPI - New AbortController created and assigned.");

    setIsLoading(true);
    console.log("ChatWidget: sendDreamToAPI - isLoading set to true.");

    try {
      console.log("ChatWidget: sendDreamToAPI - Fetching API...");
      const response = await fetch(apiEndpoint, {
        method: "POST",
        headers: { "Content-Type": "application/json", "Accept": "application/json" },
        body: JSON.stringify({
          dreamText,
          timestamp: new Date().toISOString(),
          sessionId: sessionId,
        }),
        signal: controller.signal,
      });

      if (controller.signal.aborted) {
        console.log(`ChatWidget: sendDreamToAPI - Request aborted during fetch for userMessageId: ${userMessageId}.`);
        return;
      }
      console.log(`ChatWidget: sendDreamToAPI - API response status: ${response.status}`);

      if (!response.ok) {
        let errorMsg = `API Error: ${response.status}`;
        let responseDataForError: any = null;
        try {
            responseDataForError = await response.json();
            errorMsg = responseDataForError?.error || responseDataForError?.message || `Request Failed (${response.status})`;
        } catch (e) {
            // Se o corpo do erro n√£o for JSON, errorMsg j√° cont√©m o status.
            console.warn("ChatWidget: Could not parse error response as JSON for !response.ok.", e);
        }

        // --- TRATAMENTO ESPEC√çFICO PARA RATE LIMIT (429) ---
        if (response.status === 429) {
          const scope = responseDataForError?.scope || '';
          const fallback = responseDataForError?.error || "You've reached your usage limit.";

          let userFriendlyMessage = fallback;

          if (scope === 'hourly') {
            userFriendlyMessage = "You‚Äôve reached the hourly dream limit (5 per hour). Try again in a few minutes ‚Äî your credits refill gradually.";
          } else if (scope === 'daily') {
            userFriendlyMessage = "You‚Äôve reached the daily dream limit (10 per day). Come back tomorrow to continue exploring. ‚ú®";
          }

          const messageWithLinkInChat = `${userFriendlyMessage} Want unlimited interpretations, a place to save your dreams, and a guide that‚Äôs always by your side? [Click here to join our waitlist!](/waitlist)`;

          toast.error(userFriendlyMessage);

          setMessages((prev) => [
            ...prev,
            {
              id: `error-rate-limit-${userMessageId}`,
              text: messageWithLinkInChat,
              isUser: false,
              timestamp: new Date(),
            },
          ]);

          return;
        }
        // --- FIM DO TRATAMENTO DE RATE LIMIT ---

        // Se n√£o for 429, mas ainda !response.ok, lance o erro para ser pego pelo catch principal
        throw new Error(errorMsg);
      }

      const responseData = await response.json();
      const { interpretation, savedDream } = responseData;

      if (user && savedDream) {
        addDream(savedDream);
        console.log("Dream added to the global store, triggering UI update.");
      }

      setMessages((prev) => [
        ...prev,
        {
          id: `bot-${userMessageId}`,
          text: interpretation || "Your dream has been saved to your journal.",
          isUser: false,
          timestamp: new Date(),
        },
      ]);

    } catch (error: any) {
      if (controller.signal.aborted) {
        console.log(`ChatWidget: sendDreamToAPI - Request aborted (caught in catch block) for userMessageId: ${userMessageId}.`);
      } else {
        console.error("ChatWidget: Dream interpretation error (via API route):", error);
        const errorText = error instanceof Error ? error.message : "An unknown error occurred.";
        toast.error(`Interpretation failed: ${errorText}`);
        setMessages((prev) => [
          ...prev,
          {
            id: `error-api-${userMessageId}`,
            text: `Sorry, I couldn't decode the dream right now. Please try again later.`,
            isUser: false,
            timestamp: new Date(),
          },
        ]);
      }
    } finally {
      console.log(`ChatWidget: sendDreamToAPI - Finally block. Current controller is ${abortControllerRef.current === controller ? 'SAME' : 'DIFFERENT/NULL'}. This request's controller signal aborted: ${controller.signal.aborted}`);
      if (abortControllerRef.current === controller) {
         setIsLoading(false);
         abortControllerRef.current = null;
         console.log("ChatWidget: sendDreamToAPI - Finally: isLoading set to false, current abortController cleared.");
      } else {
         console.log("ChatWidget: sendDreamToAPI - Finally: Active controller was different; not changing isLoading or abortControllerRef for this old/aborted request.");
      }
    }
  }, [sessionId, addDream, user]);

  useEffect(() => {
    console.log(`ChatWidget: useEffect[isOpenProp] changed. isOpenProp: ${isOpenProp}. Current isLoading: ${isLoading}, processedInitialDream: "${processedInitialDream}", messages.length: ${messages.length}, initialDream: "${initialDream}"`);
    if (!isOpenProp) {
      console.log("ChatWidget: useEffect[isOpenProp] - Closing. AbortController was:", abortControllerRef.current ? "active" : "null");
    } else {
      if (messages.length === 0 && !initialDream && !processedInitialDream) {
        console.log("ChatWidget: useEffect[isOpenProp] - Opening, displaying welcome message.");
        setMessages([
          {
            id: "welcome",
            text: "Welcome to the **Dream Decoder**! ‚ú® Share your dream, and let's explore its hidden depths together.",
            isUser: false,
            timestamp: new Date(),
          },
        ]);
        setProcessedInitialDream(null);
        setLikedMessages(new Set());
      }
      if (initialDream && initialDream !== processedInitialDream && sessionId) {
        console.log(`ChatWidget: useEffect[isOpenProp] - Opening, processing initialDream: "${initialDream}".`);
        const userMessageId = `user-initial-${Date.now()}`;
        const newUserMessage: Message = {
          id: userMessageId, text: initialDream, isUser: true, timestamp: new Date()
        };
        setMessages(prev => {
           const filtered = prev.filter(msg => msg.id !== 'welcome');
           return [...filtered, newUserMessage];
        });
        setProcessedInitialDream(initialDream);
        setMessage("");
        sendDreamToAPI(initialDream, userMessageId);
      } else if (initialDream && initialDream === processedInitialDream) {
          console.log(`ChatWidget: useEffect[isOpenProp] - Opening, initialDream ("${initialDream}") is same as processedInitialDream. Not re-processing.`);
      }
    }
  }, [isOpenProp, initialDream, processedInitialDream, sessionId, messages.length, sendDreamToAPI, isLoading]);

  useEffect(() => {
    scrollToBottom();
  }, [messages, scrollToBottom]);

  useEffect(() => {
    return () => {
      if (abortControllerRef.current) {
        console.log("ChatWidget: Unmounting, aborting active request.");
        abortControllerRef.current.abort();
        abortControllerRef.current = null;
      }
    };
  }, []);

  const handleClose = useCallback(() => {
    console.log(`ChatWidget: handleClose called. Current isLoading: ${isLoading}. AbortController active: ${!!abortControllerRef.current}`);
    if (abortControllerRef.current) {
      console.log("ChatWidget: Aborting active request via handleClose.");
      abortControllerRef.current.abort();
      abortControllerRef.current = null;
    }
    setIsLoading(false);
    console.log("ChatWidget: isLoading set to false by handleClose.");
    if (initialDream && processedInitialDream === initialDream) {
        console.log("ChatWidget: handleClose - initialDream was the one being processed. Current value of initialDream prop: ", initialDream);
    }
    onClose();
    console.log("ChatWidget: onClose prop has been called by handleClose.");
  }, [onClose, isLoading, initialDream, processedInitialDream]);

  const handleChatSubmit = useCallback(async (e: React.FormEvent) => {
    e.preventDefault();
    console.log(`ChatWidget: handleChatSubmit. isLoading: ${isLoading}, message: "${message.trim()}"`);
    const trimmedMessage = message.trim();

    if (isLoading) {
        console.log("ChatWidget: handleChatSubmit - bailing, isLoading is true.");
        toast.info("Please wait, previous request is processing.");
        return;
    }
    if (!trimmedMessage) {
      toast.info("Please describe your dream first.");
      return;
    }
    if (!sessionId) {
      toast.error("Session ID is missing. Cannot send message.");
      console.log("ChatWidget: handleChatSubmit - bailing, no sessionId.");
      return;
    }

    const userMessageId = `user-${Date.now()}`;
    const newMessageInstance: Message = {
      id: userMessageId, text: trimmedMessage, isUser: true, timestamp: new Date()
    };
    setMessages((prev) => [...prev, newMessageInstance]);
    setMessage("");
    await sendDreamToAPI(trimmedMessage, userMessageId);
  }, [message, isLoading, sendDreamToAPI, sessionId]);

  const stars = useMemo(() => {
    return [...Array(80)].map((_, i) => ({
      key: i, style: { top: `${Math.random() * 100}%`, left: `${Math.random() * 100}%`, width: `${Math.random() * 1.5 + 0.5}px`, height: `${Math.random() * 1.5 + 0.5}px`, animationDelay: `${Math.random() * 5}s`, animationDuration:`${Math.random() * 5 + 5}s`}
    }));
  }, []);

  useEffect(() => {
    console.log(`ChatWidget: isLoading state changed to: ${isLoading}`);
  }, [isLoading]);

  // This log is fine as it's outside the JSX return
  console.log("ChatWidget RENDER: isLoading =", isLoading, "message =", message, "isOpenProp =", isOpenProp, "initialDream =", initialDream, "processedInitialDream=", processedInitialDream);

  // Helper for JSX logging - returns null so it's a valid ReactNode
  const jsxLog = (logMessage: string, ...args: any[]): null => {
    console.log(logMessage, ...args);
    return null;
  };

  return (
    <AnimatePresence>
      {isOpenProp && (
        <motion.div
          key="chatWidgetRoot"
          className="fixed right-2 bottom-2 sm:right-6 sm:bottom-6 z-[100] w-[90vw] sm:w-[21rem] h-[85vh] sm:h-[550px] max-h-[calc(100vh-3rem)] rounded-2xl border border-[#9d6bff]/20 overflow-hidden flex flex-col bg-gradient-to-br from-[#1e1133] to-[#2a1a46]/95 shadow-[#9d6bff]/30 shadow-2xl backdrop-blur-lg"
          /* ---------- ENTRADA ---------- */
          initial={{ opacity: 0, y: 50, scale: 0.9, display: 'flex' }}
          animate={{
            opacity: 1,
            y: 0,
            scale: 1,
            display: 'flex',         // garante que volta a aparecer
            pointerEvents: 'auto',   // ‚Üê *** volta a aceitar cliques ***
          }}
          /* ---------- SA√çDA ---------- */
          exit={{
            opacity: 0,
            y: 50,
            scale: 0.9,
            transition: { duration: 0.25 },
            transitionEnd: {
              pointerEvents: 'none', // bloqueia cliques s√≥ DEPOIS da anima√ß√£o
              display: 'none',       // remove do fluxo
            },
          }}
        >
          <div className="absolute inset-0 overflow-hidden pointer-events-none z-0">
            {stars.map(({ key, style }) => ( <div key={key} className="absolute rounded-full bg-white/70 animate-twinkle" style={style} /> ))}
          </div>
          <div className="relative flex items-center justify-between px-3 py-2 sm:px-4 sm:py-3 border-b border-[#9d6bff]/20 z-10 flex-shrink-0 bg-gradient-to-b from-[#2a1a46]/80 to-[#2a1a46]/50 backdrop-blur-sm">
            <div className="flex items-center gap-2.5">
              <div className="p-1.5 bg-gradient-to-br from-[#9d6bff]/30 to-[#c4a8ff]/20 rounded-full shadow-inner">
                <Moon className="w-4 h-4 text-[#e0d1ff]" />
              </div>
              <h3 className="text-base font-medium text-[#e0d1ff]">Dream Decoder</h3>
            </div>
            <Button variant="ghost" size="icon" onClick={handleClose} className="h-9 w-9 sm:h-8 sm:w-8 text-[#c4a8ff] hover:text-white hover:bg-[#9d6bff]/30 rounded-full focus-visible:ring-2 focus-visible:ring-[#c4a8ff] focus-visible:ring-offset-2 focus-visible:ring-offset-[#2a1a46]" aria-label="Close Chat">
              <X className="w-4 h-4" />
            </Button>
          </div>

          <div className="relative flex-grow overflow-y-auto p-4 space-y-4 z-10 scrollbar-thin scrollbar-thumb-[#9d6bff]/40 hover:scrollbar-thumb-[#9d6bff]/60 scrollbar-track-transparent overscroll-behavior-contain">
            {messages.map((msg) => (
              <motion.div key={msg.id} layout="position" initial={{ opacity: 0, y: 15, scale: 0.95 }} animate={{ opacity: 1, y: 0, scale: 1, transition: { type: "spring", stiffness: 260, damping: 20 } }} className={`flex ${msg.isUser ? "justify-end" : "justify-start"}`}> {/* CORRECTED: msg.isUser */}
                <div id={msg.id} className={`group relative max-w-[85%] px-3 py-2 rounded-3xl text-xs leading-relaxed shadow-md ${msg.isUser ? "bg-gradient-to-br from-[#a87aff] to-[#8a5ae0] text-white rounded-tr-none" : "bg-[#351d5e] border border-[#9d6bff]/20 text-[#e0d1ff] rounded-tl-none"} ${msg.id.startsWith('error-') ? 'border-red-500/40' : '' }`} style={{ boxShadow: msg.isUser ? "0 3px 10px rgba(157, 107, 255, 0.3)" : "0 2px 8px rgba(0, 0, 0, 0.2)", overflowWrap: 'break-word' }}> {/* CORRECTED: msg.isUser */}
                  <div className={`prose prose-sm prose-invert max-w-none ${msg.id.startsWith('error-') ? 'prose-p:text-red-300/90' : ''}`}>
                      <ReactMarkdown remarkPlugins={[remarkGfm]} components={customMarkdownComponents}>{msg.text}</ReactMarkdown>
                  </div>
                  {!msg.isUser && ( /* CORRECTED: !msg.isUser */
                    <div className={`mt-2 pt-1.5 border-t ${msg.id.startsWith('error-') ? 'border-red-500/20' : 'border-[#9d6bff]/20'} flex justify-between items-center text-[9px] text-[#c4a8ff]/70`}>
                      <span>{msg.timestamp.toLocaleTimeString([], { hour: "2-digit", minute: "2-digit" })}</span>
                      {!msg.id.startsWith('error-') && (
                        <div className="flex items-center gap-1.5 opacity-0 group-hover:opacity-100 transition-opacity duration-200">
                          <button onClick={() => handleCopy(msg.text, msg.id)} className="p-1 hover:text-[#e0d1ff] relative rounded-full hover:bg-[#9d6bff]/20 focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-[#c4a8ff]" aria-label="Copy interpretation">
                            <Copy className="w-3 h-3" />
                            {copyTooltip === msg.id && ( <motion.span initial={{ opacity: 0, scale: 0.8 }} animate={{ opacity: 1, scale: 1 }} className="absolute -top-7 left-1/2 transform -translate-x-1/2 bg-[#1e1133] px-2 py-1 rounded text-[9px] whitespace-nowrap shadow-lg border border-[#9d6bff]/20">Copied!</motion.span> )}
                          </button>
                          <button onClick={() => handleLikeToggle(msg.id)} className={`p-1 rounded-full hover:bg-[#9d6bff]/20 focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-[#c4a8ff] ${likedMessages.has(msg.id) ? 'text-[#ff8f8f]' : 'hover:text-[#ffc7c7]'}`} aria-label={likedMessages.has(msg.id) ? "Unlike interpretation" : "Like interpretation"}>
                            <Heart className={`w-3 h-3 transition-colors ${likedMessages.has(msg.id) ? 'fill-current' : ''}`} />
                          </button>
                        </div>
                      )}
                    </div>
                  )}
                  {msg.isUser && ( <p className="text-[9px] text-white/60 mt-1.5 text-right">{msg.timestamp.toLocaleTimeString([], { hour: "2-digit", minute: "2-digit" })}</p> )} {/* CORRECTED: msg.isUser */}
                </div>
              </motion.div>
            ))}
            {isLoading && (
              <motion.div layout="position" initial={{ opacity: 0 }} animate={{ opacity: 1 }} exit={{ opacity: 0 }} className="flex justify-start">
                <div className="flex items-center space-x-2 p-3 rounded-lg bg-[#2a1a46]/70 border border-[#9d6bff]/10 backdrop-blur-sm shadow-md">
                  <motion.div className="w-1.5 h-1.5 bg-[#c4a8ff] rounded-full" animate={{ scale: [1, 1.3, 1], opacity: [0.7, 1, 0.7] }} transition={{ duration: 0.8, repeat: Infinity, ease: "easeInOut" }} />
                  <motion.div className="w-1.5 h-1.5 bg-[#c4a8ff] rounded-full" animate={{ scale: [1, 1.3, 1], opacity: [0.7, 1, 0.7] }} transition={{ duration: 0.8, repeat: Infinity, ease: "easeInOut", delay: 0.2 }} />
                  <motion.div className="w-1.5 h-1.5 bg-[#c4a8ff] rounded-full" animate={{ scale: [1, 1.3, 1], opacity: [0.7, 1, 0.7] }} transition={{ duration: 0.8, repeat: Infinity, ease: "easeInOut", delay: 0.4 }} />
                  <span className="text-xs text-[#c4a8ff]/90 pl-1">Decoding...</span>
                </div>
              </motion.div>
            )}
            <div ref={messagesEndRef} className="h-1" />
          </div>
          
          {/* CORRECTED JSX LOGGING APPROACH */}
          {jsxLog("ChatWidget FORM RENDER: isLoading =", isLoading, "message empty =", !message.trim())}
          <form onSubmit={handleChatSubmit} className="sticky bottom-0 z-10 border-t border-[#9d6bff]/20 bg-gradient-to-t from-[#2a1a46]/80 to-[#2a1a46]/50 backdrop-blur-sm">
            <div className="p-4 flex items-end gap-3">
              {jsxLog("ChatWidget TEXTAREA RENDER: isLoading =", isLoading)}
              <TextareaAutosize
                value={message}
                onChange={(e) => setMessage(e.target.value)}
                placeholder="Describe your dream..."
                className={cn(
                  "flex-grow resize-none shadow-inner scrollbar-thin scrollbar-thumb-[#9d6bff]/30 scrollbar-track-transparent transition-colors duration-200",
                  "bg-[#1e1133]/60 border border-[#9d6bff]/30 text-[#e0d1ff] placeholder-[#c4a8ff]/50",
                  "focus:ring-2 focus:ring-[#9d6bff]/50 focus:border-[#9d6bff]/50 focus:outline-none",
                  "py-2.5 px-4 rounded-3xl text-base sm:text-sm"
                )}
                minRows={1} maxRows={5}
                onKeyDown={(e) => { if (e.key === "Enter" && !e.shiftKey) { e.preventDefault(); handleChatSubmit(e as unknown as React.FormEvent); }}}
                aria-label="Enter your dream description"
                disabled={isLoading}
              />
              {jsxLog("ChatWidget BUTTON RENDER: isLoading =", isLoading, "message empty =", !message.trim())}
              <Button type="submit" disabled={isLoading || !message.trim()} className="h-9 w-9 p-0 flex-shrink-0 bg-gradient-to-br from-[#8a5ae0] to-[#9d6bff] hover:from-[#7f4fe0] hover:to-[#8f5ae0] text-white disabled:bg-gradient-to-br disabled:from-[#5c4b8e]/70 disabled:to-[#5c4b8e]/70 disabled:opacity-60 disabled:cursor-not-allowed transition-all duration-200 rounded-3xl flex items-center justify-center shadow-md hover:shadow-lg hover:shadow-[#9d6bff]/30 disabled:shadow-none focus-visible:ring-2 focus-visible:ring-[#c4a8ff] focus-visible:ring-offset-2 focus-visible:ring-offset-[#2a1a46]" aria-label="Send dream">
                {isLoading ? <Loader2 className="w-5 h-5 animate-spin" /> : <Send className="w-5 h-5" />}
              </Button>
            </div>
          </form>
        </motion.div>
      )}
    </AnimatePresence>
  );
}

// ChatToggleButton was missing from the previous full file, adding it back.
export function ChatToggleButton({ onClick }: { onClick: () => void }) {
  return (
    <motion.button
      onClick={onClick}
      className="fixed bottom-6 right-6 z-[90] text-[#e0d1ff] p-3.5 rounded-full shadow-xl hover:shadow-[#9d6bff]/50 focus:outline-none focus-visible:ring-2 focus-visible:ring-[#c4a8ff] focus-visible:ring-offset-2 focus-visible:ring-offset-[#1e1133]"
      style={{
        background: "linear-gradient(135deg, #2a1a46 0%, #3a1a66 100%)",
        boxShadow: "0 10px 25px rgba(157, 107, 255, 0.3)",
      }}
      whileHover={{ scale: 1.08, rotate: 8, transition: { type: 'spring', stiffness: 300, damping: 15 } }}
      whileTap={{ scale: 0.95 }}
      initial={{ opacity: 0, scale: 0.5, y: 20 }}
      animate={{ opacity: 1, scale: 1, y: 0, transition: { delay: 0.2, duration: 0.3, ease: "easeOut" } }}
      aria-label="Open Dream Decoder"
    >
      <Moon className="w-5 h-5" />
    </motion.button>
  );
}

# =================================================================
# Arquivo: .\components\chat\voiceflow-chat.tsx
# =================================================================

"use client";

import { useEffect } from 'react';
import Script from 'next/script';

declare global {
  interface Window {
    voiceflow: {
      chat: {
        load: (config: any) => void;
        open: () => void;
        close: () => void;
        hide: () => void;
        show: () => void;
        interact: (action: any) => void;
        proactive: {
          push: (...messages: any[]) => void;
          clear: () => void;
        };
      };
    };
  }
}

export function VoiceflowChat() {
  useEffect(() => {
    // Initialize chat when component mounts
    const initChat = () => {
      if (window.voiceflow?.chat) {
        window.voiceflow.chat.load({
          verify: { 
            projectID: process.env.NEXT_PUBLIC_VOICEFLOW_PROJECT_ID 
          },
          url: process.env.NEXT_PUBLIC_VOICEFLOW_RUNTIME_URL || 'https://general-runtime.voiceflow.com',
          versionID: process.env.NEXT_PUBLIC_VOICEFLOW_VERSION_ID || 'development',
          assistant: {
            title: 'Dream Guide',
            description: 'Your personal dream interpretation assistant',
            color: '#8B5CF6',
          }
        });
      }
    };

    // Try to initialize immediately if script is already loaded
    initChat();

    return () => {
      // Hide chat when component unmounts
      window.voiceflow?.chat?.hide();
    };
  }, []);

  return (
    <Script
      src="https://cdn.voiceflow.com/widget/bundle.mjs"
      strategy="afterInteractive"
      onLoad={() => {
        window.voiceflow?.chat?.load({
          verify: { 
            projectID: process.env.NEXT_PUBLIC_VOICEFLOW_PROJECT_ID 
          }
        });
      }}
    />
  );
}

# =================================================================
# Arquivo: .\components\dashboard\empty-state.tsx
# =================================================================

"use client";

import { Button } from "@/components/ui/button";
import { MoonStar, Plus } from "lucide-react";
import { useChatWidget } from "@/hooks/use-chat-widget"; // 1. IMPORTA o hook

export function EmptyState() {
  const { onOpen } = useChatWidget(); // 2. OBT√âM a fun√ß√£o para abrir o chat

  return (
    <div className="text-center py-16 sm:py-24 px-4 flex flex-col items-center">
      <div className="p-4 bg-purple-500/10 rounded-full border border-purple-500/20 mb-6">
        <MoonStar className="w-10 h-10 text-purple-300" />
      </div>
      <h2 className="text-2xl sm:text-3xl font-display-marcellus text-purple-100 tracking-tight">
        Your Dream Journal Awaits
      </h2>
      <p className="mt-3 max-w-md mx-auto text-sm text-purple-200/70 font-light leading-relaxed">
        Every dream is a conversation with yourself. Start capturing those whispers
        to uncover hidden patterns and begin your journey of self-discovery.
      </p>
      <div className="mt-8">
        <Button
          onClick={onOpen} // 3. CONECTA a fun√ß√£o ao clique do bot√£o
          size="lg"
          className="bg-gradient-to-r from-purple-500/90 to-indigo-500/90
            hover:from-purple-500 hover:to-indigo-500
            text-white font-medium px-6 py-3 text-base
            rounded-full shadow-lg shadow-purple-500/25
            hover:shadow-purple-500/40
            transition-all duration-300 border border-white/10
            hover:border-white/20 flex items-center gap-2"
        >
          <Plus className="w-5 h-5" />
          Write last night‚Äôs dream
        </Button>
      </div>
    </div>
  );
}

# =================================================================
# Arquivo: .\components\dashboard\header.tsx
# =================================================================

"use client";

import { useAuth } from '@/components/auth-provider';

export function DashboardHeader(): JSX.Element {
  const { user } = useAuth();
  const name: string = user?.user_metadata?.name || 'Dreamer';

  return (
    <div className="flex flex-col items-center space-y-3">
      <h1 className="text-4xl font-display text-purple-100 tracking-tight">
        Welcome back, {name}
      </h1>
      <p className="text-sm text-purple-200/70 font-light">
        Your dreams are whispering... shall we listen?
      </p>
    </div>
  );
}

# =================================================================
# Arquivo: .\components\dashboard\profile-banner.tsx
# =================================================================

"use client";

import Link from 'next/link';
import { Briefcase, Sparkles, Target } from 'lucide-react';
import { Progress } from '@/components/ui/progress';

export function ProfileBanner() {
  return (
    <Link href="/dashboard/space" className="block h-full">
      <div className="dashboard-card p-6 hover:bg-purple-500/5 transition-colors h-full">
        <div className="flex justify-between items-center mb-4">
          <div>
            <h3 className="text-lg font-light text-purple-100">Complete Your Profile</h3>
            <p className="text-sm text-purple-200/60">Get more personalized dream analysis</p>
          </div>
          <div className="text-sm text-purple-300">50%</div>
        </div>

        <Progress value={50} className="bg-purple-950/30 h-2 mb-6">
          <div className="bg-gradient-to-r from-purple-500 to-purple-400 h-full rounded-full" />
        </Progress>

        <div className="space-y-4">
          <div className="flex items-center gap-4">
            <div className="flex items-center gap-2 flex-1">
              <Briefcase className="w-4 h-4 text-purple-300/70" />
              <span className="text-purple-200/70 text-sm">Add occupation</span>
            </div>
            <div className="w-24 h-1.5 bg-purple-950/30 rounded-full overflow-hidden">
              <div className="w-[10%] h-full bg-purple-500/40 rounded-full" />
            </div>
          </div>
          
          <div className="flex items-center gap-4">
            <div className="flex items-center gap-2 flex-1">
              <Sparkles className="w-4 h-4 text-purple-300/70" />
              <span className="text-purple-200/70 text-sm">Add spiritual background</span>
            </div>
            <div className="w-24 h-1.5 bg-purple-950/30 rounded-full overflow-hidden">
              <div className="w-[15%] h-full bg-purple-500/40 rounded-full" />
            </div>
          </div>
          
          <div className="flex items-center gap-4">
            <div className="flex items-center gap-2 flex-1">
              <Target className="w-4 h-4 text-purple-300/70" />
              <span className="text-purple-200/70 text-sm">Set goals</span>
            </div>
            <div className="w-24 h-1.5 bg-purple-950/30 rounded-full overflow-hidden">
              <div className="w-[25%] h-full bg-purple-500/40 rounded-full" />
            </div>
          </div>
        </div>
      </div>
    </Link>
  );
}

# =================================================================
# Arquivo: .\components\dashboard\profile-completion.tsx
# =================================================================

"use client";

import { User, Briefcase, Sparkles, Target, ArrowRight } from 'lucide-react';
import { Progress } from '@/components/ui/progress';
import { Button } from '@/components/ui/button';
import Link from 'next/link';
import { CardContainer } from './cards/card-container';
import { CardHeader } from './cards/card-header';
import { CardFooter } from './cards/card-footer';
import { FeatureGrid } from './cards/feature-grid';

const features = [
  {
    icon: <Briefcase className="w-4 h-4 text-purple-300/90" />,
    title: "Add occupation",
    description: "Help us understand your daily context",
    percentage: "+10%"
  },
  {
    icon: <Sparkles className="w-4 h-4 text-purple-300/90" />,
    title: "Add spiritual background",
    description: "Connect with your beliefs",
    percentage: "+15%"
  },
  {
    icon: <Target className="w-4 h-4 text-purple-300/90" />,
    title: "Set goals",
    description: "Define your dream journey objectives",
    percentage: "+25%"
  }
];

export function ProfileCompletion() {
  return (
    <div className="h-full">
      <CardContainer>
        <CardHeader
          icon={<User className="w-5 h-5 text-purple-300" />}
          title="Awaken Your Dreams"
          description="Complete your profile to unlock deeper insights"
        />

        <div className="space-y-6">
          <div className="space-y-2">
            <div className="flex justify-between items-center">
              <span className="text-sm text-purple-200/70">50% Complete</span>
              <span className="text-sm font-medium text-purple-300">3 steps left</span>
            </div>
            <div className="h-2 rounded-full bg-purple-900/40">
              <div 
                className="h-full rounded-full bg-gradient-to-r from-purple-500 to-purple-400 
                transition-all duration-700"
                style={{ width: '50%' }}
              />
            </div>
          </div>

          <FeatureGrid features={features} showPercentage />
        </div>

        <CardFooter disclaimer={["Each detail makes your dream interpretations uniquely yours"]}>
          <Link href="/dashboard/space" className="w-full">
            <Button
              className="w-full bg-gradient-to-r from-purple-500/80 to-indigo-500/80 
                hover:from-purple-500/90 hover:to-indigo-500/90
                text-white font-medium px-6 py-2
                rounded-full shadow-lg shadow-purple-500/20
                hover:shadow-purple-500/30
                transition-all duration-300 border border-white/10
                hover:border-white/20 flex items-center justify-center gap-2"
              size="lg"
            >
              <ArrowRight className="w-4 h-4" />
              Go to Bloom Space
            </Button>
          </Link>
        </CardFooter>
      </CardContainer>
    </div>
  );
}

# =================================================================
# Arquivo: .\components\dashboard\recent-dreams.tsx
# =================================================================

"use client";

import { ArrowRight, BookOpen, Star } from 'lucide-react';
import { Button } from '@/components/ui/button';
import { CardContainer, CardHeader, CardFooter } from './cards';

interface Dream {
  id: number;
  date: string;
  content: string;
  symbols: string[];
  hasConnections: boolean;
}

interface RecentDreamsProps {
  dreams: Dream[];
}

export function RecentDreams({ dreams }: RecentDreamsProps) {
  return (
    <CardContainer>
      <CardHeader
        icon={<BookOpen className="w-5 h-5 text-purple-300" />}
        title="Recent Dreams"
        description="Your latest dream explorations"
      />

      <div className="space-y-6">
        {dreams.map((dream) => (
          <div
            key={dream.id}
            className="group space-y-4 pb-6 border-b border-purple-500/10 last:pb-0 last:border-0"
          >
            <div className="flex justify-between items-start">
              <div className="space-y-1">
                <span className="text-sm text-purple-200/80">{dream.date}</span>
                <p className="text-purple-100/90 leading-relaxed">{dream.content}</p>
              </div>
              {dream.hasConnections && (
                <div className="flex items-center gap-1 text-purple-300/60">
                  <Star className="w-4 h-4" />
                </div>
              )}
            </div>

            <div className="flex items-center justify-between">
              <div className="flex gap-2">
                {dream.symbols.map((symbol) => (
                  <span
                    key={`${dream.id}-${symbol}`}
                    className="text-xs px-2 py-1 rounded-full bg-purple-500/10 text-purple-200/70
                      border border-purple-500/5"
                  >
                    {symbol}
                  </span>
                ))}
              </div>

              <Button
                variant="link"
                className="text-sm text-purple-300 hover:text-purple-200 flex items-center gap-1"
              >
                Explore
                <ArrowRight className="w-4 h-4" />
              </Button>
            </div>
          </div>
        ))}
      </div>

      <CardFooter disclaimer={["Explore your dream patterns", "Uncover hidden meanings"]}>
        <Button
          className="w-full bg-gradient-to-r from-purple-500/80 to-indigo-500/80 
            hover:from-purple-500/90 hover:to-indigo-500/90
            text-white font-medium px-6 py-2
            rounded-full shadow-lg shadow-purple-500/20
            hover:shadow-purple-500/30
            transition-all duration-300 border border-white/10
            hover:border-white/20 flex items-center justify-center gap-2"
          size="lg"
        >
          <BookOpen className="w-4 h-4" />
          View All Dreams
        </Button>
      </CardFooter>
    </CardContainer>
  );
}

# =================================================================
# Arquivo: .\components\dashboard\stats.tsx
# =================================================================

"use client";
import { History, Star, Trophy } from 'lucide-react';
import { Tooltip, TooltipContent, TooltipProvider, TooltipTrigger } from '@/components/ui/tooltip';

export function DashboardStats() {
  const stats = [
    {
      icon: History,
      title: "Dreams Recorded",
      value: "7 dreams",
      subtitle: "3 this week"
    },
    {
      icon: Trophy,
      title: "Latest Achievement",
      value: "Explorer of the Infinite Realm of Lucid Dreaming",
      subtitle: "Check your Blooming Path"
    },
    {
      icon: Star,
      title: "Daily Streak",
      value: "3 days in a row",
      subtitle: "Keep it going!"
    }
  ];

  return (
    <div className="grid grid-cols-1 md:grid-cols-3 gap-3">
      {stats.map((stat, index) => (
        <div 
          key={index} 
          className="dashboard-card p-3 relative group flex items-start min-h-[10px] hover:bg-purple-500/5 transition-colors"
        >
          <div className="flex flex-col w-full justify-between">
            <div className="flex items-center gap-2">
              <div className="w-6 h-6 rounded-lg bg-purple-500/10 flex items-center justify-center group-hover:bg-purple-500/20 transition-colors">
                <stat.icon className="w-3 h-3 text-purple-300/90" />
              </div>
              <p className="text-xs text-purple-200/70">{stat.title}</p>
            </div>
            
            <div className="flex flex-col items-center space-y-1 mt-1">
  {stat.icon === Trophy ? (
    <TooltipProvider>
      <Tooltip>
        <TooltipTrigger asChild>
          <p className="text-lg text-purple-100 truncate w-full text-center px-2">
            {stat.value}
          </p>
        </TooltipTrigger>
        <TooltipContent side="top" className="border-0 bg-black/90 max-w-[200px]" sideOffset={5}>
          <p className="text-xs text-center">{stat.value}</p>
        </TooltipContent>
      </Tooltip>
    </TooltipProvider>
  ) : (
    <p className="text-lg text-purple-100 truncate w-full text-center px-2">
      {stat.value}
    </p>
  )}
  <p className="text-2xs tracking-wider text-purple-300/50 text-center max-w-[160px]">
    {stat.subtitle}
  </p>
</div>
          </div>
        </div>
      ))}
    </div>
  );
}

# =================================================================
# Arquivo: .\components\dashboard\whatsapp-connect.tsx
# =================================================================

"use client";

import { MessagesSquare, PenLine, Heart, Zap } from "lucide-react";
import { Button } from "@/components/ui/button";
import { CardContainer, CardHeader, CardFooter, FeatureGrid } from "./cards";
import { WhatsAppIcon } from "@/components/icons/whatsapp-icon";

const features = [
  {
    icon: <PenLine className="w-4 h-4 text-purple-300/90" />,
    title: "Dream Recorder",
    description: "Save your dreams, through voice or text, as soon as you wake up"
  },
  {
    icon: <MessagesSquare className="w-4 h-4 text-purple-300/90" />,
    title: "Always Connected",
    description: "Accessible anytime, anywhere, whenever you need"
  },
  {
    icon: <Zap className="w-4 h-4 text-purple-300/90" />,
    title: "Instant Insights",
    description: "Reveal the hidden meanings of your dreams instantly"
  },
  {
    icon: <Heart className="w-4 h-4 text-purple-300/90" />,
    title: "Meaningful Chats",
    description: "A companion that remembers your story and knows you"
  }
];

export function WhatsAppConnect() {
  return (
    <div className="h-full">
      <CardContainer>
        <CardHeader
          icon={<WhatsAppIcon className="w-5 h-5 text-purple-300" />}
          title="Never Miss a Dream"
          description="Your companion in self-discovery, one message away"
        />

        <FeatureGrid features={features} />

        <CardFooter
          disclaimer={["Easy setup", "Private & secure", "Your journey at your pace"]}
        >
          <Button
            className="w-full bg-gradient-to-r from-purple-500/80 to-indigo-500/80 
              hover:from-purple-500/90 hover:to-indigo-500/90
              text-white font-medium px-6 py-2
              rounded-full shadow-lg shadow-purple-500/20
              hover:shadow-purple-500/30
              transition-all duration-300 border border-white/10
              hover:border-white/20 flex items-center justify-center gap-2"
            size="lg"
          >
            <WhatsAppIcon className="w-4 h-4" />
            Connect your WhatsApp
          </Button>
        </CardFooter>
      </CardContainer>
    </div>
  );
}

# =================================================================
# Arquivo: .\components\dashboard\cards\card-container.tsx
# =================================================================

"use client";

interface CardContainerProps {
  children: React.ReactNode;
  className?: string;
}

export function CardContainer({ children, className = "" }: CardContainerProps) {
  return (
    <div className={`rounded-2xl depth-card overflow-hidden ${className}`}>
      <div className="relative px-6 sm:px-8 lg:px-10 pt-6 pb-6 space-y-8">
        {children}
      </div>
    </div>
  );
}


# =================================================================
# Arquivo: .\components\dashboard\cards\card-footer.tsx
# =================================================================

"use client";

interface CardFooterProps {
  children: React.ReactNode;
  disclaimer?: string[];
}

export function CardFooter({ children, disclaimer }: CardFooterProps) {
  if (!children && !disclaimer) return null;
  
  return (
    <div className="space-y-3 pt-2">
      {children}
      
      {disclaimer && disclaimer.length > 0 && (
        <div className="flex items-center justify-center gap-2 text-xs text-purple-200/50">
          {disclaimer.map((text, index) => (
            <div key={`disclaimer-${index}`} className="flex items-center">
              {index > 0 && <span className="mx-2">‚Ä¢</span>}
              <span>{text}</span>
            </div>
          ))}
        </div>
      )}
    </div>
  );
}

# =================================================================
# Arquivo: .\components\dashboard\cards\card-header.tsx
# =================================================================

"use client";

interface CardHeaderProps {
  icon: React.ReactNode;
  title: string;
  description: string;
}

export function CardHeader({ icon, title, description }: CardHeaderProps) {
  return (
    <div className="space-y-2">
      <div className="flex items-center gap-3">
        <div className="w-10 h-10 rounded-xl bg-purple-500/20 flex items-center justify-center">
          {icon}
        </div>
        <div>
          <h3 className="text-xl font-semibold tracking-wide text-white/90">
            {title}
          </h3>
          <p className="text-sm font-light text-purple-200/60">
            {description}
          </p>
        </div>
      </div>
    </div>
  );
}

# =================================================================
# Arquivo: .\components\dashboard\cards\feature-grid.tsx
# =================================================================

"use client";

interface FeatureGridProps {
  features: {
    icon: React.ReactNode;
    title: string;
    description: string;
    percentage?: string;
  }[];
  showPercentage?: boolean;
}

export function FeatureGrid({ features, showPercentage = false }: FeatureGridProps) {
  return (
    <div className={`grid grid-cols-1 ${showPercentage ? 'gap-4' : 'sm:grid-cols-2 gap-6'}`}>
      {features.map((feature, index) => (
        <div key={`feature-${index}`} className={showPercentage ? 'flex items-center' : undefined}>
          <div className="group flex items-center gap-3 flex-1">
            <div className="w-8 h-8 rounded-lg bg-purple-500/10 flex items-center justify-center
              group-hover:bg-purple-500/20 transition-colors duration-300 flex-shrink-0">
              {feature.icon}
            </div>
            <div className="space-y-1 py-0.5">
              <h4 className="text-sm font-medium text-purple-100">{feature.title}</h4>
              <p className="text-xs leading-relaxed text-purple-200/60">
                {feature.description}
              </p>
            </div>
          </div>
          {showPercentage && feature.percentage && (
            <span className="text-sm text-purple-300/90 ml-auto">{feature.percentage}</span>
          )}
        </div>
      ))}
    </div>
  );
}

# =================================================================
# Arquivo: .\components\dashboard\cards\feature-item.tsx
# =================================================================

"use client";

interface FeatureItemProps {
  icon: React.ReactNode;
  title: string;
  description: string;
}

export function FeatureItem({ icon, title, description }: FeatureItemProps) {
  return (
    <div className="group flex items-center gap-3">
      <div className="w-8 h-8 rounded-lg bg-purple-500/10 flex items-center justify-center
        group-hover:bg-purple-500/20 transition-colors duration-300 flex-shrink-0">
        {icon}
      </div>
      <div className="space-y-1 py-0.5">
        <h4 className="text-sm font-medium text-purple-100">{title}</h4>
        <p className="text-xs leading-relaxed text-purple-200/60">
          {description}
        </p>
      </div>
    </div>
  );
}

# =================================================================
# Arquivo: .\components\dashboard\cards\index.ts
# =================================================================

export * from './card-container';
export * from './card-header';
export * from './card-footer';
export * from './feature-grid';
export * from './feature-item';

# =================================================================
# Arquivo: .\components\icons\dream-clock.tsx
# =================================================================

"use client";

export function DreamClock() {
  return (
    <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
      {/* Brain with subtle glow */}
      <path
        d="M12 6C15.3137 6 18 8.68629 18 12C18 15.3137 15.3137 18 12 18C8.68629 18 6 15.3137 6 12C6 8.68629 8.68629 6 12 6Z"
        className="stroke-current"
        strokeWidth="1.5"
        strokeLinecap="round"
        strokeLinejoin="round"
      />
      <path
        d="M12 8C13.6569 8 15 9.34315 15 11C15 12.6569 13.6569 14 12 14C10.3431 14 9 12.6569 9 11C9 9.34315 10.3431 8 12 8Z"
        className="stroke-current fill-current opacity-10"
        strokeWidth="1.5"
      />
      
      {/* Subtle sparkles */}
      <circle cx="12" cy="4" r="1" className="fill-current animate-pulse" />
      <circle cx="20" cy="12" r="1" className="fill-current animate-pulse" />
      <circle cx="12" cy="20" r="1" className="fill-current animate-pulse" />
      <circle cx="4" cy="12" r="1" className="fill-current animate-pulse" />
    </svg>
  );
}

# =================================================================
# Arquivo: .\components\icons\dream-eye.tsx
# =================================================================

"use client";

export function DreamEye() {
  return (
    <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
      {/* Moon */}
      <path
        d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"
        className="stroke-current"
        strokeWidth="1.5"
        strokeLinecap="round"
        strokeLinejoin="round"
      />
      
      {/* Subtle stars */}
      <circle cx="8" cy="9" r="1" className="fill-current animate-pulse" />
      <circle cx="15" cy="17" r="1" className="fill-current animate-pulse" />
      <circle cx="17" cy="11" r="1" className="fill-current animate-pulse" />
    </svg>
  );
}

# =================================================================
# Arquivo: .\components\icons\dream-growth.tsx
# =================================================================

"use client";

export function DreamGrowth() {
  return (
    <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
      {/* Flower */}
      <path
        d="M12 3C12 3 14 7 14 12C14 17 12 21 12 21"
        className="stroke-current"
        strokeWidth="1.5"
        strokeLinecap="round"
      />
      
      {/* Petals */}
      <path
        d="M12 12C12 12 8 10 6 7M12 12C12 12 16 10 18 7M12 12C12 12 8 14 6 17M12 12C12 12 16 14 18 17"
        className="stroke-current"
        strokeWidth="1.5"
        strokeLinecap="round"
        strokeLinejoin="round"
      />
      
      {/* Moon */}
      <path
        d="M16 5.79A3 3 0 1 1 13.21 3 2.5 2.5 0 0 0 16 5.79z"
        className="stroke-current"
        strokeWidth="1.5"
        strokeLinecap="round"
        strokeLinejoin="round"
      />
    </svg>
  );
}

# =================================================================
# Arquivo: .\components\icons\whatsapp-icon.tsx
# =================================================================

"use client";

export function WhatsAppIcon({ className = "w-4 h-4" }: { className?: string }) {
  return (
    <svg 
      viewBox="0 0 24 24" 
      fill="currentColor"
      className={className}
    >
      <path d="M17.472 14.382c-.297-.149-1.758-.867-2.03-.967-.273-.099-.471-.148-.67.15-.197.297-.767.966-.94 1.164-.173.199-.347.223-.644.075-.297-.15-1.255-.463-2.39-1.475-.883-.788-1.48-1.761-1.653-2.059-.173-.297-.018-.458.13-.606.134-.133.298-.347.446-.52.149-.174.198-.298.298-.497.099-.198.05-.371-.025-.52-.075-.149-.669-1.612-.916-2.207-.242-.579-.487-.5-.669-.51-.173-.008-.371-.01-.57-.01-.198 0-.52.074-.792.372-.272.297-1.04 1.016-1.04 2.479 0 1.462 1.065 2.875 1.213 3.074.149.198 2.096 3.2 5.077 4.487.709.306 1.262.489 1.694.625.712.227 1.36.195 1.871.118.571-.085 1.758-.719 2.006-1.413.248-.694.248-1.289.173-1.413-.074-.124-.272-.198-.57-.347m-5.421 7.403h-.004a9.87 9.87 0 01-5.031-1.378l-.361-.214-3.741.982.998-3.648-.235-.374a9.86 9.86 0 01-1.51-5.26c.001-5.45 4.436-9.884 9.888-9.884 2.64 0 5.122 1.03 6.988 2.898a9.825 9.825 0 012.893 6.994c-.003 5.45-4.437 9.884-9.885 9.884m8.413-18.297A11.815 11.815 0 0012.05 0C5.495 0 .16 5.335.157 11.892c0 2.096.547 4.142 1.588 5.945L.057 24l6.305-1.654a11.882 11.882 0 005.683 1.448h.005c6.554 0 11.89-5.335 11.893-11.893a11.821 11.821 0 00-3.48-8.413z"/>
    </svg>
  );
}

# =================================================================
# Arquivo: .\components\journal\dream-card.tsx
# =================================================================

// components/journal/dream-card.tsx
"use client";

import { X, Pencil, Trash2, Zap, Brain, Link as LinkIcon, Star, Moon } from "lucide-react";
import { CardContainer } from "../dashboard/cards/card-container";
import { Button } from "../ui/button";
import {
  Dialog,
  DialogContent,
  DialogHeader,
  DialogTitle,
  DialogDescription,
  DialogClose,
} from "../ui/dialog";
import { useState } from "react";
import { motion } from "framer-motion";
import { cn } from "@/lib/utils";
import ReactMarkdown from "react-markdown";
import remarkGfm from "remark-gfm";

// üí´ separador mais et√©reo e leve
const DreamscapeSeparator = ({ className }: { className?: string }) => (
  <div
    className={cn(
      "h-px w-full my-5",
      "bg-gradient-to-r from-transparent via-purple-400/20 to-transparent",
      "blur-[0.4px]",
      className
    )}
  />
);

interface DreamCardProps {
  dream: {
    id: string;
    title: string;
    created_at: string;
    content: string;
    tags: string[] | null;
    mood: string | null;
    interpretation?: string | null;
  };
  variant?: "default" | "alt";
  onUpdate?: (id: string, data: any) => void;
  onDelete?: (id: string) => void;
}

// üåô linguagem mais simb√≥lica
const moodLabels: Record<string, { label: string; emoji: string }> = {
  serene: { label: "Still Waters", emoji: "üåô" },
  luminous: { label: "Radiant Vision", emoji: "üåï" },
  melancholic: { label: "Fading Echoes", emoji: "üå´Ô∏è" },
  turbulent: { label: "Restless Tide", emoji: "üåä" },
  uncanny: { label: "Strange Mirror", emoji: "ü™û" },
  exhilarating: { label: "Wild Ascent", emoji: "‚ö°" },
  ominous: { label: "Dark Whisper", emoji: "üåë" },
  introspective: { label: "Inner Journey", emoji: "üïØÔ∏è" },
};

function fmtCard(d: Date) {
  return `${d.toLocaleDateString("en-US", { month: "short", day: "numeric" })} ‚Ä¢ ${d.toLocaleTimeString(
    "en-US",
    { hour: "2-digit", minute: "2-digit" }
  )}`;
}
function fmtHeader(d: Date) {
  return d.toLocaleString("en-US", {
    weekday: "long",
    year: "numeric",
    month: "long",
    day: "numeric",
    hour: "2-digit",
    minute: "2-digit",
  });
}

export function DreamCard({ dream, variant = "default", onUpdate, onDelete }: DreamCardProps) {
  const [isOpen, setIsOpen] = useState(false);

  const moodKey = dream.mood || "serene";
  const mood = moodLabels[moodKey] ?? { label: moodKey, emoji: "‚ú®" };

  const date = new Date(dream.created_at);
  const metaCard = fmtCard(date);
  const metaHeader = fmtHeader(date);

  const preview =
    dream.content.length > 140 ? `${dream.content.slice(0, 140)}‚Ä¶` : dream.content;

  return (
    <motion.div
      initial={{ opacity: 0, y: 10 }}
      animate={{ opacity: 1, y: 0 }}
      transition={{ duration: 0.3, ease: [0.2, 0.6, 0.2, 1] }}
    >
      <Dialog open={isOpen} onOpenChange={setIsOpen}>
        {/* CARD */}
        <div onClick={() => setIsOpen(true)} className="cursor-pointer group">
          <CardContainer
            className={cn(
              "w-full dream-surface relative overflow-hidden",
              "transition-all duration-500 group-hover:scale-[1.01] group-hover:shadow-[0_0_32px_-8px_rgba(180,120,255,0.15)]"
            )}
          >
            <div className="flex items-center justify-between gap-4 min-h-[84px] py-2">
              <div className="flex flex-col justify-center min-w-0 flex-1">
                <p className="text-[11px] text-purple-200/60 uppercase tracking-wider font-medium">
                  {metaCard}
                </p>
                <h3 className="mt-1 text-lg font-display-marcellus text-purple-100 truncate">
                  {dream.title || "Untitled Dream"}
                </h3>
                <p className="mt-1 text-sm text-purple-200/75 leading-relaxed line-clamp-2">
                  {preview}
                </p>
              </div>

              <div className="flex items-center justify-center shrink-0">
                <span
                  className={cn(
                    "glass-pill text-xs px-3 py-1.5 rounded-full",
                    "text-purple-100/90 border border-purple-500/20 bg-purple-500/10"
                  )}
                >
                  {mood.emoji} {mood.label}
                </span>
              </div>
            </div>

            {!!dream.tags?.length && (
              <div className="flex flex-wrap gap-2 pt-3">
                {dream.tags.map((tag, i) => (
                  <span
                    key={i}
                    className="glass-pill text-[11px] px-2.5 py-1 text-purple-200/70 border border-purple-500/10 rounded-full bg-purple-900/20"
                  >
                    {tag}
                  </span>
                ))}
              </div>
            )}
          </CardContainer>
        </div>

        {/* MODAL */}
        <DialogContent
          className={cn(
            "!rounded-2xl overflow-hidden",
            "bg-gradient-to-b from-[#181025] via-[#130f22] to-[#0e0a17]",
            "border border-purple-500/20 shadow-[0_0_64px_-10px_rgba(150,80,255,0.25)]",
            "p-0 max-w-4xl w-[95vw] h-[90vh] flex flex-col"
          )}
        >
          <DialogHeader
            className={cn(
              "sticky top-0 z-10 rounded-t-2xl flex-row items-center justify-between",
              "p-5 border-b border-purple-500/10",
              "bg-[#181025]/80 backdrop-blur-md"
            )}
          >
            <div className="text-left">
              <DialogTitle className="text-2xl font-display-marcellus text-purple-100 tracking-wide">
                {dream.title || "Untitled Dream"}
              </DialogTitle>
              <DialogDescription className="text-[11px] text-purple-300/60">
                {metaHeader}
              </DialogDescription>
            </div>
            <div className="flex items-center gap-1.5">
              <Button variant="ghost" size="icon" className="h-9 w-9 text-purple-300/80 hover:text-purple-100">
                <Pencil className="w-4 h-4" />
              </Button>
              <Button variant="ghost" size="icon" className="h-9 w-9 text-red-400/80 hover:text-red-300">
                <Trash2 className="w-4 h-4" />
              </Button>
              <DialogClose asChild>
                <Button variant="ghost" size="icon" className="h-9 w-9 text-purple-300/70 hover:text-purple-100">
                  <X className="w-4 h-4" />
                </Button>
              </DialogClose>
            </div>
          </DialogHeader>

          <div className="flex-1 overflow-hidden grid grid-cols-1 md:grid-cols-2">
            {/* Left column */}
            <div className="p-6 flex flex-col gap-6 md:overflow-y-auto custom-scrollbar">
              <section>
                <h3 className="flex items-center gap-2 font-display-marcellus text-purple-200/80 mb-3 text-[18px] tracking-wide">
                  <Moon className="w-4 h-4" /> Your Dream
                </h3>
                <p className="text-purple-100/90 whitespace-pre-wrap leading-relaxed text-[13px] font-light">
                  {dream.content}
                </p>
              </section>

              <DreamscapeSeparator />

              <section>
                <h4 className="flex items-center gap-2 font-display-marcellus text-purple-200/80 mb-3 text-[18px] tracking-wide">
                  <Star className="w-4 h-4" /> Key Symbols & Feelings
                </h4>
                <div className="space-y-4">
                  <div>
                    <p className="text-xs text-purple-300/60 mb-2">Primary Mood</p>
                    <span className="inline-flex items-center gap-2 text-2xs px-2 py-1.5 rounded-full border border-purple-500/10 bg-purple-900/30 text-purple-100/90">
                      {mood.emoji} {mood.label}
                    </span>
                  </div>
                  {!!dream.tags?.length && (
                    <div>
                      <p className="text-xs text-purple-300/60 mb-2">Symbols Detected</p>
                      <div className="flex flex-wrap gap-2">
                        {dream.tags.map((tag, i) => (
                          <span key={i} className="inline-flex items-center text-2xs px-2 py-1 rounded-full border border-purple-500/10 bg-purple-900/30 text-purple-100/90">
                            {tag}
                          </span>
                        ))}
                      </div>
                    </div>
                  )}
                </div>
              </section>
              <DreamscapeSeparator className="md:hidden" />
            </div>

            {/* Right column */}
            <div className="p-6 overflow-y-auto custom-scrollbar flex flex-col gap-6 md:border-l md:border-purple-500/10 md:pl-6">
              <section>
                <h3 className="flex items-center gap-2 font-display-marcellus text-purple-200/80 mb-3 text-[18px] tracking-wide">
                  <Zap className="w-4 h-4" /> Interpretation
                </h3>
                <div
                  className={cn(
                    "text-[13px] leading-6 text-purple-100/85 font-light",
                    "[&_p]:mb-3 [&_p:last-child]:mb-0 [&_a]:underline [&_a]:underline-offset-2"
                  )}
                >
                  {dream.interpretation ? (
                    <ReactMarkdown remarkPlugins={[remarkGfm]}>
                      {dream.interpretation}
                    </ReactMarkdown>
                  ) : (
                    <p className="italic opacity-70">No interpretation available yet.</p>
                  )}
                </div>
              </section>

              <DreamscapeSeparator />

              <section>
                <h3 className="flex items-center gap-2 font-display-marcellus text-purple-200/80 mb-3 text-[18px] tracking-wide">
                  <Brain className="w-4 h-4" /> Potential Themes
                </h3>
                <p className="text-[12px] text-purple-300/55 italic">
                  Pattern recognition coming soon.
                </p>
              </section>

              <DreamscapeSeparator />

              <section>
                <h3 className="flex items-center gap-2 font-display-marcellus text-purple-200/80 mb-3 text-[18px] tracking-wide">
                  <LinkIcon className="w-4 h-4" /> Dream Connections
                </h3>
                <p className="text-[12px] text-purple-300/55 italic">
                  Soon you‚Äôll see echoes between your dreams.
                </p>
              </section>
            </div>
          </div>
        </DialogContent>
      </Dialog>
    </motion.div>
  );
}


# =================================================================
# Arquivo: .\components\journal\dream-grid.tsx
# =================================================================

"use client";

import { DreamCard } from './dream-card';
import type { DateRange } from 'react-day-picker';

type Dream = {
  id: string;
  created_at: string;
  title: string | null;
  content: string;
  tags: string[] | null;
  mood: string | null;
  interpretation?: string | null;   // <- add
};

interface DreamGridProps {
  dreams: Dream[];
  searchQuery?: string;
  selectedDateRange?: DateRange;
  selectedTags?: string[];
  sortOrder?: 'newest' | 'oldest';
}

export function DreamGrid({
  dreams,
  searchQuery = '',
  selectedDateRange,
  selectedTags = [],
  sortOrder = 'newest'
}: DreamGridProps) {
  let filteredDreams = dreams;

  // Busca
  if (searchQuery) {
    const query = searchQuery.toLowerCase();
    filteredDreams = filteredDreams.filter(dream =>
      (dream.title && dream.title.toLowerCase().includes(query)) ||
      dream.content.toLowerCase().includes(query) ||
      (dream.tags && dream.tags.some(tag => tag.toLowerCase().includes(query)))
    );
  }

  // Data (range)
  if (selectedDateRange?.from) {
    const from = selectedDateRange.from.getTime();
    const to = (selectedDateRange.to || selectedDateRange.from).getTime() + (24 * 60 * 60 * 1000 - 1);
    filteredDreams = filteredDreams.filter(dream => {
      const dreamDate = new Date(dream.created_at).getTime();
      return dreamDate >= from && dreamDate <= to;
    });
  }

  // Tags
  if (selectedTags.length > 0) {
    filteredDreams = filteredDreams.filter(dream =>
      dream.tags && selectedTags.some(tag => dream.tags!.includes(tag))
    );
  }

  // Ordena√ß√£o
  filteredDreams = [...filteredDreams].sort((a, b) => {
    const dateA = new Date(a.created_at).getTime();
    const dateB = new Date(b.created_at).getTime();
    return sortOrder === 'newest' ? dateB - dateA : dateA - dateB;
  });

  if (filteredDreams.length === 0) {
    return (
      <div className="text-center py-10 text-purple-200/60">
        <p>No dreams match your current filters.</p>
      </div>
    );
  }

  return (
    <div className="space-y-4">
      {filteredDreams.map((dream, index) => (
        <DreamCard
          key={dream.id}
          variant={index % 2 === 0 ? "default" : "alt"}
          dream={{
            id: dream.id,
            title: dream.title || 'Untitled Dream',
            created_at: dream.created_at,
            content: dream.content,
            tags: dream.tags || [],
            mood: dream.mood || 'neutral',
            interpretation: dream.interpretation ?? null, // <- add
          }}
        />
      ))}
    </div>
  );
}

# =================================================================
# Arquivo: .\components\journal\dream-journal.tsx
# =================================================================

// ARQUIVO FINAL E CORRIGIDO (MUDAN√áA M√çNIMA): components/journal/dream-journal.tsx

"use client";

import { useState, useEffect } from 'react';
import { Search, Calendar, Tags, SortDesc } from 'lucide-react';
import { Input } from '@/components/ui/input';
import { Button } from '@/components/ui/button';
import { DreamGrid } from './dream-grid';
import { motion } from 'framer-motion';
import {
  DropdownMenu,
  DropdownMenuContent,
  DropdownMenuItem,
  DropdownMenuTrigger,
} from '@/components/ui/dropdown-menu';
import { DateRangePicker } from '@/components/ui/date-range-picker';
import { TagSelector } from './tag-selector';
import type { DateRange } from 'react-day-picker';
import type { SelectRangeEventHandler } from 'react-day-picker';
import { EmptyState } from '@/components/dashboard/empty-state';
import { useDreamStore } from '@/hooks/use-dream-store';
import { useAuth } from '@/components/auth/auth-provider';

const MOCK_AVAILABLE_TAGS = ['flying', 'nature', 'wisdom', 'water', 'light', 'mystery', 'crystals', 'memories', 'exploration'];

export function DreamJournal() {
  const { user } = useAuth();
  const { dreams, isLoading, fetchDreams } = useDreamStore();

  const [searchQuery, setSearchQuery] = useState('');
  const [selectedDateRange, setSelectedDateRange] = useState<DateRange | undefined>(undefined);
  const [selectedTags, setSelectedTags] = useState<string[]>([]);
  const [sortOrder, setSortOrder] = useState<'newest' | 'oldest'>('newest');

  useEffect(() => {
    // FIX: Adicionado 'user' √† lista de depend√™ncias para re-fetch ao logar/deslogar.
    if (user) {
      fetchDreams();
    }
  }, [fetchDreams, user]);

  const handleDateRangeSelect: SelectRangeEventHandler = (range) => {
    setSelectedDateRange(range);
  };
  const handleTagSelect = (tag: string) => {
    setSelectedTags(prev => prev.includes(tag) ? prev.filter(t => t !== tag) : [...prev, tag]);
  };

  if (isLoading) {
    return <div className="text-center p-10 text-purple-200/50">Loading your journal...</div>;
  }
  
  if (!isLoading && dreams.length === 0) {
    return <EmptyState />;
  }

  return (
    <div className="space-y-8 relative z-10">
      <motion.div
        initial={{ opacity: 0, y: -20 }}
        animate={{ opacity: 1, y: 0 }}
        transition={{ duration: 0.8 }}
        className="flex flex-col items-center space-y-3"
      >
        <h1 className="text-[28px] sm:text-[44px] font-display-cormorant text-purple-100 text-center">
          The home for your dreams.
        </h1>
        <p className="text-xs sm:text-sm text-purple-200/75 font-extralight text-center">Keep every dream safe, searchable, and yours.</p>
      </motion.div>

      <motion.div
        initial={{ opacity: 0, y: -6 }}
        animate={{ opacity: 1, y: 0 }}
        transition={{ duration: 0.28, ease: [0.2, 0.6, 0.2, 1] }}
        className="flex flex-col sm:flex-row items-center gap-3"
      >
        {/* SEARCH PILL - MUDAN√áA AQUI */}
        <div className="flex items-center w-full sm:flex-1 px-4 h-11 rounded-full search-pill-bordered">
          <Search className="w-4 h-4 text-purple-300/80" />
          <input
            type="text"
            placeholder="Search in title, content, or tags..."
            className="input-reset ml-3 text-xs text-purple-100 placeholder:text-purple-200/50 w-full"
            value={searchQuery}
            onChange={(e) => setSearchQuery(e.target.value)}
          />
        </div>

        {/* BUTTONS - MUDAN√áA AQUI */}
        <div className="flex flex-wrap justify-center sm:justify-start items-center gap-2 w-full sm:w-auto">
          <DropdownMenu>
            <DropdownMenuTrigger asChild>
              <button className={`pill-btn-bordered flex items-center gap-2 text-2xs text-purple-200/80 ${selectedDateRange ? 'active-filter' : ''}`}>
                <Calendar className="w-3 h-3" />
                Date
              </button>
            </DropdownMenuTrigger>
            <DropdownMenuContent className="bg-black/90 border-purple-500/20 p-4 w-auto max-w-[90vw]">
              <DateRangePicker selectedRange={selectedDateRange} onRangeSelect={handleDateRangeSelect} />
            </DropdownMenuContent>
          </DropdownMenu>

          <DropdownMenu>
            <DropdownMenuTrigger asChild>
              <button className={`pill-btn-bordered flex items-center gap-2 text-2xs text-purple-200/80 ${selectedTags.length > 0 ? 'active-filter' : ''}`}>
                <Tags className="w-3 h-3" />
                Tags {selectedTags.length > 0 && `(${selectedTags.length})`}
              </button>
            </DropdownMenuTrigger>
            <DropdownMenuContent className="bg-black/90 border-purple-500/20 w-auto max-w-[90vw]" onCloseAutoFocus={(e) => e.preventDefault()}>
              <TagSelector
                availableTags={MOCK_AVAILABLE_TAGS}
                selectedTags={selectedTags}
                onTagSelect={handleTagSelect}
                onSelectAll={() => setSelectedTags(MOCK_AVAILABLE_TAGS)}
                onClear={() => setSelectedTags([])}
              />
            </DropdownMenuContent>
          </DropdownMenu>

          <DropdownMenu>
            <DropdownMenuTrigger asChild>
              <button className={`pill-btn-bordered flex items-center gap-2 text-2xs text-purple-200/80 ${sortOrder !== 'newest' ? 'active-filter' : ''}`}>
                <SortDesc className="w-3 h-3" />
                Sort
              </button>
            </DropdownMenuTrigger>
            <DropdownMenuContent className="bg-black/90 border-purple-500/20">
              <DropdownMenuItem onClick={() => setSortOrder('newest')} className="text-xs">Newest First</DropdownMenuItem>
              <DropdownMenuItem onClick={() => setSortOrder('oldest')} className="text-xs">Oldest First</DropdownMenuItem>
            </DropdownMenuContent>
          </DropdownMenu>
          
          {(searchQuery || selectedDateRange || selectedTags.length > 0) && (
            <button
              className="pill-btn-bordered flex items-center gap-2 text-2xs text-purple-200/80"
              onClick={() => {
                setSearchQuery('');
                setSelectedDateRange(undefined);
                setSelectedTags([]);
                setSortOrder('newest');
              }}
            >
              Clear All
            </button>
          )}
        </div>
      </motion.div>

      <motion.div
        initial={{ opacity: 0, y: 20 }}
        animate={{ opacity: 1, y: 0 }}
        transition={{ duration: 0.8, delay: 0.3 }}
      >
        <DreamGrid
          dreams={dreams}
          searchQuery={searchQuery}
          selectedDateRange={selectedDateRange}
          selectedTags={selectedTags}
          sortOrder={sortOrder}
        />
      </motion.div>
    </div>
  );
}

# =================================================================
# Arquivo: .\components\journal\tag-selector.tsx
# =================================================================

"use client";

import { Check, X } from 'lucide-react';
import { Button } from '@/components/ui/button';

interface TagSelectorProps {
  availableTags: string[];
  selectedTags: string[];
  onTagSelect: (tag: string) => void;
  onSelectAll: () => void;
  onClear: () => void;
}

export function TagSelector({
  availableTags,
  selectedTags,
  onTagSelect,
  onSelectAll,
  onClear
}: TagSelectorProps) {
  return (
    <div className="p-2 space-y-2" onClick={(e) => e.stopPropagation()}>
      <div className="flex items-center justify-between gap-2">
        <Button
          variant="ghost"
          size="sm"
          onClick={onSelectAll}
          className="text-xs h-7 px-2"
        >
          <Check className="w-3 h-3 mr-1" />
          Select All
        </Button>
        <Button
          variant="ghost"
          size="sm"
          onClick={onClear}
          className="text-xs h-7 px-2"
        >
          <X className="w-3 h-3 mr-1" />
          Clear
        </Button>
      </div>
      
      <div className="space-y-1 max-h-[200px] overflow-y-auto custom-scrollbar">
        {availableTags.map(tag => (
          <div
            key={tag}
            onClick={() => onTagSelect(tag)}
            className="flex items-center gap-2 px-2 py-1.5 hover:bg-purple-500/20 rounded-sm cursor-pointer"
          >
            <div className={`w-2 h-2 rounded-full ${
              selectedTags.includes(tag) ? 'bg-purple-500' : 'bg-purple-500/20'
            }`} />
            <span className="capitalize text-xs text-purple-200/80">{tag}</span>
          </div>
        ))}
      </div>
    </div>
  );
}

# =================================================================
# Arquivo: .\components\layouts\dashboard-layout.tsx
# =================================================================

"use client";

import { useAuth } from '@/components/auth/auth-provider';
import { DashboardNav } from './dashboard-nav';
import { StarField } from '@/components/star-field';

export function DashboardLayout({ children }: { children: React.ReactNode; }) {
  const { user } = useAuth();
  if (!user) return null;

  return (
    <div className="min-h-screen bg-[#030014] relative">
      {/* Fundo estelar (camada de tr√°s) */}
      <div className="fixed inset-0 z-0 pointer-events-none">
        <StarField />
      </div>

      {/* Textura sutil (sobre as estrelas) */}
      <div className="noise-layer" />

      {/* Conte√∫do (acima de tudo) */}
      <div className="relative z-20 flex flex-col h-screen">
        <DashboardNav />
        <main className="flex-1 overflow-y-auto custom-scrollbar">
          <div className="max-w-5xl mx-auto px-4 sm:px-6 lg:px-8 py-6 sm:py-8 lg:py-10">
            {children}
          </div>
        </main>
      </div>
    </div>
  );
}

# =================================================================
# Arquivo: .\components\layouts\dashboard-nav.tsx
# =================================================================

// ARQUIVO ATUALIZADO: components/layouts/dashboard-nav.tsx

"use client";

import { ProfileMenu } from '@/components/profile-menu';
import { Menu } from 'lucide-react';
import { Button } from '@/components/ui/button';
import Link from 'next/link';
import { usePathname } from 'next/navigation';
import { cn } from '@/lib/utils';
import { HeaderLogo } from '@/components/brand/header-logo';
import { motion } from 'framer-motion';
import { Sheet, SheetContent, SheetTrigger } from '@/components/ui/sheet';

export function DashboardNav() {
  const pathname = usePathname();

  const navLinks = [
    { name: 'Dream Journal', href: '/dashboard' },
    { name: 'Decoder', href: '/dashboard/decoder', soon: true },
    { name: 'Blooming Path', href: '/dashboard/path', soon: true },
  ];

  return (
    <header className="sticky top-0 z-50 border-b border-white/5 bg-gradient-to-b from-purple-950/40 to-black/80 backdrop-blur-sm">
      {/* Container principal agora usa Grid no mobile e Flex no desktop */}
      <div className="px-4 sm:px-6 h-14 sm:h-16 mx-auto grid grid-cols-3 items-center md:flex md:justify-between">
        
        {/* --- Se√ß√£o Esquerda (Logo e Nav Desktop / Menu Mobile) --- */}
        <div className="justify-self-start flex items-center gap-8">
          {/* Menu Mobile */}
          <div className="md:hidden">
            <Sheet>
              <SheetTrigger asChild>
                <Button variant="ghost" size="icon" className="-ml-2">
                  <Menu className="h-6 w-6 text-purple-200" />
                </Button>
              </SheetTrigger>
              <SheetContent side="left" className="bg-[#030014] border-r-white/10 p-0 w-[280px]">
                <div className="p-4 border-b border-white/10">
                    <HeaderLogo />
                </div>
                <nav className="flex flex-col gap-2 p-4">
                    {navLinks.map((link) => (
                      <Link 
                        key={link.name} 
                        href={link.href} 
                        className={cn(
                          "text-base p-3 rounded-md transition-colors",
                          link.soon ? "text-purple-200/40 cursor-not-allowed" :
                          pathname === link.href ? "text-purple-100 bg-purple-500/10" :
                          "text-purple-200/70 hover:bg-purple-500/10"
                        )} 
                        onClick={(e) => { if (link.soon) e.preventDefault(); }}
                      >
                        {link.name}
                        {link.soon && <span className="ml-2 text-[10px] bg-purple-500/15 px-1.5 py-0.5 rounded-full text-purple-300/60">soon</span>}
                      </Link>
                    ))}
                </nav>
              </SheetContent>
            </Sheet>
          </div>
          
          {/* Logo e Nav Desktop */}
          <div className="hidden md:flex items-center gap-16">
            <HeaderLogo />
            <nav className="flex items-center gap-8">
              {navLinks.map((link) => (
                <Link 
                  key={link.name} 
                  href={link.href} 
                  className={cn(
                    "font-light transition-colors relative py-2 text-sm whitespace-nowrap",
                    link.soon 
                      ? "text-purple-200/40 cursor-not-allowed" 
                      : pathname === link.href 
                        ? "text-purple-100" 
                        : "text-purple-200/75 hover:text-purple-200/95"
                  )} 
                  onClick={(e) => { if (link.soon) e.preventDefault(); }}
                >
                  {link.name}
                  {link.soon && (
                    <span className="ml-2 text-[10px] bg-purple-500/15 px-2 py-0.5 rounded-full text-purple-300/60">soon</span>
                  )}
                  {pathname === link.href && !link.soon && (
                    <span
                      className="absolute -bottom-1 left-1/2 -translate-x-1/2 h-1.5 w-1.5 rounded-full bg-purple-300/80"
                    />
                  )}
                </Link>
              ))}
            </nav>
          </div>
        </div>

        {/* --- Se√ß√£o Central (Apenas para o Logo no Mobile) --- */}
        <div className="justify-self-center md:hidden">
          <HeaderLogo />
        </div>

        {/* --- Se√ß√£o Direita (√çcone de Perfil) --- */}
        <div className="justify-self-end">
          <ProfileMenu />
        </div>
      </div>
    </header>
  );
}


# =================================================================
# Arquivo: .\components\layouts\dashboard-sidebar.tsx
# =================================================================

"use client";

import { 
  Home,
  BookOpen,
  Brain,
  Trophy,
  Palette,
  TestTube,
  Network,
  Compass,
  User,
  Sparkles,
  X,
  Moon
} from 'lucide-react';
import Link from 'next/link';
import { usePathname } from 'next/navigation';
import { cn } from '@/lib/utils';
import { Button } from '@/components/ui/button';
import { useEffect } from 'react';

interface DashboardSidebarProps {
  open: boolean;
  onClose: () => void;
}

export function DashboardSidebar({ open, onClose }: DashboardSidebarProps) {
  const pathname = usePathname();

  useEffect(() => {
    if (open) {
      document.body.style.overflow = 'hidden';
    } else {
      document.body.style.overflow = 'unset';
    }
    return () => {
      document.body.style.overflow = 'unset';
    };
  }, [open]);

  const navigationItems = [
    { name: 'Home', icon: Home, href: '/dashboard' },
    { name: 'Dream Journal', icon: BookOpen, href: '/dashboard/journal' },
    { name: 'Dream Decoder', icon: Brain, href: '/dashboard/decoder' },
    { name: 'Blooming Path', icon: Trophy, href: '/dashboard/path' },
    { type: 'divider', label: 'Coming Soon' },
    { name: 'Your Dreams on Canvas', icon: Palette, href: '/dashboard/canvas', soon: true },
    { name: 'Dream Lab', icon: TestTube, href: '/dashboard/lab', soon: true },
    { name: 'Collective Consciousness', icon: Network, href: '/dashboard/collective', soon: true },
    { name: 'Your Guide, Your Way', icon: Compass, href: '/dashboard/guide', soon: true },
    { type: 'divider', label: 'Personal' },
    { name: 'Bloom Space', icon: User, href: '/dashboard/space' }
  ];

  return (
    <>
      {open && (
        <div 
          className="mobile-menu-overlay"
          onClick={onClose}
        />
      )}

      <aside className={cn(
        "fixed lg:fixed left-0 top-0 lg:top-16 bottom-0 w-[280px] lg:w-64 bg-black/40 backdrop-blur-sm border-r border-white/5 z-50 transition-transform duration-300 ease-in-out flex flex-col",
        open ? "translate-x-0" : "-translate-x-full lg:translate-x-0"
      )}>
        <div className="flex items-center justify-between p-3 lg:hidden border-b border-white/5">
          <div className="flex items-center gap-2">
            <Moon className="w-5 h-5 text-purple-300" />
            <span className="font-display text-base sm:text-lg text-white/90">BLOOMED DREAMS</span>
          </div>
          <Button
            variant="ghost"
            size="icon"
            onClick={onClose}
            className="text-purple-300 hover:text-purple-200"
          >
            <X className="w-5 h-5" />
          </Button>
        </div>

        <div className="flex-1 p-4 overflow-y-auto mobile-scroll">
          <nav className="space-y-1.5">
            {navigationItems.map((item, index) => (
              'type' in item ? (
                <div key={index} className="mt-5 mb-2">
                  <div className="border-t border-purple-400/25 pt-4 pb-2">
                    <p className="text-xs font-display tracking-wider text-purple-300/60 uppercase px-4">
                      {item.label}
                    </p>
                  </div>
                </div>
              ) : (
                <Link
                  key={index}
                  href={item.href}
                  onClick={onClose}
                  className={cn(
                    "w-full flex items-center gap-3 px-4 py-2 rounded-lg text-[13px] group relative transition-all duration-300 font-display tracking-wide font-light border border-transparent",
                    pathname === item.href
                      ? "bg-purple-500/20 text-purple-200 border-purple-400/10 shadow-[0_0_10px_rgba(168,85,247,0.15)]"
                      : item.soon
                        ? "text-white/30 hover:text-white/50 hover:bg-purple-900/10"                      
                        : "text-white/60 hover:text-white/80 hover:bg-purple-900/25"
                  )}
                >
                   {item.icon && <item.icon className={cn(
                    "w-4 h-4 transition-transform group-hover:scale-125 duration-500 ease-out flex-shrink-0",
                    item.soon ? "text-purple-400/40" : ""
                  )} />}
                  <span>{item.name}</span>
                  {item.soon && (
                    <span className="ml-auto text-[10px] bg-purple-500/15 px-2 py-0.5 rounded-full text-purple-300/90 font-display tracking-wider">
                      soon
                    </span>
                  )}
                  {pathname === item.href && (
                    <Sparkles className="absolute right-2 top-1/2 -translate-y-1/2 w-4 h-4 text-purple-400/40" />
                  )}
                </Link>
              )
            ))}
          </nav>
        </div>
      </aside>
    </>
  );
}

# =================================================================
# Arquivo: .\components\layouts\home-header.tsx
# =================================================================

// Em: components/layouts/home-header.tsx
"use client";

import Link from 'next/link';
import { motion } from 'framer-motion';
import { Button } from '@/components/ui/button';
import { Logo } from '@/components/brand/logo';
import { useAuth } from '@/components/auth/auth-provider'; // Importe o hook de autentica√ß√£o
import { ArrowRight } from 'lucide-react';

export function HomeHeader() {
  const { user, loading } = useAuth();

  // N√£o renderiza nada enquanto carrega o estado de autentica√ß√£o para evitar piscar a UI
  if (loading) {
    return <div className="h-[72px]" />; // Um placeholder de altura para evitar pulos de layout
  }

  return (
    <motion.header
      initial={{ y: -100, opacity: 0 }}
      animate={{ y: 0, opacity: 1 }}
      transition={{ duration: 0.5, ease: 'easeOut' }}
      className="absolute top-0 left-0 right-0 z-50"
    >
      <div className="container mx-auto flex items-center justify-between p-4 sm:p-6">
        {/* Usamos a variante 'small' da logo, que √© mais apropriada para um header */}
        <Logo variant="small" />

        <nav>
          {user ? (
            // Se o usu√°rio estiver logado
            <Link href="/dashboard">
              <Button 
                className="bg-purple-500/10 border border-purple-500/20 text-purple-200 hover:bg-purple-500/20"
                variant="outline"
              >
                Go to Dashboard
                <ArrowRight className="w-4 h-4 ml-2" />
              </Button>
            </Link>
          ) : (
            // Se o usu√°rio N√ÉO estiver logado
            <div className="flex items-center gap-2 sm:gap-4">
              <Link href="/login">
                <Button variant="ghost" className="text-purple-200/80 hover:text-purple-100 text-xs sm:text-sm">
                  Login
                </Button>
              </Link>
              <Link href="/signup">
                <Button 
                  className="bg-purple-500/10 border border-purple-500/20 text-purple-200 hover:bg-purple-500/20 text-xs sm:text-sm"
                  variant="outline"
                  size="sm"
                >
                  Sign Up
                </Button>
              </Link>
            </div>
          )}
        </nav>
      </div>
    </motion.header>
  );
}

# =================================================================
# Arquivo: .\components\layouts\mobile-sidebar.tsx
# =================================================================

// ARQUIVO NOVO: components/layouts/mobile-sidebar.tsx

"use client";

import Link from 'next/link';
import { usePathname } from 'next/navigation';
import { cn } from '@/lib/utils';
import { Sheet, SheetContent, SheetTrigger } from '@/components/ui/sheet';
import { Button } from '@/components/ui/button';
import { Menu, Moon } from 'lucide-react';
import { motion } from 'framer-motion';

const navLinks = [
  { name: 'Journal', href: '/dashboard' },
  { name: 'Decoder', href: '/dashboard/decoder', soon: true },
  { name: 'Blooming Path', href: '/dashboard/path', soon: true },
];

export function MobileSidebar() {
  const pathname = usePathname();
  
  return (
    // Escondido em telas 'md' e maiores
    <div className="md:hidden">
      <Sheet>
        <SheetTrigger asChild>
          <Button variant="ghost" size="icon">
            <Menu className="h-6 w-6 text-purple-200" />
          </Button>
        </SheetTrigger>
        <SheetContent side="left" className="bg-[#030014] border-r-white/10 p-0">
          <div className="p-6 border-b border-white/10">
            <Link href="/dashboard" className="flex items-center gap-2">
              <Moon className="w-5 h-5 text-purple-300" />
              <span className="font-display-marcellus text-lg text-white">BLOOMED DREAMS</span>
            </Link>
          </div>
          <nav className="flex flex-col gap-2 p-4">
            {navLinks.map((link) => (
              <Link
                key={link.name}
                href={link.href}
                className={cn(
                  "text-base p-3 rounded-md transition-colors relative",
                  link.soon
                    ? "text-purple-200/40 cursor-not-allowed"
                    : pathname === link.href
                      ? "text-purple-100 bg-purple-500/10"
                      : "text-purple-200/70 hover:bg-purple-500/10"
                )}
                onClick={(e) => { if (link.soon) e.preventDefault(); }}
              >
                {link.name}
                {link.soon && <span className="ml-2 text-[10px] bg-purple-500/15 px-1.5 py-0.5 rounded-full text-purple-300/60">soon</span>}
              </Link>
            ))}
          </nav>
        </SheetContent>
      </Sheet>
    </div>
  );
}

# =================================================================
# Arquivo: .\components\ui\accordion.tsx
# =================================================================

'use client';

import * as React from 'react';
import * as AccordionPrimitive from '@radix-ui/react-accordion';
import { ChevronDown } from 'lucide-react';

import { cn } from '@/lib/utils';

const Accordion = AccordionPrimitive.Root;

const AccordionItem = React.forwardRef<
  React.ElementRef<typeof AccordionPrimitive.Item>,
  React.ComponentPropsWithoutRef<typeof AccordionPrimitive.Item>
>(({ className, ...props }, ref) => (
  <AccordionPrimitive.Item
    ref={ref}
    className={cn('border-b', className)}
    {...props}
  />
));
AccordionItem.displayName = 'AccordionItem';

const AccordionTrigger = React.forwardRef<
  React.ElementRef<typeof AccordionPrimitive.Trigger>,
  React.ComponentPropsWithoutRef<typeof AccordionPrimitive.Trigger>
>(({ className, children, ...props }, ref) => (
  <AccordionPrimitive.Header className="flex">
    <AccordionPrimitive.Trigger
      ref={ref}
      className={cn(
        'flex flex-1 items-center justify-between py-4 font-medium transition-all hover:underline [&[data-state=open]>svg]:rotate-180',
        className
      )}
      {...props}
    >
      {children}
      <ChevronDown className="h-4 w-4 shrink-0 transition-transform duration-200" />
    </AccordionPrimitive.Trigger>
  </AccordionPrimitive.Header>
));
AccordionTrigger.displayName = AccordionPrimitive.Trigger.displayName;

const AccordionContent = React.forwardRef<
  React.ElementRef<typeof AccordionPrimitive.Content>,
  React.ComponentPropsWithoutRef<typeof AccordionPrimitive.Content>
>(({ className, children, ...props }, ref) => (
  <AccordionPrimitive.Content
    ref={ref}
    className="overflow-hidden text-sm transition-all data-[state=closed]:animate-accordion-up data-[state=open]:animate-accordion-down"
    {...props}
  >
    <div className={cn('pb-4 pt-0', className)}>{children}</div>
  </AccordionPrimitive.Content>
));

AccordionContent.displayName = AccordionPrimitive.Content.displayName;

export { Accordion, AccordionItem, AccordionTrigger, AccordionContent };


# =================================================================
# Arquivo: .\components\ui\alert-dialog.tsx
# =================================================================

'use client';

import * as React from 'react';
import * as AlertDialogPrimitive from '@radix-ui/react-alert-dialog';

import { cn } from '@/lib/utils';
import { buttonVariants } from '@/components/ui/button';

const AlertDialog = AlertDialogPrimitive.Root;

const AlertDialogTrigger = AlertDialogPrimitive.Trigger;

const AlertDialogPortal = AlertDialogPrimitive.Portal;

const AlertDialogOverlay = React.forwardRef<
  React.ElementRef<typeof AlertDialogPrimitive.Overlay>,
  React.ComponentPropsWithoutRef<typeof AlertDialogPrimitive.Overlay>
>(({ className, ...props }, ref) => (
  <AlertDialogPrimitive.Overlay
    className={cn(
      'fixed inset-0 z-50 bg-black/80  data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0',
      className
    )}
    {...props}
    ref={ref}
  />
));
AlertDialogOverlay.displayName = AlertDialogPrimitive.Overlay.displayName;

const AlertDialogContent = React.forwardRef<
  React.ElementRef<typeof AlertDialogPrimitive.Content>,
  React.ComponentPropsWithoutRef<typeof AlertDialogPrimitive.Content>
>(({ className, ...props }, ref) => (
  <AlertDialogPortal>
    <AlertDialogOverlay />
    <AlertDialogPrimitive.Content
      ref={ref}
      className={cn(
        'fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg',
        className
      )}
      {...props}
    />
  </AlertDialogPortal>
));
AlertDialogContent.displayName = AlertDialogPrimitive.Content.displayName;

const AlertDialogHeader = ({
  className,
  ...props
}: React.HTMLAttributes<HTMLDivElement>) => (
  <div
    className={cn(
      'flex flex-col space-y-2 text-center sm:text-left',
      className
    )}
    {...props}
  />
);
AlertDialogHeader.displayName = 'AlertDialogHeader';

const AlertDialogFooter = ({
  className,
  ...props
}: React.HTMLAttributes<HTMLDivElement>) => (
  <div
    className={cn(
      'flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2',
      className
    )}
    {...props}
  />
);
AlertDialogFooter.displayName = 'AlertDialogFooter';

const AlertDialogTitle = React.forwardRef<
  React.ElementRef<typeof AlertDialogPrimitive.Title>,
  React.ComponentPropsWithoutRef<typeof AlertDialogPrimitive.Title>
>(({ className, ...props }, ref) => (
  <AlertDialogPrimitive.Title
    ref={ref}
    className={cn('text-lg font-semibold', className)}
    {...props}
  />
));
AlertDialogTitle.displayName = AlertDialogPrimitive.Title.displayName;

const AlertDialogDescription = React.forwardRef<
  React.ElementRef<typeof AlertDialogPrimitive.Description>,
  React.ComponentPropsWithoutRef<typeof AlertDialogPrimitive.Description>
>(({ className, ...props }, ref) => (
  <AlertDialogPrimitive.Description
    ref={ref}
    className={cn('text-sm text-muted-foreground', className)}
    {...props}
  />
));
AlertDialogDescription.displayName =
  AlertDialogPrimitive.Description.displayName;

const AlertDialogAction = React.forwardRef<
  React.ElementRef<typeof AlertDialogPrimitive.Action>,
  React.ComponentPropsWithoutRef<typeof AlertDialogPrimitive.Action>
>(({ className, ...props }, ref) => (
  <AlertDialogPrimitive.Action
    ref={ref}
    className={cn(buttonVariants(), className)}
    {...props}
  />
));
AlertDialogAction.displayName = AlertDialogPrimitive.Action.displayName;

const AlertDialogCancel = React.forwardRef<
  React.ElementRef<typeof AlertDialogPrimitive.Cancel>,
  React.ComponentPropsWithoutRef<typeof AlertDialogPrimitive.Cancel>
>(({ className, ...props }, ref) => (
  <AlertDialogPrimitive.Cancel
    ref={ref}
    className={cn(
      buttonVariants({ variant: 'outline' }),
      'mt-2 sm:mt-0',
      className
    )}
    {...props}
  />
));
AlertDialogCancel.displayName = AlertDialogPrimitive.Cancel.displayName;

export {
  AlertDialog,
  AlertDialogPortal,
  AlertDialogOverlay,
  AlertDialogTrigger,
  AlertDialogContent,
  AlertDialogHeader,
  AlertDialogFooter,
  AlertDialogTitle,
  AlertDialogDescription,
  AlertDialogAction,
  AlertDialogCancel,
};


# =================================================================
# Arquivo: .\components\ui\alert.tsx
# =================================================================

import * as React from 'react';
import { cva, type VariantProps } from 'class-variance-authority';

import { cn } from '@/lib/utils';

const alertVariants = cva(
  'relative w-full rounded-lg border p-4 [&>svg~*]:pl-7 [&>svg+div]:translate-y-[-3px] [&>svg]:absolute [&>svg]:left-4 [&>svg]:top-4 [&>svg]:text-foreground',
  {
    variants: {
      variant: {
        default: 'bg-background text-foreground',
        destructive:
          'border-destructive/50 text-destructive dark:border-destructive [&>svg]:text-destructive',
      },
    },
    defaultVariants: {
      variant: 'default',
    },
  }
);

const Alert = React.forwardRef<
  HTMLDivElement,
  React.HTMLAttributes<HTMLDivElement> & VariantProps<typeof alertVariants>
>(({ className, variant, ...props }, ref) => (
  <div
    ref={ref}
    role="alert"
    className={cn(alertVariants({ variant }), className)}
    {...props}
  />
));
Alert.displayName = 'Alert';

const AlertTitle = React.forwardRef<
  HTMLParagraphElement,
  React.HTMLAttributes<HTMLHeadingElement>
>(({ className, ...props }, ref) => (
  <h5
    ref={ref}
    className={cn('mb-1 font-medium leading-none tracking-tight', className)}
    {...props}
  />
));
AlertTitle.displayName = 'AlertTitle';

const AlertDescription = React.forwardRef<
  HTMLParagraphElement,
  React.HTMLAttributes<HTMLParagraphElement>
>(({ className, ...props }, ref) => (
  <div
    ref={ref}
    className={cn('text-sm [&_p]:leading-relaxed', className)}
    {...props}
  />
));
AlertDescription.displayName = 'AlertDescription';

export { Alert, AlertTitle, AlertDescription };


# =================================================================
# Arquivo: .\components\ui\aspect-ratio.tsx
# =================================================================

'use client';

import * as AspectRatioPrimitive from '@radix-ui/react-aspect-ratio';

const AspectRatio = AspectRatioPrimitive.Root;

export { AspectRatio };


# =================================================================
# Arquivo: .\components\ui\avatar.tsx
# =================================================================

'use client';

import * as React from 'react';
import * as AvatarPrimitive from '@radix-ui/react-avatar';

import { cn } from '@/lib/utils';

const Avatar = React.forwardRef<
  React.ElementRef<typeof AvatarPrimitive.Root>,
  React.ComponentPropsWithoutRef<typeof AvatarPrimitive.Root>
>(({ className, ...props }, ref) => (
  <AvatarPrimitive.Root
    ref={ref}
    className={cn(
      'relative flex h-10 w-10 shrink-0 overflow-hidden rounded-full',
      className
    )}
    {...props}
  />
));
Avatar.displayName = AvatarPrimitive.Root.displayName;

const AvatarImage = React.forwardRef<
  React.ElementRef<typeof AvatarPrimitive.Image>,
  React.ComponentPropsWithoutRef<typeof AvatarPrimitive.Image>
>(({ className, ...props }, ref) => (
  <AvatarPrimitive.Image
    ref={ref}
    className={cn('aspect-square h-full w-full', className)}
    {...props}
  />
));
AvatarImage.displayName = AvatarPrimitive.Image.displayName;

const AvatarFallback = React.forwardRef<
  React.ElementRef<typeof AvatarPrimitive.Fallback>,
  React.ComponentPropsWithoutRef<typeof AvatarPrimitive.Fallback>
>(({ className, ...props }, ref) => (
  <AvatarPrimitive.Fallback
    ref={ref}
    className={cn(
      'flex h-full w-full items-center justify-center rounded-full bg-muted',
      className
    )}
    {...props}
  />
));
AvatarFallback.displayName = AvatarPrimitive.Fallback.displayName;

export { Avatar, AvatarImage, AvatarFallback };


# =================================================================
# Arquivo: .\components\ui\badge.tsx
# =================================================================

import * as React from 'react';
import { cva, type VariantProps } from 'class-variance-authority';

import { cn } from '@/lib/utils';

const badgeVariants = cva(
  'inline-flex items-center rounded-full border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2',
  {
    variants: {
      variant: {
        default:
          'border-transparent bg-primary text-primary-foreground hover:bg-primary/80',
        secondary:
          'border-transparent bg-secondary text-secondary-foreground hover:bg-secondary/80',
        destructive:
          'border-transparent bg-destructive text-destructive-foreground hover:bg-destructive/80',
        outline: 'text-foreground',
      },
    },
    defaultVariants: {
      variant: 'default',
    },
  }
);

export interface BadgeProps
  extends React.HTMLAttributes<HTMLDivElement>,
    VariantProps<typeof badgeVariants> {}

function Badge({ className, variant, ...props }: BadgeProps) {
  return (
    <div className={cn(badgeVariants({ variant }), className)} {...props} />
  );
}

export { Badge, badgeVariants };


# =================================================================
# Arquivo: .\components\ui\breadcrumb.tsx
# =================================================================

import * as React from 'react';
import { Slot } from '@radix-ui/react-slot';
import { ChevronRight, MoreHorizontal } from 'lucide-react';

import { cn } from '@/lib/utils';

const Breadcrumb = React.forwardRef<
  HTMLElement,
  React.ComponentPropsWithoutRef<'nav'> & {
    separator?: React.ReactNode;
  }
>(({ ...props }, ref) => <nav ref={ref} aria-label="breadcrumb" {...props} />);
Breadcrumb.displayName = 'Breadcrumb';

const BreadcrumbList = React.forwardRef<
  HTMLOListElement,
  React.ComponentPropsWithoutRef<'ol'>
>(({ className, ...props }, ref) => (
  <ol
    ref={ref}
    className={cn(
      'flex flex-wrap items-center gap-1.5 break-words text-sm text-muted-foreground sm:gap-2.5',
      className
    )}
    {...props}
  />
));
BreadcrumbList.displayName = 'BreadcrumbList';

const BreadcrumbItem = React.forwardRef<
  HTMLLIElement,
  React.ComponentPropsWithoutRef<'li'>
>(({ className, ...props }, ref) => (
  <li
    ref={ref}
    className={cn('inline-flex items-center gap-1.5', className)}
    {...props}
  />
));
BreadcrumbItem.displayName = 'BreadcrumbItem';

const BreadcrumbLink = React.forwardRef<
  HTMLAnchorElement,
  React.ComponentPropsWithoutRef<'a'> & {
    asChild?: boolean;
  }
>(({ asChild, className, ...props }, ref) => {
  const Comp = asChild ? Slot : 'a';

  return (
    <Comp
      ref={ref}
      className={cn('transition-colors hover:text-foreground', className)}
      {...props}
    />
  );
});
BreadcrumbLink.displayName = 'BreadcrumbLink';

const BreadcrumbPage = React.forwardRef<
  HTMLSpanElement,
  React.ComponentPropsWithoutRef<'span'>
>(({ className, ...props }, ref) => (
  <span
    ref={ref}
    role="link"
    aria-disabled="true"
    aria-current="page"
    className={cn('font-normal text-foreground', className)}
    {...props}
  />
));
BreadcrumbPage.displayName = 'BreadcrumbPage';

const BreadcrumbSeparator = ({
  children,
  className,
  ...props
}: React.ComponentProps<'li'>) => (
  <li
    role="presentation"
    aria-hidden="true"
    className={cn('[&>svg]:size-3.5', className)}
    {...props}
  >
    {children ?? <ChevronRight />}
  </li>
);
BreadcrumbSeparator.displayName = 'BreadcrumbSeparator';

const BreadcrumbEllipsis = ({
  className,
  ...props
}: React.ComponentProps<'span'>) => (
  <span
    role="presentation"
    aria-hidden="true"
    className={cn('flex h-9 w-9 items-center justify-center', className)}
    {...props}
  >
    <MoreHorizontal className="h-4 w-4" />
    <span className="sr-only">More</span>
  </span>
);
BreadcrumbEllipsis.displayName = 'BreadcrumbElipssis';

export {
  Breadcrumb,
  BreadcrumbList,
  BreadcrumbItem,
  BreadcrumbLink,
  BreadcrumbPage,
  BreadcrumbSeparator,
  BreadcrumbEllipsis,
};


# =================================================================
# Arquivo: .\components\ui\button.tsx
# =================================================================

import * as React from 'react';
import { Slot } from '@radix-ui/react-slot';
import { cva, type VariantProps } from 'class-variance-authority';

import { cn } from '@/lib/utils';

const buttonVariants = cva(
  'inline-flex items-center justify-center whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50',
  {
    variants: {
      variant: {
        default: 'bg-primary text-primary-foreground hover:bg-primary/90',
        destructive:
          'bg-destructive text-destructive-foreground hover:bg-destructive/90',
        outline:
          'border border-input bg-background hover:bg-accent hover:text-accent-foreground',
        secondary:
          'bg-secondary text-secondary-foreground hover:bg-secondary/80',
        ghost: 'hover:bg-accent hover:text-accent-foreground',
        link: 'text-primary underline-offset-4 hover:underline',
        avatar: '',  
      },
      size: {
        default: 'h-10 px-4 py-2',
        sm: 'h-9 rounded-md px-3',
        lg: 'h-11 rounded-md px-8',
        icon: 'h-10 w-10',
      },
    },
    defaultVariants: {
      variant: 'default',
      size: 'default',
    },
  }
);

export interface ButtonProps
  extends React.ButtonHTMLAttributes<HTMLButtonElement>,
    VariantProps<typeof buttonVariants> {
  asChild?: boolean;
}

const Button = React.forwardRef<HTMLButtonElement, ButtonProps>(
  ({ className, variant, size, asChild = false, ...props }, ref) => {
    const Comp = asChild ? Slot : 'button';
    return (
      <Comp
        className={cn(buttonVariants({ variant, size, className }))}
        ref={ref}
        {...props}
      />
    );
  }
);
Button.displayName = 'Button';

export { Button, buttonVariants };


# =================================================================
# Arquivo: .\components\ui\calendar.tsx
# =================================================================

"use client";

import * as React from "react";
import { ChevronLeft, ChevronRight } from "lucide-react";
import { DayPicker } from "react-day-picker";
import { cn } from "@/lib/utils";
import { buttonVariants } from "@/components/ui/button";

export type CalendarProps = React.ComponentProps<typeof DayPicker>;

function Calendar({
  className,
  classNames,
  showOutsideDays = true,
  ...props
}: CalendarProps) {
  return (
    <DayPicker
      showOutsideDays={showOutsideDays}
      className={cn("p-3", className)}
      classNames={{
        months: "flex flex-col sm:flex-row space-y-4 sm:space-x-4 sm:space-y-0",
        month: "space-y-4",
        caption: "flex justify-center pt-1 relative items-center",
        caption_label: "text-sm font-medium text-purple-200",
        nav: "space-x-1 flex items-center",
        nav_button: cn(
          buttonVariants({ variant: "outline" }),
          "h-7 w-7 bg-transparent p-0 opacity-50 hover:opacity-100"
        ),
        nav_button_previous: "absolute left-1",
        nav_button_next: "absolute right-1",
        table: "w-full border-collapse space-y-1",
        head_row: "flex",
        head_cell:
          "text-purple-200/50 rounded-md w-9 font-normal text-[0.8rem]",
        row: "flex w-full mt-2",
        cell: "h-9 w-9 text-center text-sm p-0 relative [&:has([aria-selected].day-range-end)]:rounded-r-md [&:has([aria-selected].day-outside)]:bg-accent/50 [&:has([aria-selected])]:bg-accent first:[&:has([aria-selected])]:rounded-l-md last:[&:has([aria-selected])]:rounded-r-md focus-within:relative focus-within:z-20",
        day: cn(
          buttonVariants({ variant: "ghost" }),
          "h-9 w-9 p-0 font-normal aria-selected:opacity-100"
        ),
        day_range_end: "day-range-end",
        day_selected:
          "bg-purple-500/20 text-purple-200 hover:bg-purple-500/30 hover:text-purple-200 focus:bg-purple-500/30 focus:text-purple-200",
        day_today: "bg-accent text-accent-foreground",
        day_outside:
          "day-outside text-purple-200/50 opacity-50 aria-selected:bg-accent/50 aria-selected:text-purple-200 aria-selected:opacity-30",
        day_disabled: "text-purple-200/20",
        day_range_middle:
          "aria-selected:bg-accent aria-selected:text-accent-foreground",
        day_hidden: "invisible",
        ...classNames,
      }}
      components={{
        IconLeft: ({ ...props }) => <ChevronLeft className="h-4 w-4" />,
        IconRight: ({ ...props }) => <ChevronRight className="h-4 w-4" />,
      }}
      {...props}
    />
  );
}
Calendar.displayName = "Calendar";

export { Calendar };

# =================================================================
# Arquivo: .\components\ui\card.tsx
# =================================================================

"use client";

import * as React from "react";
import { cn } from "@/lib/utils";

const Card = React.forwardRef<
  HTMLDivElement,
  React.HTMLAttributes<HTMLDivElement>
>(({ className, ...props }, ref) => (
  <div
    ref={ref}
    className={cn(
      "rounded-lg border bg-card text-card-foreground shadow-sm",
      className
    )}
    {...props}
  />
));
Card.displayName = "Card";

const CardHeader = React.forwardRef<
  HTMLDivElement,
  React.HTMLAttributes<HTMLDivElement>
>(({ className, ...props }, ref) => (
  <div
    ref={ref}
    className={cn("flex flex-col space-y-1.5 p-6", className)}
    {...props}
  />
));
CardHeader.displayName = "CardHeader";

const CardTitle = React.forwardRef<
  HTMLParagraphElement,
  React.HTMLAttributes<HTMLHeadingElement>
>(({ className, ...props }, ref) => (
  <h3
    ref={ref}
    className={cn(
      "text-2xl font-semibold leading-none tracking-tight",
      className
    )}
    {...props}
  />
));
CardTitle.displayName = "CardTitle";

const CardDescription = React.forwardRef<
  HTMLParagraphElement,
  React.HTMLAttributes<HTMLParagraphElement>
>(({ className, ...props }, ref) => (
  <p
    ref={ref}
    className={cn("text-sm text-muted-foreground", className)}
    {...props}
  />
));
CardDescription.displayName = "CardDescription";

const CardContent = React.forwardRef<
  HTMLDivElement,
  React.HTMLAttributes<HTMLDivElement>
>(({ className, ...props }, ref) => (
  <div ref={ref} className={cn("p-6 pt-0", className)} {...props} />
));
CardContent.displayName = "CardContent";

const CardFooter = React.forwardRef<
  HTMLDivElement,
  React.HTMLAttributes<HTMLDivElement>
>(({ className, ...props }, ref) => (
  <div
    ref={ref}
    className={cn("flex items-center p-6 pt-0", className)}
    {...props}
  />
));
CardFooter.displayName = "CardFooter";

export { Card, CardHeader, CardFooter, CardTitle, CardDescription, CardContent };

# =================================================================
# Arquivo: .\components\ui\carousel.tsx
# =================================================================

'use client';

import * as React from 'react';
import useEmblaCarousel, {
  type UseEmblaCarouselType,
} from 'embla-carousel-react';
import { ArrowLeft, ArrowRight } from 'lucide-react';

import { cn } from '@/lib/utils';
import { Button } from '@/components/ui/button';

type CarouselApi = UseEmblaCarouselType[1];
type UseCarouselParameters = Parameters<typeof useEmblaCarousel>;
type CarouselOptions = UseCarouselParameters[0];
type CarouselPlugin = UseCarouselParameters[1];

type CarouselProps = {
  opts?: CarouselOptions;
  plugins?: CarouselPlugin;
  orientation?: 'horizontal' | 'vertical';
  setApi?: (api: CarouselApi) => void;
};

type CarouselContextProps = {
  carouselRef: ReturnType<typeof useEmblaCarousel>[0];
  api: ReturnType<typeof useEmblaCarousel>[1];
  scrollPrev: () => void;
  scrollNext: () => void;
  canScrollPrev: boolean;
  canScrollNext: boolean;
} & CarouselProps;

const CarouselContext = React.createContext<CarouselContextProps | null>(null);

function useCarousel() {
  const context = React.useContext(CarouselContext);

  if (!context) {
    throw new Error('useCarousel must be used within a <Carousel />');
  }

  return context;
}

const Carousel = React.forwardRef<
  HTMLDivElement,
  React.HTMLAttributes<HTMLDivElement> & CarouselProps
>(
  (
    {
      orientation = 'horizontal',
      opts,
      setApi,
      plugins,
      className,
      children,
      ...props
    },
    ref
  ) => {
    const [carouselRef, api] = useEmblaCarousel(
      {
        ...opts,
        axis: orientation === 'horizontal' ? 'x' : 'y',
      },
      plugins
    );
    const [canScrollPrev, setCanScrollPrev] = React.useState(false);
    const [canScrollNext, setCanScrollNext] = React.useState(false);

    const onSelect = React.useCallback((api: CarouselApi) => {
      if (!api) {
        return;
      }

      setCanScrollPrev(api.canScrollPrev());
      setCanScrollNext(api.canScrollNext());
    }, []);

    const scrollPrev = React.useCallback(() => {
      api?.scrollPrev();
    }, [api]);

    const scrollNext = React.useCallback(() => {
      api?.scrollNext();
    }, [api]);

    const handleKeyDown = React.useCallback(
      (event: React.KeyboardEvent<HTMLDivElement>) => {
        if (event.key === 'ArrowLeft') {
          event.preventDefault();
          scrollPrev();
        } else if (event.key === 'ArrowRight') {
          event.preventDefault();
          scrollNext();
        }
      },
      [scrollPrev, scrollNext]
    );

    React.useEffect(() => {
      if (!api || !setApi) {
        return;
      }

      setApi(api);
    }, [api, setApi]);

    React.useEffect(() => {
      if (!api) {
        return;
      }

      onSelect(api);
      api.on('reInit', onSelect);
      api.on('select', onSelect);

      return () => {
        api?.off('select', onSelect);
      };
    }, [api, onSelect]);

    return (
      <CarouselContext.Provider
        value={{
          carouselRef,
          api: api,
          opts,
          orientation:
            orientation || (opts?.axis === 'y' ? 'vertical' : 'horizontal'),
          scrollPrev,
          scrollNext,
          canScrollPrev,
          canScrollNext,
        }}
      >
        <div
          ref={ref}
          onKeyDownCapture={handleKeyDown}
          className={cn('relative', className)}
          role="region"
          aria-roledescription="carousel"
          {...props}
        >
          {children}
        </div>
      </CarouselContext.Provider>
    );
  }
);
Carousel.displayName = 'Carousel';

const CarouselContent = React.forwardRef<
  HTMLDivElement,
  React.HTMLAttributes<HTMLDivElement>
>(({ className, ...props }, ref) => {
  const { carouselRef, orientation } = useCarousel();

  return (
    <div ref={carouselRef} className="overflow-hidden">
      <div
        ref={ref}
        className={cn(
          'flex',
          orientation === 'horizontal' ? '-ml-4' : '-mt-4 flex-col',
          className
        )}
        {...props}
      />
    </div>
  );
});
CarouselContent.displayName = 'CarouselContent';

const CarouselItem = React.forwardRef<
  HTMLDivElement,
  React.HTMLAttributes<HTMLDivElement>
>(({ className, ...props }, ref) => {
  const { orientation } = useCarousel();

  return (
    <div
      ref={ref}
      role="group"
      aria-roledescription="slide"
      className={cn(
        'min-w-0 shrink-0 grow-0 basis-full',
        orientation === 'horizontal' ? 'pl-4' : 'pt-4',
        className
      )}
      {...props}
    />
  );
});
CarouselItem.displayName = 'CarouselItem';

const CarouselPrevious = React.forwardRef<
  HTMLButtonElement,
  React.ComponentProps<typeof Button>
>(({ className, variant = 'outline', size = 'icon', ...props }, ref) => {
  const { orientation, scrollPrev, canScrollPrev } = useCarousel();

  return (
    <Button
      ref={ref}
      variant={variant}
      size={size}
      className={cn(
        'absolute  h-8 w-8 rounded-full',
        orientation === 'horizontal'
          ? '-left-12 top-1/2 -translate-y-1/2'
          : '-top-12 left-1/2 -translate-x-1/2 rotate-90',
        className
      )}
      disabled={!canScrollPrev}
      onClick={scrollPrev}
      {...props}
    >
      <ArrowLeft className="h-4 w-4" />
      <span className="sr-only">Previous slide</span>
    </Button>
  );
});
CarouselPrevious.displayName = 'CarouselPrevious';

const CarouselNext = React.forwardRef<
  HTMLButtonElement,
  React.ComponentProps<typeof Button>
>(({ className, variant = 'outline', size = 'icon', ...props }, ref) => {
  const { orientation, scrollNext, canScrollNext } = useCarousel();

  return (
    <Button
      ref={ref}
      variant={variant}
      size={size}
      className={cn(
        'absolute h-8 w-8 rounded-full',
        orientation === 'horizontal'
          ? '-right-12 top-1/2 -translate-y-1/2'
          : '-bottom-12 left-1/2 -translate-x-1/2 rotate-90',
        className
      )}
      disabled={!canScrollNext}
      onClick={scrollNext}
      {...props}
    >
      <ArrowRight className="h-4 w-4" />
      <span className="sr-only">Next slide</span>
    </Button>
  );
});
CarouselNext.displayName = 'CarouselNext';

export {
  type CarouselApi,
  Carousel,
  CarouselContent,
  CarouselItem,
  CarouselPrevious,
  CarouselNext,
};


# =================================================================
# Arquivo: .\components\ui\chart.tsx
# =================================================================

'use client';

import * as React from 'react';
import * as RechartsPrimitive from 'recharts';

import { cn } from '@/lib/utils';

// Format: { THEME_NAME: CSS_SELECTOR }
const THEMES = { light: '', dark: '.dark' } as const;

export type ChartConfig = {
  [k in string]: {
    label?: React.ReactNode;
    icon?: React.ComponentType;
  } & (
    | { color?: string; theme?: never }
    | { color?: never; theme: Record<keyof typeof THEMES, string> }
  );
};

type ChartContextProps = {
  config: ChartConfig;
};

const ChartContext = React.createContext<ChartContextProps | null>(null);

function useChart() {
  const context = React.useContext(ChartContext);

  if (!context) {
    throw new Error('useChart must be used within a <ChartContainer />');
  }

  return context;
}

const ChartContainer = React.forwardRef<
  HTMLDivElement,
  React.ComponentProps<'div'> & {
    config: ChartConfig;
    children: React.ComponentProps<
      typeof RechartsPrimitive.ResponsiveContainer
    >['children'];
  }
>(({ id, className, children, config, ...props }, ref) => {
  const uniqueId = React.useId();
  const chartId = `chart-${id || uniqueId.replace(/:/g, '')}`;

  return (
    <ChartContext.Provider value={{ config }}>
      <div
        data-chart={chartId}
        ref={ref}
        className={cn(
          "flex aspect-video justify-center text-xs [&_.recharts-cartesian-axis-tick_text]:fill-muted-foreground [&_.recharts-cartesian-grid_line[stroke='#ccc']]:stroke-border/50 [&_.recharts-curve.recharts-tooltip-cursor]:stroke-border [&_.recharts-dot[stroke='#fff']]:stroke-transparent [&_.recharts-layer]:outline-none [&_.recharts-polar-grid_[stroke='#ccc']]:stroke-border [&_.recharts-radial-bar-background-sector]:fill-muted [&_.recharts-rectangle.recharts-tooltip-cursor]:fill-muted [&_.recharts-reference-line_[stroke='#ccc']]:stroke-border [&_.recharts-sector[stroke='#fff']]:stroke-transparent [&_.recharts-sector]:outline-none [&_.recharts-surface]:outline-none",
          className
        )}
        {...props}
      >
        <ChartStyle id={chartId} config={config} />
        <RechartsPrimitive.ResponsiveContainer>
          {children}
        </RechartsPrimitive.ResponsiveContainer>
      </div>
    </ChartContext.Provider>
  );
});
ChartContainer.displayName = 'Chart';

const ChartStyle = ({ id, config }: { id: string; config: ChartConfig }) => {
  const colorConfig = Object.entries(config).filter(
    ([_, config]) => config.theme || config.color
  );

  if (!colorConfig.length) {
    return null;
  }

  return (
    <style
      dangerouslySetInnerHTML={{
        __html: Object.entries(THEMES)
          .map(
            ([theme, prefix]) => `
${prefix} [data-chart=${id}] {
${colorConfig
  .map(([key, itemConfig]) => {
    const color =
      itemConfig.theme?.[theme as keyof typeof itemConfig.theme] ||
      itemConfig.color;
    return color ? `  --color-${key}: ${color};` : null;
  })
  .join('\n')}
}
`
          )
          .join('\n'),
      }}
    />
  );
};

const ChartTooltip = RechartsPrimitive.Tooltip;

const ChartTooltipContent = React.forwardRef<
  HTMLDivElement,
  React.ComponentProps<typeof RechartsPrimitive.Tooltip> &
    React.ComponentProps<'div'> & {
      hideLabel?: boolean;
      hideIndicator?: boolean;
      indicator?: 'line' | 'dot' | 'dashed';
      nameKey?: string;
      labelKey?: string;
    }
>(
  (
    {
      active,
      payload,
      className,
      indicator = 'dot',
      hideLabel = false,
      hideIndicator = false,
      label,
      labelFormatter,
      labelClassName,
      formatter,
      color,
      nameKey,
      labelKey,
    },
    ref
  ) => {
    const { config } = useChart();

    const tooltipLabel = React.useMemo(() => {
      if (hideLabel || !payload?.length) {
        return null;
      }

      const [item] = payload;
      const key = `${labelKey || item.dataKey || item.name || 'value'}`;
      const itemConfig = getPayloadConfigFromPayload(config, item, key);
      const value =
        !labelKey && typeof label === 'string'
          ? config[label as keyof typeof config]?.label || label
          : itemConfig?.label;

      if (labelFormatter) {
        return (
          <div className={cn('font-medium', labelClassName)}>
            {labelFormatter(value, payload)}
          </div>
        );
      }

      if (!value) {
        return null;
      }

      return <div className={cn('font-medium', labelClassName)}>{value}</div>;
    }, [
      label,
      labelFormatter,
      payload,
      hideLabel,
      labelClassName,
      config,
      labelKey,
    ]);

    if (!active || !payload?.length) {
      return null;
    }

    const nestLabel = payload.length === 1 && indicator !== 'dot';

    return (
      <div
        ref={ref}
        className={cn(
          'grid min-w-[8rem] items-start gap-1.5 rounded-lg border border-border/50 bg-background px-2.5 py-1.5 text-xs shadow-xl',
          className
        )}
      >
        {!nestLabel ? tooltipLabel : null}
        <div className="grid gap-1.5">
          {payload.map((item, index) => {
            const key = `${nameKey || item.name || item.dataKey || 'value'}`;
            const itemConfig = getPayloadConfigFromPayload(config, item, key);
            const indicatorColor = color || item.payload.fill || item.color;

            return (
              <div
                key={item.dataKey}
                className={cn(
                  'flex w-full flex-wrap items-stretch gap-2 [&>svg]:h-2.5 [&>svg]:w-2.5 [&>svg]:text-muted-foreground',
                  indicator === 'dot' && 'items-center'
                )}
              >
                {formatter && item?.value !== undefined && item.name ? (
                  formatter(item.value, item.name, item, index, item.payload)
                ) : (
                  <>
                    {itemConfig?.icon ? (
                      <itemConfig.icon />
                    ) : (
                      !hideIndicator && (
                        <div
                          className={cn(
                            'shrink-0 rounded-[2px] border-[--color-border] bg-[--color-bg]',
                            {
                              'h-2.5 w-2.5': indicator === 'dot',
                              'w-1': indicator === 'line',
                              'w-0 border-[1.5px] border-dashed bg-transparent':
                                indicator === 'dashed',
                              'my-0.5': nestLabel && indicator === 'dashed',
                            }
                          )}
                          style={
                            {
                              '--color-bg': indicatorColor,
                              '--color-border': indicatorColor,
                            } as React.CSSProperties
                          }
                        />
                      )
                    )}
                    <div
                      className={cn(
                        'flex flex-1 justify-between leading-none',
                        nestLabel ? 'items-end' : 'items-center'
                      )}
                    >
                      <div className="grid gap-1.5">
                        {nestLabel ? tooltipLabel : null}
                        <span className="text-muted-foreground">
                          {itemConfig?.label || item.name}
                        </span>
                      </div>
                      {item.value && (
                        <span className="font-mono font-medium tabular-nums text-foreground">
                          {item.value.toLocaleString()}
                        </span>
                      )}
                    </div>
                  </>
                )}
              </div>
            );
          })}
        </div>
      </div>
    );
  }
);
ChartTooltipContent.displayName = 'ChartTooltip';

const ChartLegend = RechartsPrimitive.Legend;

const ChartLegendContent = React.forwardRef<
  HTMLDivElement,
  React.ComponentProps<'div'> &
    Pick<RechartsPrimitive.LegendProps, 'payload' | 'verticalAlign'> & {
      hideIcon?: boolean;
      nameKey?: string;
    }
>(
  (
    { className, hideIcon = false, payload, verticalAlign = 'bottom', nameKey },
    ref
  ) => {
    const { config } = useChart();

    if (!payload?.length) {
      return null;
    }

    return (
      <div
        ref={ref}
        className={cn(
          'flex items-center justify-center gap-4',
          verticalAlign === 'top' ? 'pb-3' : 'pt-3',
          className
        )}
      >
        {payload.map((item) => {
          const key = `${nameKey || item.dataKey || 'value'}`;
          const itemConfig = getPayloadConfigFromPayload(config, item, key);

          return (
            <div
              key={item.value}
              className={cn(
                'flex items-center gap-1.5 [&>svg]:h-3 [&>svg]:w-3 [&>svg]:text-muted-foreground'
              )}
            >
              {itemConfig?.icon && !hideIcon ? (
                <itemConfig.icon />
              ) : (
                <div
                  className="h-2 w-2 shrink-0 rounded-[2px]"
                  style={{
                    backgroundColor: item.color,
                  }}
                />
              )}
              {itemConfig?.label}
            </div>
          );
        })}
      </div>
    );
  }
);
ChartLegendContent.displayName = 'ChartLegend';

// Helper to extract item config from a payload.
function getPayloadConfigFromPayload(
  config: ChartConfig,
  payload: unknown,
  key: string
) {
  if (typeof payload !== 'object' || payload === null) {
    return undefined;
  }

  const payloadPayload =
    'payload' in payload &&
    typeof payload.payload === 'object' &&
    payload.payload !== null
      ? payload.payload
      : undefined;

  let configLabelKey: string = key;

  if (
    key in payload &&
    typeof payload[key as keyof typeof payload] === 'string'
  ) {
    configLabelKey = payload[key as keyof typeof payload] as string;
  } else if (
    payloadPayload &&
    key in payloadPayload &&
    typeof payloadPayload[key as keyof typeof payloadPayload] === 'string'
  ) {
    configLabelKey = payloadPayload[
      key as keyof typeof payloadPayload
    ] as string;
  }

  return configLabelKey in config
    ? config[configLabelKey]
    : config[key as keyof typeof config];
}

export {
  ChartContainer,
  ChartTooltip,
  ChartTooltipContent,
  ChartLegend,
  ChartLegendContent,
  ChartStyle,
};


# =================================================================
# Arquivo: .\components\ui\checkbox.tsx
# =================================================================

'use client';

import * as React from 'react';
import * as CheckboxPrimitive from '@radix-ui/react-checkbox';
import { Check } from 'lucide-react';

import { cn } from '@/lib/utils';

const Checkbox = React.forwardRef<
  React.ElementRef<typeof CheckboxPrimitive.Root>,
  React.ComponentPropsWithoutRef<typeof CheckboxPrimitive.Root>
>(({ className, ...props }, ref) => (
  <CheckboxPrimitive.Root
    ref={ref}
    className={cn(
      'peer h-4 w-4 shrink-0 rounded-sm border border-primary ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=checked]:text-primary-foreground',
      className
    )}
    {...props}
  >
    <CheckboxPrimitive.Indicator
      className={cn('flex items-center justify-center text-current')}
    >
      <Check className="h-4 w-4" />
    </CheckboxPrimitive.Indicator>
  </CheckboxPrimitive.Root>
));
Checkbox.displayName = CheckboxPrimitive.Root.displayName;

export { Checkbox };


# =================================================================
# Arquivo: .\components\ui\collapsible.tsx
# =================================================================

'use client';

import * as CollapsiblePrimitive from '@radix-ui/react-collapsible';

const Collapsible = CollapsiblePrimitive.Root;

const CollapsibleTrigger = CollapsiblePrimitive.CollapsibleTrigger;

const CollapsibleContent = CollapsiblePrimitive.CollapsibleContent;

export { Collapsible, CollapsibleTrigger, CollapsibleContent };


# =================================================================
# Arquivo: .\components\ui\command.tsx
# =================================================================

'use client';

import * as React from 'react';
import { type DialogProps } from '@radix-ui/react-dialog';
import { Command as CommandPrimitive } from 'cmdk';
import { Search } from 'lucide-react';

import { cn } from '@/lib/utils';
import { Dialog, DialogContent } from '@/components/ui/dialog';

const Command = React.forwardRef<
  React.ElementRef<typeof CommandPrimitive>,
  React.ComponentPropsWithoutRef<typeof CommandPrimitive>
>(({ className, ...props }, ref) => (
  <CommandPrimitive
    ref={ref}
    className={cn(
      'flex h-full w-full flex-col overflow-hidden rounded-md bg-popover text-popover-foreground',
      className
    )}
    {...props}
  />
));
Command.displayName = CommandPrimitive.displayName;

interface CommandDialogProps extends DialogProps {}

const CommandDialog = ({ children, ...props }: CommandDialogProps) => {
  return (
    <Dialog {...props}>
      <DialogContent className="overflow-hidden p-0 shadow-lg">
        <Command className="[&_[cmdk-group-heading]]:px-2 [&_[cmdk-group-heading]]:font-medium [&_[cmdk-group-heading]]:text-muted-foreground [&_[cmdk-group]:not([hidden])_~[cmdk-group]]:pt-0 [&_[cmdk-group]]:px-2 [&_[cmdk-input-wrapper]_svg]:h-5 [&_[cmdk-input-wrapper]_svg]:w-5 [&_[cmdk-input]]:h-12 [&_[cmdk-item]]:px-2 [&_[cmdk-item]]:py-3 [&_[cmdk-item]_svg]:h-5 [&_[cmdk-item]_svg]:w-5">
          {children}
        </Command>
      </DialogContent>
    </Dialog>
  );
};

const CommandInput = React.forwardRef<
  React.ElementRef<typeof CommandPrimitive.Input>,
  React.ComponentPropsWithoutRef<typeof CommandPrimitive.Input>
>(({ className, ...props }, ref) => (
  <div className="flex items-center border-b px-3" cmdk-input-wrapper="">
    <Search className="mr-2 h-4 w-4 shrink-0 opacity-50" />
    <CommandPrimitive.Input
      ref={ref}
      className={cn(
        'flex h-11 w-full rounded-md bg-transparent py-3 text-sm outline-none placeholder:text-muted-foreground disabled:cursor-not-allowed disabled:opacity-50',
        className
      )}
      {...props}
    />
  </div>
));

CommandInput.displayName = CommandPrimitive.Input.displayName;

const CommandList = React.forwardRef<
  React.ElementRef<typeof CommandPrimitive.List>,
  React.ComponentPropsWithoutRef<typeof CommandPrimitive.List>
>(({ className, ...props }, ref) => (
  <CommandPrimitive.List
    ref={ref}
    className={cn('max-h-[300px] overflow-y-auto overflow-x-hidden', className)}
    {...props}
  />
));

CommandList.displayName = CommandPrimitive.List.displayName;

const CommandEmpty = React.forwardRef<
  React.ElementRef<typeof CommandPrimitive.Empty>,
  React.ComponentPropsWithoutRef<typeof CommandPrimitive.Empty>
>((props, ref) => (
  <CommandPrimitive.Empty
    ref={ref}
    className="py-6 text-center text-sm"
    {...props}
  />
));

CommandEmpty.displayName = CommandPrimitive.Empty.displayName;

const CommandGroup = React.forwardRef<
  React.ElementRef<typeof CommandPrimitive.Group>,
  React.ComponentPropsWithoutRef<typeof CommandPrimitive.Group>
>(({ className, ...props }, ref) => (
  <CommandPrimitive.Group
    ref={ref}
    className={cn(
      'overflow-hidden p-1 text-foreground [&_[cmdk-group-heading]]:px-2 [&_[cmdk-group-heading]]:py-1.5 [&_[cmdk-group-heading]]:text-xs [&_[cmdk-group-heading]]:font-medium [&_[cmdk-group-heading]]:text-muted-foreground',
      className
    )}
    {...props}
  />
));

CommandGroup.displayName = CommandPrimitive.Group.displayName;

const CommandSeparator = React.forwardRef<
  React.ElementRef<typeof CommandPrimitive.Separator>,
  React.ComponentPropsWithoutRef<typeof CommandPrimitive.Separator>
>(({ className, ...props }, ref) => (
  <CommandPrimitive.Separator
    ref={ref}
    className={cn('-mx-1 h-px bg-border', className)}
    {...props}
  />
));
CommandSeparator.displayName = CommandPrimitive.Separator.displayName;

const CommandItem = React.forwardRef<
  React.ElementRef<typeof CommandPrimitive.Item>,
  React.ComponentPropsWithoutRef<typeof CommandPrimitive.Item>
>(({ className, ...props }, ref) => (
  <CommandPrimitive.Item
    ref={ref}
    className={cn(
      "relative flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none data-[disabled=true]:pointer-events-none data-[selected='true']:bg-accent data-[selected=true]:text-accent-foreground data-[disabled=true]:opacity-50",
      className
    )}
    {...props}
  />
));

CommandItem.displayName = CommandPrimitive.Item.displayName;

const CommandShortcut = ({
  className,
  ...props
}: React.HTMLAttributes<HTMLSpanElement>) => {
  return (
    <span
      className={cn(
        'ml-auto text-xs tracking-widest text-muted-foreground',
        className
      )}
      {...props}
    />
  );
};
CommandShortcut.displayName = 'CommandShortcut';

export {
  Command,
  CommandDialog,
  CommandInput,
  CommandList,
  CommandEmpty,
  CommandGroup,
  CommandItem,
  CommandShortcut,
  CommandSeparator,
};


# =================================================================
# Arquivo: .\components\ui\context-menu.tsx
# =================================================================

'use client';

import * as React from 'react';
import * as ContextMenuPrimitive from '@radix-ui/react-context-menu';
import { Check, ChevronRight, Circle } from 'lucide-react';

import { cn } from '@/lib/utils';

const ContextMenu = ContextMenuPrimitive.Root;

const ContextMenuTrigger = ContextMenuPrimitive.Trigger;

const ContextMenuGroup = ContextMenuPrimitive.Group;

const ContextMenuPortal = ContextMenuPrimitive.Portal;

const ContextMenuSub = ContextMenuPrimitive.Sub;

const ContextMenuRadioGroup = ContextMenuPrimitive.RadioGroup;

const ContextMenuSubTrigger = React.forwardRef<
  React.ElementRef<typeof ContextMenuPrimitive.SubTrigger>,
  React.ComponentPropsWithoutRef<typeof ContextMenuPrimitive.SubTrigger> & {
    inset?: boolean;
  }
>(({ className, inset, children, ...props }, ref) => (
  <ContextMenuPrimitive.SubTrigger
    ref={ref}
    className={cn(
      'flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[state=open]:bg-accent data-[state=open]:text-accent-foreground',
      inset && 'pl-8',
      className
    )}
    {...props}
  >
    {children}
    <ChevronRight className="ml-auto h-4 w-4" />
  </ContextMenuPrimitive.SubTrigger>
));
ContextMenuSubTrigger.displayName = ContextMenuPrimitive.SubTrigger.displayName;

const ContextMenuSubContent = React.forwardRef<
  React.ElementRef<typeof ContextMenuPrimitive.SubContent>,
  React.ComponentPropsWithoutRef<typeof ContextMenuPrimitive.SubContent>
>(({ className, ...props }, ref) => (
  <ContextMenuPrimitive.SubContent
    ref={ref}
    className={cn(
      'z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2',
      className
    )}
    {...props}
  />
));
ContextMenuSubContent.displayName = ContextMenuPrimitive.SubContent.displayName;

const ContextMenuContent = React.forwardRef<
  React.ElementRef<typeof ContextMenuPrimitive.Content>,
  React.ComponentPropsWithoutRef<typeof ContextMenuPrimitive.Content>
>(({ className, ...props }, ref) => (
  <ContextMenuPrimitive.Portal>
    <ContextMenuPrimitive.Content
      ref={ref}
      className={cn(
        'z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-md animate-in fade-in-80 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2',
        className
      )}
      {...props}
    />
  </ContextMenuPrimitive.Portal>
));
ContextMenuContent.displayName = ContextMenuPrimitive.Content.displayName;

const ContextMenuItem = React.forwardRef<
  React.ElementRef<typeof ContextMenuPrimitive.Item>,
  React.ComponentPropsWithoutRef<typeof ContextMenuPrimitive.Item> & {
    inset?: boolean;
  }
>(({ className, inset, ...props }, ref) => (
  <ContextMenuPrimitive.Item
    ref={ref}
    className={cn(
      'relative flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50',
      inset && 'pl-8',
      className
    )}
    {...props}
  />
));
ContextMenuItem.displayName = ContextMenuPrimitive.Item.displayName;

const ContextMenuCheckboxItem = React.forwardRef<
  React.ElementRef<typeof ContextMenuPrimitive.CheckboxItem>,
  React.ComponentPropsWithoutRef<typeof ContextMenuPrimitive.CheckboxItem>
>(({ className, children, checked, ...props }, ref) => (
  <ContextMenuPrimitive.CheckboxItem
    ref={ref}
    className={cn(
      'relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50',
      className
    )}
    checked={checked}
    {...props}
  >
    <span className="absolute left-2 flex h-3.5 w-3.5 items-center justify-center">
      <ContextMenuPrimitive.ItemIndicator>
        <Check className="h-4 w-4" />
      </ContextMenuPrimitive.ItemIndicator>
    </span>
    {children}
  </ContextMenuPrimitive.CheckboxItem>
));
ContextMenuCheckboxItem.displayName =
  ContextMenuPrimitive.CheckboxItem.displayName;

const ContextMenuRadioItem = React.forwardRef<
  React.ElementRef<typeof ContextMenuPrimitive.RadioItem>,
  React.ComponentPropsWithoutRef<typeof ContextMenuPrimitive.RadioItem>
>(({ className, children, ...props }, ref) => (
  <ContextMenuPrimitive.RadioItem
    ref={ref}
    className={cn(
      'relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50',
      className
    )}
    {...props}
  >
    <span className="absolute left-2 flex h-3.5 w-3.5 items-center justify-center">
      <ContextMenuPrimitive.ItemIndicator>
        <Circle className="h-2 w-2 fill-current" />
      </ContextMenuPrimitive.ItemIndicator>
    </span>
    {children}
  </ContextMenuPrimitive.RadioItem>
));
ContextMenuRadioItem.displayName = ContextMenuPrimitive.RadioItem.displayName;

const ContextMenuLabel = React.forwardRef<
  React.ElementRef<typeof ContextMenuPrimitive.Label>,
  React.ComponentPropsWithoutRef<typeof ContextMenuPrimitive.Label> & {
    inset?: boolean;
  }
>(({ className, inset, ...props }, ref) => (
  <ContextMenuPrimitive.Label
    ref={ref}
    className={cn(
      'px-2 py-1.5 text-sm font-semibold text-foreground',
      inset && 'pl-8',
      className
    )}
    {...props}
  />
));
ContextMenuLabel.displayName = ContextMenuPrimitive.Label.displayName;

const ContextMenuSeparator = React.forwardRef<
  React.ElementRef<typeof ContextMenuPrimitive.Separator>,
  React.ComponentPropsWithoutRef<typeof ContextMenuPrimitive.Separator>
>(({ className, ...props }, ref) => (
  <ContextMenuPrimitive.Separator
    ref={ref}
    className={cn('-mx-1 my-1 h-px bg-border', className)}
    {...props}
  />
));
ContextMenuSeparator.displayName = ContextMenuPrimitive.Separator.displayName;

const ContextMenuShortcut = ({
  className,
  ...props
}: React.HTMLAttributes<HTMLSpanElement>) => {
  return (
    <span
      className={cn(
        'ml-auto text-xs tracking-widest text-muted-foreground',
        className
      )}
      {...props}
    />
  );
};
ContextMenuShortcut.displayName = 'ContextMenuShortcut';

export {
  ContextMenu,
  ContextMenuTrigger,
  ContextMenuContent,
  ContextMenuItem,
  ContextMenuCheckboxItem,
  ContextMenuRadioItem,
  ContextMenuLabel,
  ContextMenuSeparator,
  ContextMenuShortcut,
  ContextMenuGroup,
  ContextMenuPortal,
  ContextMenuSub,
  ContextMenuSubContent,
  ContextMenuSubTrigger,
  ContextMenuRadioGroup,
};


# =================================================================
# Arquivo: .\components\ui\date-picker.tsx
# =================================================================

"use client";

import * as React from "react";
import { cn } from "@/lib/utils";
import { Calendar } from "@/components/ui/calendar"; // Este √© o DayPicker
import { ptBR } from 'date-fns/locale';
import type { Locale } from 'date-fns'; // <--- IMPORTAR Locale
import {
  DateRange,
  SelectSingleEventHandler,
  SelectRangeEventHandler,
  DayPickerProps // <--- IMPORTAR DayPickerProps para os tipos de classNames
} from 'react-day-picker';

// Tipos base para props que n√£o mudam com o mode
type DatePickerBaseProps = {
  locale?: Locale; // Agora 'Locale' √© conhecido
  className?: string;
  classNames?: DayPickerProps['classNames']; // <--- Usar DayPickerProps['classNames']
  // Adicione outras props do DayPicker que voc√™ quer expor e que n√£o dependem do mode
  // como initialFocus, numberOfMonths, etc.
};

// Tipos condicionais para selected e onSelect baseados no mode
type ConditionalProps<TMode extends "single" | "range" | "multiple" | "default" | undefined> =
  TMode extends "single" ? {
    mode: TMode;
    selected?: Date;
    onSelect?: SelectSingleEventHandler;
  } :
  TMode extends "range" ? {
    mode: TMode;
    selected?: DateRange;
    onSelect?: SelectRangeEventHandler;
  } :
  // Adicionar "multiple" se voc√™ for us√°-lo
  // TMode extends "multiple" ? {
  //   mode: TMode;
  //   selected?: Date[];
  //   onSelect?: SelectMultipleEventHandler;
  // } :
  {
    mode?: TMode;
    selected?: Date;
    onSelect?: SelectSingleEventHandler;
  };

// Combina os tipos base com os condicionais
export type DatePickerProps = DatePickerBaseProps & (
  ConditionalProps<"single"> |
  ConditionalProps<"range">
  // | ConditionalProps<"multiple">
  // | ConditionalProps<"default">
);

export function DatePicker({ mode = "single", selected, onSelect, ...props }: DatePickerProps) {
  // Se o seu default real √© 'range', voc√™ pode ajustar a assinatura da fun√ß√£o ou o valor padr√£o de 'mode'.
  // Por exemplo, para default 'range':
  // export function DatePicker({ mode = "range" as "range", selected, onSelect, ...props }: DatePickerProps) {
  // Ou, se este componente S√ì lida com 'range':
  // export function DatePicker({ mode = "range", selected, onSelect, ...props }: ConditionalProps<"range"> & DatePickerBaseProps) {

  return (
    <div className="grid gap-2">
      <Calendar
        mode={mode}
        // @ts-ignore - Se os tipos condicionais complexos ainda causarem problemas aqui.
        // O objetivo √© que esta linha n√£o precise de ignore quando os tipos estiverem perfeitos.
        selected={selected as any} // Tempor√°rio, idealmente os tipos se alinham
        onSelect={onSelect as any}   // Tempor√°rio, idealmente os tipos se alinham
        locale={props.locale || ptBR} // Usa a prop locale ou ptBR como fallback
        className={cn("rounded-md border-purple-500/20 bg-black/40", props.className)}
        classNames={{ // Mescla os classNames passados com os defaults internos
          head_cell: cn("text-purple-200/60 font-medium text-xs", props.classNames?.head_cell),
          cell: cn(
            "h-8 w-8 text-center text-xs p-0 relative",
            "hover:bg-purple-500/20 focus-within:relative focus-within:z-20",
            props.classNames?.cell
          ),
          day: cn(
            "h-8 w-8 p-0 font-normal text-purple-200/80 text-xs",
            "hover:bg-purple-500/20 hover:text-purple-100",
            "focus:bg-purple-500/20 focus:text-purple-100",
            props.classNames?.day
          ),
          day_selected: cn("bg-purple-500/30 text-purple-100 hover:bg-purple-500/40", props.classNames?.day_selected),
          day_today: cn("bg-purple-500/10 text-purple-100", props.classNames?.day_today),
          day_outside: cn("text-purple-200/40", props.classNames?.day_outside),
          day_disabled: cn("text-purple-200/20", props.classNames?.day_disabled),
          day_range_middle: cn("aria-selected:bg-purple-500/20", props.classNames?.day_range_middle),
          day_hidden: cn("invisible", props.classNames?.day_hidden),
          nav_button: cn(
            "border border-purple-500/20 bg-black/40",
            "hover:bg-purple-500/20 hover:text-purple-100",
            props.classNames?.nav_button
          ),
          nav_button_previous: cn("absolute left-1", props.classNames?.nav_button_previous),
          nav_button_next: cn("absolute right-1", props.classNames?.nav_button_next),
          caption: cn("relative h-8 flex items-center justify-center text-purple-100 text-sm", props.classNames?.caption),
          ...props.classNames, // Garante que quaisquer outros classNames passados sejam aplicados
        }}
        {...props} // Passa quaisquer outras props DayPicker v√°lidas n√£o explicitamente tratadas
      />
    </div>
  );
}

# =================================================================
# Arquivo: .\components\ui\date-range-picker.tsx
# =================================================================

"use client";

import * as React from "react";
import { format } from "date-fns";
import { Calendar } from "@/components/ui/calendar"; // Este √© o DayPicker
import { cn } from "@/lib/utils";
import { Input } from "@/components/ui/input";
import { Label } from "@/components/ui/label";
import { ptBR } from 'date-fns/locale'; // Importando ptBR para usar se necess√°rio
import type { Locale } from 'date-fns';
import {
  DateRange, // <-- Importar DateRange
  SelectRangeEventHandler, // <-- Importar SelectRangeEventHandler
  DayPickerProps
} from 'react-day-picker';

// Props para o seu componente DateRangePicker customizado
interface CustomDateRangePickerProps {
  selectedRange?: DateRange; // <-- Mudar para DateRange
  onRangeSelect?: SelectRangeEventHandler; // <-- Mudar para SelectRangeEventHandler
  numberOfMonths?: number;
  locale?: Locale;
  className?: string; // Para o container principal, se houver
  calendarClassName?: string;
  calendarClassNames?: DayPickerProps['classNames'];
  // Adicione outras props que voc√™ queira passar para o DayPicker
  disabled?: DayPickerProps['disabled'];
  // ... outras props espec√≠ficas do DayPicker que voc√™ queira expor
}

export function DateRangePicker({
  selectedRange,
  onRangeSelect,
  numberOfMonths = 1,
  locale = ptBR,
  calendarClassName,
  calendarClassNames,
  ...props // Coleta outras props como 'disabled'
}: CustomDateRangePickerProps) {
  const startDate = selectedRange?.from;
  const endDate = selectedRange?.to;

  return (
    <div className="space-y-4">
      <div className="grid grid-cols-2 gap-4">
        <div className="space-y-2">
          <Label className="text-xs text-purple-200/80">Start Date</Label>
          <Input
            value={startDate ? format(startDate, 'MMM dd, yyyy', { locale }) : ''}
            readOnly
            className="bg-black/40 border-purple-500/20 text-purple-100 text-xs h-8"
            placeholder="Select start date"
          />
        </div>
        <div className="space-y-2">
          <Label className="text-xs text-purple-200/80">End Date</Label>
          <Input
            value={endDate ? format(endDate, 'MMM dd, yyyy', { locale }) : ''}
            readOnly
            className="bg-black/40 border-purple-500/20 text-purple-100 text-xs h-8"
            placeholder="Select end date"
          />
        </div>
      </div>

      <Calendar
        mode="range"
        selected={selectedRange} // <-- Passar selectedRange
        onSelect={onRangeSelect} // <-- Passar onRangeSelect
        numberOfMonths={numberOfMonths}
        locale={locale}
        className={cn("rounded-md border-purple-500/20 bg-black/40 w-full", calendarClassName)}
        classNames={{
          head_row: "flex",
          head_cell: "text-purple-200/60 font-medium text-xs flex-1 text-center", // Use flex-1 for fluid width
          row: "flex w-full",
          cell: "flex-1 h-9 text-center text-sm p-0 relative [&:has([aria-selected])]:bg-purple-500/20", // Use flex-1 for fluid width
          day: "h-9 w-full p-0 font-normal text-purple-200/80", // Use w-full for day
          day_range_start: "rounded-l-md bg-purple-500/30",
          day_range_end: "rounded-r-md bg-purple-500/30",
          day_selected: "bg-purple-500/30 text-purple-100 hover:bg-purple-500/40",
          day_today: "bg-purple-500/10 text-purple-100",
          day_outside: "text-purple-200/40",
          day_disabled: "text-purple-200/20",
          day_range_middle: "bg-purple-500/20",
          day_hidden: "invisible",
          nav_button: "border border-purple-500/20 bg-black/40 hover:bg-purple-500/20",
          nav_button_previous: "absolute left-1",
          nav_button_next: "absolute right-1",
          caption: "relative h-9 flex items-center justify-center text-purple-100",
          ...calendarClassNames // Permite sobrescrever ou adicionar mais classNames via props
        }}
        {...props} // Passa outras DayPickerProps como 'disabled'
      />
    </div>
  );
}


# =================================================================
# Arquivo: .\components\ui\dialog.tsx
# =================================================================

'use client';

import * as React from 'react';
import * as DialogPrimitive from '@radix-ui/react-dialog';
import { X } from 'lucide-react';

import { cn } from '@/lib/utils';

const Dialog = DialogPrimitive.Root;

const DialogTrigger = DialogPrimitive.Trigger;

const DialogPortal = DialogPrimitive.Portal;

const DialogClose = DialogPrimitive.Close;

const DialogOverlay = React.forwardRef<
  React.ElementRef<typeof DialogPrimitive.Overlay>,
  React.ComponentPropsWithoutRef<typeof DialogPrimitive.Overlay>
>(({ className, ...props }, ref) => (
  <DialogPrimitive.Overlay
    ref={ref}
    className={cn(
      'fixed inset-0 z-50 bg-black/80  data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0',
      className
    )}
    {...props}
  />
));
DialogOverlay.displayName = DialogPrimitive.Overlay.displayName;

const DialogContent = React.forwardRef<
  React.ElementRef<typeof DialogPrimitive.Content>,
  React.ComponentPropsWithoutRef<typeof DialogPrimitive.Content>
>(({ className, children, ...props }, ref) => (
  <DialogPortal>
    <DialogOverlay />
    <DialogPrimitive.Content
      ref={ref}
      className={cn(
        'fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg',
        className
      )}
      {...props}
    >
      {children}
      <DialogPrimitive.Close className="absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-accent data-[state=open]:text-muted-foreground">
        <X className="h-4 w-4" />
        <span className="sr-only">Close</span>
      </DialogPrimitive.Close>
    </DialogPrimitive.Content>
  </DialogPortal>
));
DialogContent.displayName = DialogPrimitive.Content.displayName;

const DialogHeader = ({
  className,
  ...props
}: React.HTMLAttributes<HTMLDivElement>) => (
  <div
    className={cn(
      'flex flex-col space-y-1.5 text-center sm:text-left',
      className
    )}
    {...props}
  />
);
DialogHeader.displayName = 'DialogHeader';

const DialogFooter = ({
  className,
  ...props
}: React.HTMLAttributes<HTMLDivElement>) => (
  <div
    className={cn(
      'flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2',
      className
    )}
    {...props}
  />
);
DialogFooter.displayName = 'DialogFooter';

const DialogTitle = React.forwardRef<
  React.ElementRef<typeof DialogPrimitive.Title>,
  React.ComponentPropsWithoutRef<typeof DialogPrimitive.Title>
>(({ className, ...props }, ref) => (
  <DialogPrimitive.Title
    ref={ref}
    className={cn(
      'text-lg font-semibold leading-none tracking-tight',
      className
    )}
    {...props}
  />
));
DialogTitle.displayName = DialogPrimitive.Title.displayName;

const DialogDescription = React.forwardRef<
  React.ElementRef<typeof DialogPrimitive.Description>,
  React.ComponentPropsWithoutRef<typeof DialogPrimitive.Description>
>(({ className, ...props }, ref) => (
  <DialogPrimitive.Description
    ref={ref}
    className={cn('text-sm text-muted-foreground', className)}
    {...props}
  />
));
DialogDescription.displayName = DialogPrimitive.Description.displayName;

export {
  Dialog,
  DialogPortal,
  DialogOverlay,
  DialogClose,
  DialogTrigger,
  DialogContent,
  DialogHeader,
  DialogFooter,
  DialogTitle,
  DialogDescription,
};


# =================================================================
# Arquivo: .\components\ui\drawer.tsx
# =================================================================

'use client';

import * as React from 'react';
import { Drawer as DrawerPrimitive } from 'vaul';

import { cn } from '@/lib/utils';

const Drawer = ({
  shouldScaleBackground = true,
  ...props
}: React.ComponentProps<typeof DrawerPrimitive.Root>) => (
  <DrawerPrimitive.Root
    shouldScaleBackground={shouldScaleBackground}
    {...props}
  />
);
Drawer.displayName = 'Drawer';

const DrawerTrigger = DrawerPrimitive.Trigger;

const DrawerPortal = DrawerPrimitive.Portal;

const DrawerClose = DrawerPrimitive.Close;

const DrawerOverlay = React.forwardRef<
  React.ElementRef<typeof DrawerPrimitive.Overlay>,
  React.ComponentPropsWithoutRef<typeof DrawerPrimitive.Overlay>
>(({ className, ...props }, ref) => (
  <DrawerPrimitive.Overlay
    ref={ref}
    className={cn('fixed inset-0 z-50 bg-black/80', className)}
    {...props}
  />
));
DrawerOverlay.displayName = DrawerPrimitive.Overlay.displayName;

const DrawerContent = React.forwardRef<
  React.ElementRef<typeof DrawerPrimitive.Content>,
  React.ComponentPropsWithoutRef<typeof DrawerPrimitive.Content>
>(({ className, children, ...props }, ref) => (
  <DrawerPortal>
    <DrawerOverlay />
    <DrawerPrimitive.Content
      ref={ref}
      className={cn(
        'fixed inset-x-0 bottom-0 z-50 mt-24 flex h-auto flex-col rounded-t-[10px] border bg-background',
        className
      )}
      {...props}
    >
      <div className="mx-auto mt-4 h-2 w-[100px] rounded-full bg-muted" />
      {children}
    </DrawerPrimitive.Content>
  </DrawerPortal>
));
DrawerContent.displayName = 'DrawerContent';

const DrawerHeader = ({
  className,
  ...props
}: React.HTMLAttributes<HTMLDivElement>) => (
  <div
    className={cn('grid gap-1.5 p-4 text-center sm:text-left', className)}
    {...props}
  />
);
DrawerHeader.displayName = 'DrawerHeader';

const DrawerFooter = ({
  className,
  ...props
}: React.HTMLAttributes<HTMLDivElement>) => (
  <div
    className={cn('mt-auto flex flex-col gap-2 p-4', className)}
    {...props}
  />
);
DrawerFooter.displayName = 'DrawerFooter';

const DrawerTitle = React.forwardRef<
  React.ElementRef<typeof DrawerPrimitive.Title>,
  React.ComponentPropsWithoutRef<typeof DrawerPrimitive.Title>
>(({ className, ...props }, ref) => (
  <DrawerPrimitive.Title
    ref={ref}
    className={cn(
      'text-lg font-semibold leading-none tracking-tight',
      className
    )}
    {...props}
  />
));
DrawerTitle.displayName = DrawerPrimitive.Title.displayName;

const DrawerDescription = React.forwardRef<
  React.ElementRef<typeof DrawerPrimitive.Description>,
  React.ComponentPropsWithoutRef<typeof DrawerPrimitive.Description>
>(({ className, ...props }, ref) => (
  <DrawerPrimitive.Description
    ref={ref}
    className={cn('text-sm text-muted-foreground', className)}
    {...props}
  />
));
DrawerDescription.displayName = DrawerPrimitive.Description.displayName;

export {
  Drawer,
  DrawerPortal,
  DrawerOverlay,
  DrawerTrigger,
  DrawerClose,
  DrawerContent,
  DrawerHeader,
  DrawerFooter,
  DrawerTitle,
  DrawerDescription,
};


# =================================================================
# Arquivo: .\components\ui\dropdown-menu.tsx
# =================================================================

'use client';

import * as React from 'react';
import * as DropdownMenuPrimitive from '@radix-ui/react-dropdown-menu';
import { Check, ChevronRight, Circle } from 'lucide-react';

import { cn } from '@/lib/utils';

const DropdownMenu = DropdownMenuPrimitive.Root;

const DropdownMenuTrigger = DropdownMenuPrimitive.Trigger;

const DropdownMenuGroup = DropdownMenuPrimitive.Group;

const DropdownMenuPortal = DropdownMenuPrimitive.Portal;

const DropdownMenuSub = DropdownMenuPrimitive.Sub;

const DropdownMenuRadioGroup = DropdownMenuPrimitive.RadioGroup;

const DropdownMenuSubTrigger = React.forwardRef<
  React.ElementRef<typeof DropdownMenuPrimitive.SubTrigger>,
  React.ComponentPropsWithoutRef<typeof DropdownMenuPrimitive.SubTrigger> & {
    inset?: boolean;
  }
>(({ className, inset, children, ...props }, ref) => (
  <DropdownMenuPrimitive.SubTrigger
    ref={ref}
    className={cn(
      'flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none focus:bg-accent data-[state=open]:bg-accent',
      inset && 'pl-8',
      className
    )}
    {...props}
  >
    {children}
    <ChevronRight className="ml-auto h-4 w-4" />
  </DropdownMenuPrimitive.SubTrigger>
));
DropdownMenuSubTrigger.displayName =
  DropdownMenuPrimitive.SubTrigger.displayName;

const DropdownMenuSubContent = React.forwardRef<
  React.ElementRef<typeof DropdownMenuPrimitive.SubContent>,
  React.ComponentPropsWithoutRef<typeof DropdownMenuPrimitive.SubContent>
>(({ className, ...props }, ref) => (
  <DropdownMenuPrimitive.SubContent
    ref={ref}
    className={cn(
      'z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-lg data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2',
      className
    )}
    {...props}
  />
));
DropdownMenuSubContent.displayName =
  DropdownMenuPrimitive.SubContent.displayName;

const DropdownMenuContent = React.forwardRef<
  React.ElementRef<typeof DropdownMenuPrimitive.Content>,
  React.ComponentPropsWithoutRef<typeof DropdownMenuPrimitive.Content>
>(({ className, sideOffset = 4, ...props }, ref) => (
  <DropdownMenuPrimitive.Portal>
    <DropdownMenuPrimitive.Content
      ref={ref}
      sideOffset={sideOffset}
      className={cn(
        'z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2',
        className
      )}
      {...props}
    />
  </DropdownMenuPrimitive.Portal>
));
DropdownMenuContent.displayName = DropdownMenuPrimitive.Content.displayName;

const DropdownMenuItem = React.forwardRef<
  React.ElementRef<typeof DropdownMenuPrimitive.Item>,
  React.ComponentPropsWithoutRef<typeof DropdownMenuPrimitive.Item> & {
    inset?: boolean;
  }
>(({ className, inset, ...props }, ref) => (
  <DropdownMenuPrimitive.Item
    ref={ref}
    className={cn(
      'relative flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50',
      inset && 'pl-8',
      className
    )}
    {...props}
  />
));
DropdownMenuItem.displayName = DropdownMenuPrimitive.Item.displayName;

const DropdownMenuCheckboxItem = React.forwardRef<
  React.ElementRef<typeof DropdownMenuPrimitive.CheckboxItem>,
  React.ComponentPropsWithoutRef<typeof DropdownMenuPrimitive.CheckboxItem>
>(({ className, children, checked, ...props }, ref) => (
  <DropdownMenuPrimitive.CheckboxItem
    ref={ref}
    className={cn(
      'relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50',
      className
    )}
    checked={checked}
    {...props}
  >
    <span className="absolute left-2 flex h-3.5 w-3.5 items-center justify-center">
      <DropdownMenuPrimitive.ItemIndicator>
        <Check className="h-4 w-4" />
      </DropdownMenuPrimitive.ItemIndicator>
    </span>
    {children}
  </DropdownMenuPrimitive.CheckboxItem>
));
DropdownMenuCheckboxItem.displayName =
  DropdownMenuPrimitive.CheckboxItem.displayName;

const DropdownMenuRadioItem = React.forwardRef<
  React.ElementRef<typeof DropdownMenuPrimitive.RadioItem>,
  React.ComponentPropsWithoutRef<typeof DropdownMenuPrimitive.RadioItem>
>(({ className, children, ...props }, ref) => (
  <DropdownMenuPrimitive.RadioItem
    ref={ref}
    className={cn(
      'relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50',
      className
    )}
    {...props}
  >
    <span className="absolute left-2 flex h-3.5 w-3.5 items-center justify-center">
      <DropdownMenuPrimitive.ItemIndicator>
        <Circle className="h-2 w-2 fill-current" />
      </DropdownMenuPrimitive.ItemIndicator>
    </span>
    {children}
  </DropdownMenuPrimitive.RadioItem>
));
DropdownMenuRadioItem.displayName = DropdownMenuPrimitive.RadioItem.displayName;

const DropdownMenuLabel = React.forwardRef<
  React.ElementRef<typeof DropdownMenuPrimitive.Label>,
  React.ComponentPropsWithoutRef<typeof DropdownMenuPrimitive.Label> & {
    inset?: boolean;
  }
>(({ className, inset, ...props }, ref) => (
  <DropdownMenuPrimitive.Label
    ref={ref}
    className={cn(
      'px-2 py-1.5 text-sm font-semibold',
      inset && 'pl-8',
      className
    )}
    {...props}
  />
));
DropdownMenuLabel.displayName = DropdownMenuPrimitive.Label.displayName;

const DropdownMenuSeparator = React.forwardRef<
  React.ElementRef<typeof DropdownMenuPrimitive.Separator>,
  React.ComponentPropsWithoutRef<typeof DropdownMenuPrimitive.Separator>
>(({ className, ...props }, ref) => (
  <DropdownMenuPrimitive.Separator
    ref={ref}
    className={cn('-mx-1 my-1 h-px bg-muted', className)}
    {...props}
  />
));
DropdownMenuSeparator.displayName = DropdownMenuPrimitive.Separator.displayName;

const DropdownMenuShortcut = ({
  className,
  ...props
}: React.HTMLAttributes<HTMLSpanElement>) => {
  return (
    <span
      className={cn('ml-auto text-xs tracking-widest opacity-60', className)}
      {...props}
    />
  );
};
DropdownMenuShortcut.displayName = 'DropdownMenuShortcut';

export {
  DropdownMenu,
  DropdownMenuTrigger,
  DropdownMenuContent,
  DropdownMenuItem,
  DropdownMenuCheckboxItem,
  DropdownMenuRadioItem,
  DropdownMenuLabel,
  DropdownMenuSeparator,
  DropdownMenuShortcut,
  DropdownMenuGroup,
  DropdownMenuPortal,
  DropdownMenuSub,
  DropdownMenuSubContent,
  DropdownMenuSubTrigger,
  DropdownMenuRadioGroup,
};


# =================================================================
# Arquivo: .\components\ui\form.tsx
# =================================================================

'use client';

import * as React from 'react';
import * as LabelPrimitive from '@radix-ui/react-label';
import { Slot } from '@radix-ui/react-slot';
import {
  Controller,
  ControllerProps,
  FieldPath,
  FieldValues,
  FormProvider,
  useFormContext,
} from 'react-hook-form';

import { cn } from '@/lib/utils';
import { Label } from '@/components/ui/label';

const Form = FormProvider;

type FormFieldContextValue<
  TFieldValues extends FieldValues = FieldValues,
  TName extends FieldPath<TFieldValues> = FieldPath<TFieldValues>
> = {
  name: TName;
};

const FormFieldContext = React.createContext<FormFieldContextValue>(
  {} as FormFieldContextValue
);

const FormField = <
  TFieldValues extends FieldValues = FieldValues,
  TName extends FieldPath<TFieldValues> = FieldPath<TFieldValues>
>({
  ...props
}: ControllerProps<TFieldValues, TName>) => {
  return (
    <FormFieldContext.Provider value={{ name: props.name }}>
      <Controller {...props} />
    </FormFieldContext.Provider>
  );
};

const useFormField = () => {
  const fieldContext = React.useContext(FormFieldContext);
  const itemContext = React.useContext(FormItemContext);
  const { getFieldState, formState } = useFormContext();

  const fieldState = getFieldState(fieldContext.name, formState);

  if (!fieldContext) {
    throw new Error('useFormField should be used within <FormField>');
  }

  const { id } = itemContext;

  return {
    id,
    name: fieldContext.name,
    formItemId: `${id}-form-item`,
    formDescriptionId: `${id}-form-item-description`,
    formMessageId: `${id}-form-item-message`,
    ...fieldState,
  };
};

type FormItemContextValue = {
  id: string;
};

const FormItemContext = React.createContext<FormItemContextValue>(
  {} as FormItemContextValue
);

const FormItem = React.forwardRef<
  HTMLDivElement,
  React.HTMLAttributes<HTMLDivElement>
>(({ className, ...props }, ref) => {
  const id = React.useId();

  return (
    <FormItemContext.Provider value={{ id }}>
      <div ref={ref} className={cn('space-y-2', className)} {...props} />
    </FormItemContext.Provider>
  );
});
FormItem.displayName = 'FormItem';

const FormLabel = React.forwardRef<
  React.ElementRef<typeof LabelPrimitive.Root>,
  React.ComponentPropsWithoutRef<typeof LabelPrimitive.Root>
>(({ className, ...props }, ref) => {
  const { error, formItemId } = useFormField();

  return (
    <Label
      ref={ref}
      className={cn(error && 'text-destructive', className)}
      htmlFor={formItemId}
      {...props}
    />
  );
});
FormLabel.displayName = 'FormLabel';

const FormControl = React.forwardRef<
  React.ElementRef<typeof Slot>,
  React.ComponentPropsWithoutRef<typeof Slot>
>(({ ...props }, ref) => {
  const { error, formItemId, formDescriptionId, formMessageId } =
    useFormField();

  return (
    <Slot
      ref={ref}
      id={formItemId}
      aria-describedby={
        !error
          ? `${formDescriptionId}`
          : `${formDescriptionId} ${formMessageId}`
      }
      aria-invalid={!!error}
      {...props}
    />
  );
});
FormControl.displayName = 'FormControl';

const FormDescription = React.forwardRef<
  HTMLParagraphElement,
  React.HTMLAttributes<HTMLParagraphElement>
>(({ className, ...props }, ref) => {
  const { formDescriptionId } = useFormField();

  return (
    <p
      ref={ref}
      id={formDescriptionId}
      className={cn('text-sm text-muted-foreground', className)}
      {...props}
    />
  );
});
FormDescription.displayName = 'FormDescription';

const FormMessage = React.forwardRef<
  HTMLParagraphElement,
  React.HTMLAttributes<HTMLParagraphElement>
>(({ className, children, ...props }, ref) => {
  const { error, formMessageId } = useFormField();
  const body = error ? String(error?.message) : children;

  if (!body) {
    return null;
  }

  return (
    <p
      ref={ref}
      id={formMessageId}
      className={cn('text-sm font-medium text-destructive', className)}
      {...props}
    >
      {body}
    </p>
  );
});
FormMessage.displayName = 'FormMessage';

export {
  useFormField,
  Form,
  FormItem,
  FormLabel,
  FormControl,
  FormDescription,
  FormMessage,
  FormField,
};


# =================================================================
# Arquivo: .\components\ui\hover-card.tsx
# =================================================================

'use client';

import * as React from 'react';
import * as HoverCardPrimitive from '@radix-ui/react-hover-card';

import { cn } from '@/lib/utils';

const HoverCard = HoverCardPrimitive.Root;

const HoverCardTrigger = HoverCardPrimitive.Trigger;

const HoverCardContent = React.forwardRef<
  React.ElementRef<typeof HoverCardPrimitive.Content>,
  React.ComponentPropsWithoutRef<typeof HoverCardPrimitive.Content>
>(({ className, align = 'center', sideOffset = 4, ...props }, ref) => (
  <HoverCardPrimitive.Content
    ref={ref}
    align={align}
    sideOffset={sideOffset}
    className={cn(
      'z-50 w-64 rounded-md border bg-popover p-4 text-popover-foreground shadow-md outline-none data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2',
      className
    )}
    {...props}
  />
));
HoverCardContent.displayName = HoverCardPrimitive.Content.displayName;

export { HoverCard, HoverCardTrigger, HoverCardContent };


# =================================================================
# Arquivo: .\components\ui\input-otp.tsx
# =================================================================

'use client';

import * as React from 'react';
import { OTPInput, OTPInputContext } from 'input-otp';
import { Dot } from 'lucide-react';

import { cn } from '@/lib/utils';

const InputOTP = React.forwardRef<
  React.ElementRef<typeof OTPInput>,
  React.ComponentPropsWithoutRef<typeof OTPInput>
>(({ className, containerClassName, ...props }, ref) => (
  <OTPInput
    ref={ref}
    containerClassName={cn(
      'flex items-center gap-2 has-[:disabled]:opacity-50',
      containerClassName
    )}
    className={cn('disabled:cursor-not-allowed', className)}
    {...props}
  />
));
InputOTP.displayName = 'InputOTP';

const InputOTPGroup = React.forwardRef<
  React.ElementRef<'div'>,
  React.ComponentPropsWithoutRef<'div'>
>(({ className, ...props }, ref) => (
  <div ref={ref} className={cn('flex items-center', className)} {...props} />
));
InputOTPGroup.displayName = 'InputOTPGroup';

const InputOTPSlot = React.forwardRef<
  React.ElementRef<'div'>,
  React.ComponentPropsWithoutRef<'div'> & { index: number }
>(({ index, className, ...props }, ref) => {
  const inputOTPContext = React.useContext(OTPInputContext);
  const { char, hasFakeCaret, isActive } = inputOTPContext.slots[index];

  return (
    <div
      ref={ref}
      className={cn(
        'relative flex h-10 w-10 items-center justify-center border-y border-r border-input text-sm transition-all first:rounded-l-md first:border-l last:rounded-r-md',
        isActive && 'z-10 ring-2 ring-ring ring-offset-background',
        className
      )}
      {...props}
    >
      {char}
      {hasFakeCaret && (
        <div className="pointer-events-none absolute inset-0 flex items-center justify-center">
          <div className="h-4 w-px animate-caret-blink bg-foreground duration-1000" />
        </div>
      )}
    </div>
  );
});
InputOTPSlot.displayName = 'InputOTPSlot';

const InputOTPSeparator = React.forwardRef<
  React.ElementRef<'div'>,
  React.ComponentPropsWithoutRef<'div'>
>(({ ...props }, ref) => (
  <div ref={ref} role="separator" {...props}>
    <Dot />
  </div>
));
InputOTPSeparator.displayName = 'InputOTPSeparator';

export { InputOTP, InputOTPGroup, InputOTPSlot, InputOTPSeparator };


# =================================================================
# Arquivo: .\components\ui\input.tsx
# =================================================================

import * as React from 'react';

import { cn } from '@/lib/utils';

export interface InputProps
  extends React.InputHTMLAttributes<HTMLInputElement> {}

const Input = React.forwardRef<HTMLInputElement, InputProps>(
  ({ className, type, ...props }, ref) => {
    return (
      <input
        type={type}
        className={cn(
          'flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium file:text-foreground placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50',
          className
        )}
        ref={ref}
        {...props}
      />
    );
  }
);
Input.displayName = 'Input';

export { Input };


# =================================================================
# Arquivo: .\components\ui\label.tsx
# =================================================================

'use client';

import * as React from 'react';
import * as LabelPrimitive from '@radix-ui/react-label';
import { cva, type VariantProps } from 'class-variance-authority';

import { cn } from '@/lib/utils';

const labelVariants = cva(
  'text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70'
);

const Label = React.forwardRef<
  React.ElementRef<typeof LabelPrimitive.Root>,
  React.ComponentPropsWithoutRef<typeof LabelPrimitive.Root> &
    VariantProps<typeof labelVariants>
>(({ className, ...props }, ref) => (
  <LabelPrimitive.Root
    ref={ref}
    className={cn(labelVariants(), className)}
    {...props}
  />
));
Label.displayName = LabelPrimitive.Root.displayName;

export { Label };


# =================================================================
# Arquivo: .\components\ui\menubar.tsx
# =================================================================

'use client';

import * as React from 'react';
import * as MenubarPrimitive from '@radix-ui/react-menubar';
import { Check, ChevronRight, Circle } from 'lucide-react';

import { cn } from '@/lib/utils';

const MenubarMenu = MenubarPrimitive.Menu;

const MenubarGroup = MenubarPrimitive.Group;

const MenubarPortal = MenubarPrimitive.Portal;

const MenubarSub = MenubarPrimitive.Sub;

const MenubarRadioGroup = MenubarPrimitive.RadioGroup;

const Menubar = React.forwardRef<
  React.ElementRef<typeof MenubarPrimitive.Root>,
  React.ComponentPropsWithoutRef<typeof MenubarPrimitive.Root>
>(({ className, ...props }, ref) => (
  <MenubarPrimitive.Root
    ref={ref}
    className={cn(
      'flex h-10 items-center space-x-1 rounded-md border bg-background p-1',
      className
    )}
    {...props}
  />
));
Menubar.displayName = MenubarPrimitive.Root.displayName;

const MenubarTrigger = React.forwardRef<
  React.ElementRef<typeof MenubarPrimitive.Trigger>,
  React.ComponentPropsWithoutRef<typeof MenubarPrimitive.Trigger>
>(({ className, ...props }, ref) => (
  <MenubarPrimitive.Trigger
    ref={ref}
    className={cn(
      'flex cursor-default select-none items-center rounded-sm px-3 py-1.5 text-sm font-medium outline-none focus:bg-accent focus:text-accent-foreground data-[state=open]:bg-accent data-[state=open]:text-accent-foreground',
      className
    )}
    {...props}
  />
));
MenubarTrigger.displayName = MenubarPrimitive.Trigger.displayName;

const MenubarSubTrigger = React.forwardRef<
  React.ElementRef<typeof MenubarPrimitive.SubTrigger>,
  React.ComponentPropsWithoutRef<typeof MenubarPrimitive.SubTrigger> & {
    inset?: boolean;
  }
>(({ className, inset, children, ...props }, ref) => (
  <MenubarPrimitive.SubTrigger
    ref={ref}
    className={cn(
      'flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[state=open]:bg-accent data-[state=open]:text-accent-foreground',
      inset && 'pl-8',
      className
    )}
    {...props}
  >
    {children}
    <ChevronRight className="ml-auto h-4 w-4" />
  </MenubarPrimitive.SubTrigger>
));
MenubarSubTrigger.displayName = MenubarPrimitive.SubTrigger.displayName;

const MenubarSubContent = React.forwardRef<
  React.ElementRef<typeof MenubarPrimitive.SubContent>,
  React.ComponentPropsWithoutRef<typeof MenubarPrimitive.SubContent>
>(({ className, ...props }, ref) => (
  <MenubarPrimitive.SubContent
    ref={ref}
    className={cn(
      'z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2',
      className
    )}
    {...props}
  />
));
MenubarSubContent.displayName = MenubarPrimitive.SubContent.displayName;

const MenubarContent = React.forwardRef<
  React.ElementRef<typeof MenubarPrimitive.Content>,
  React.ComponentPropsWithoutRef<typeof MenubarPrimitive.Content>
>(
  (
    { className, align = 'start', alignOffset = -4, sideOffset = 8, ...props },
    ref
  ) => (
    <MenubarPrimitive.Portal>
      <MenubarPrimitive.Content
        ref={ref}
        align={align}
        alignOffset={alignOffset}
        sideOffset={sideOffset}
        className={cn(
          'z-50 min-w-[12rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2',
          className
        )}
        {...props}
      />
    </MenubarPrimitive.Portal>
  )
);
MenubarContent.displayName = MenubarPrimitive.Content.displayName;

const MenubarItem = React.forwardRef<
  React.ElementRef<typeof MenubarPrimitive.Item>,
  React.ComponentPropsWithoutRef<typeof MenubarPrimitive.Item> & {
    inset?: boolean;
  }
>(({ className, inset, ...props }, ref) => (
  <MenubarPrimitive.Item
    ref={ref}
    className={cn(
      'relative flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50',
      inset && 'pl-8',
      className
    )}
    {...props}
  />
));
MenubarItem.displayName = MenubarPrimitive.Item.displayName;

const MenubarCheckboxItem = React.forwardRef<
  React.ElementRef<typeof MenubarPrimitive.CheckboxItem>,
  React.ComponentPropsWithoutRef<typeof MenubarPrimitive.CheckboxItem>
>(({ className, children, checked, ...props }, ref) => (
  <MenubarPrimitive.CheckboxItem
    ref={ref}
    className={cn(
      'relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50',
      className
    )}
    checked={checked}
    {...props}
  >
    <span className="absolute left-2 flex h-3.5 w-3.5 items-center justify-center">
      <MenubarPrimitive.ItemIndicator>
        <Check className="h-4 w-4" />
      </MenubarPrimitive.ItemIndicator>
    </span>
    {children}
  </MenubarPrimitive.CheckboxItem>
));
MenubarCheckboxItem.displayName = MenubarPrimitive.CheckboxItem.displayName;

const MenubarRadioItem = React.forwardRef<
  React.ElementRef<typeof MenubarPrimitive.RadioItem>,
  React.ComponentPropsWithoutRef<typeof MenubarPrimitive.RadioItem>
>(({ className, children, ...props }, ref) => (
  <MenubarPrimitive.RadioItem
    ref={ref}
    className={cn(
      'relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50',
      className
    )}
    {...props}
  >
    <span className="absolute left-2 flex h-3.5 w-3.5 items-center justify-center">
      <MenubarPrimitive.ItemIndicator>
        <Circle className="h-2 w-2 fill-current" />
      </MenubarPrimitive.ItemIndicator>
    </span>
    {children}
  </MenubarPrimitive.RadioItem>
));
MenubarRadioItem.displayName = MenubarPrimitive.RadioItem.displayName;

const MenubarLabel = React.forwardRef<
  React.ElementRef<typeof MenubarPrimitive.Label>,
  React.ComponentPropsWithoutRef<typeof MenubarPrimitive.Label> & {
    inset?: boolean;
  }
>(({ className, inset, ...props }, ref) => (
  <MenubarPrimitive.Label
    ref={ref}
    className={cn(
      'px-2 py-1.5 text-sm font-semibold',
      inset && 'pl-8',
      className
    )}
    {...props}
  />
));
MenubarLabel.displayName = MenubarPrimitive.Label.displayName;

const MenubarSeparator = React.forwardRef<
  React.ElementRef<typeof MenubarPrimitive.Separator>,
  React.ComponentPropsWithoutRef<typeof MenubarPrimitive.Separator>
>(({ className, ...props }, ref) => (
  <MenubarPrimitive.Separator
    ref={ref}
    className={cn('-mx-1 my-1 h-px bg-muted', className)}
    {...props}
  />
));
MenubarSeparator.displayName = MenubarPrimitive.Separator.displayName;

const MenubarShortcut = ({
  className,
  ...props
}: React.HTMLAttributes<HTMLSpanElement>) => {
  return (
    <span
      className={cn(
        'ml-auto text-xs tracking-widest text-muted-foreground',
        className
      )}
      {...props}
    />
  );
};
MenubarShortcut.displayname = 'MenubarShortcut';

export {
  Menubar,
  MenubarMenu,
  MenubarTrigger,
  MenubarContent,
  MenubarItem,
  MenubarSeparator,
  MenubarLabel,
  MenubarCheckboxItem,
  MenubarRadioGroup,
  MenubarRadioItem,
  MenubarPortal,
  MenubarSubContent,
  MenubarSubTrigger,
  MenubarGroup,
  MenubarSub,
  MenubarShortcut,
};


# =================================================================
# Arquivo: .\components\ui\navigation-menu.tsx
# =================================================================

import * as React from 'react';
import * as NavigationMenuPrimitive from '@radix-ui/react-navigation-menu';
import { cva } from 'class-variance-authority';
import { ChevronDown } from 'lucide-react';

import { cn } from '@/lib/utils';

const NavigationMenu = React.forwardRef<
  React.ElementRef<typeof NavigationMenuPrimitive.Root>,
  React.ComponentPropsWithoutRef<typeof NavigationMenuPrimitive.Root>
>(({ className, children, ...props }, ref) => (
  <NavigationMenuPrimitive.Root
    ref={ref}
    className={cn(
      'relative z-10 flex max-w-max flex-1 items-center justify-center',
      className
    )}
    {...props}
  >
    {children}
    <NavigationMenuViewport />
  </NavigationMenuPrimitive.Root>
));
NavigationMenu.displayName = NavigationMenuPrimitive.Root.displayName;

const NavigationMenuList = React.forwardRef<
  React.ElementRef<typeof NavigationMenuPrimitive.List>,
  React.ComponentPropsWithoutRef<typeof NavigationMenuPrimitive.List>
>(({ className, ...props }, ref) => (
  <NavigationMenuPrimitive.List
    ref={ref}
    className={cn(
      'group flex flex-1 list-none items-center justify-center space-x-1',
      className
    )}
    {...props}
  />
));
NavigationMenuList.displayName = NavigationMenuPrimitive.List.displayName;

const NavigationMenuItem = NavigationMenuPrimitive.Item;

const navigationMenuTriggerStyle = cva(
  'group inline-flex h-10 w-max items-center justify-center rounded-md bg-background px-4 py-2 text-sm font-medium transition-colors hover:bg-accent hover:text-accent-foreground focus:bg-accent focus:text-accent-foreground focus:outline-none disabled:pointer-events-none disabled:opacity-50 data-[active]:bg-accent/50 data-[state=open]:bg-accent/50'
);

const NavigationMenuTrigger = React.forwardRef<
  React.ElementRef<typeof NavigationMenuPrimitive.Trigger>,
  React.ComponentPropsWithoutRef<typeof NavigationMenuPrimitive.Trigger>
>(({ className, children, ...props }, ref) => (
  <NavigationMenuPrimitive.Trigger
    ref={ref}
    className={cn(navigationMenuTriggerStyle(), 'group', className)}
    {...props}
  >
    {children}{' '}
    <ChevronDown
      className="relative top-[1px] ml-1 h-3 w-3 transition duration-200 group-data-[state=open]:rotate-180"
      aria-hidden="true"
    />
  </NavigationMenuPrimitive.Trigger>
));
NavigationMenuTrigger.displayName = NavigationMenuPrimitive.Trigger.displayName;

const NavigationMenuContent = React.forwardRef<
  React.ElementRef<typeof NavigationMenuPrimitive.Content>,
  React.ComponentPropsWithoutRef<typeof NavigationMenuPrimitive.Content>
>(({ className, ...props }, ref) => (
  <NavigationMenuPrimitive.Content
    ref={ref}
    className={cn(
      'left-0 top-0 w-full data-[motion^=from-]:animate-in data-[motion^=to-]:animate-out data-[motion^=from-]:fade-in data-[motion^=to-]:fade-out data-[motion=from-end]:slide-in-from-right-52 data-[motion=from-start]:slide-in-from-left-52 data-[motion=to-end]:slide-out-to-right-52 data-[motion=to-start]:slide-out-to-left-52 md:absolute md:w-auto ',
      className
    )}
    {...props}
  />
));
NavigationMenuContent.displayName = NavigationMenuPrimitive.Content.displayName;

const NavigationMenuLink = NavigationMenuPrimitive.Link;

const NavigationMenuViewport = React.forwardRef<
  React.ElementRef<typeof NavigationMenuPrimitive.Viewport>,
  React.ComponentPropsWithoutRef<typeof NavigationMenuPrimitive.Viewport>
>(({ className, ...props }, ref) => (
  <div className={cn('absolute left-0 top-full flex justify-center')}>
    <NavigationMenuPrimitive.Viewport
      className={cn(
        'origin-top-center relative mt-1.5 h-[var(--radix-navigation-menu-viewport-height)] w-full overflow-hidden rounded-md border bg-popover text-popover-foreground shadow-lg data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-90 md:w-[var(--radix-navigation-menu-viewport-width)]',
        className
      )}
      ref={ref}
      {...props}
    />
  </div>
));
NavigationMenuViewport.displayName =
  NavigationMenuPrimitive.Viewport.displayName;

const NavigationMenuIndicator = React.forwardRef<
  React.ElementRef<typeof NavigationMenuPrimitive.Indicator>,
  React.ComponentPropsWithoutRef<typeof NavigationMenuPrimitive.Indicator>
>(({ className, ...props }, ref) => (
  <NavigationMenuPrimitive.Indicator
    ref={ref}
    className={cn(
      'top-full z-[1] flex h-1.5 items-end justify-center overflow-hidden data-[state=visible]:animate-in data-[state=hidden]:animate-out data-[state=hidden]:fade-out data-[state=visible]:fade-in',
      className
    )}
    {...props}
  >
    <div className="relative top-[60%] h-2 w-2 rotate-45 rounded-tl-sm bg-border shadow-md" />
  </NavigationMenuPrimitive.Indicator>
));
NavigationMenuIndicator.displayName =
  NavigationMenuPrimitive.Indicator.displayName;

export {
  navigationMenuTriggerStyle,
  NavigationMenu,
  NavigationMenuList,
  NavigationMenuItem,
  NavigationMenuContent,
  NavigationMenuTrigger,
  NavigationMenuLink,
  NavigationMenuIndicator,
  NavigationMenuViewport,
};


# =================================================================
# Arquivo: .\components\ui\pagination.tsx
# =================================================================

import * as React from 'react';
import { ChevronLeft, ChevronRight, MoreHorizontal } from 'lucide-react';

import { cn } from '@/lib/utils';
import { ButtonProps, buttonVariants } from '@/components/ui/button';

const Pagination = ({ className, ...props }: React.ComponentProps<'nav'>) => (
  <nav
    role="navigation"
    aria-label="pagination"
    className={cn('mx-auto flex w-full justify-center', className)}
    {...props}
  />
);
Pagination.displayName = 'Pagination';

const PaginationContent = React.forwardRef<
  HTMLUListElement,
  React.ComponentProps<'ul'>
>(({ className, ...props }, ref) => (
  <ul
    ref={ref}
    className={cn('flex flex-row items-center gap-1', className)}
    {...props}
  />
));
PaginationContent.displayName = 'PaginationContent';

const PaginationItem = React.forwardRef<
  HTMLLIElement,
  React.ComponentProps<'li'>
>(({ className, ...props }, ref) => (
  <li ref={ref} className={cn('', className)} {...props} />
));
PaginationItem.displayName = 'PaginationItem';

type PaginationLinkProps = {
  isActive?: boolean;
} & Pick<ButtonProps, 'size'> &
  React.ComponentProps<'a'>;

const PaginationLink = ({
  className,
  isActive,
  size = 'icon',
  ...props
}: PaginationLinkProps) => (
  <a
    aria-current={isActive ? 'page' : undefined}
    className={cn(
      buttonVariants({
        variant: isActive ? 'outline' : 'ghost',
        size,
      }),
      className
    )}
    {...props}
  />
);
PaginationLink.displayName = 'PaginationLink';

const PaginationPrevious = ({
  className,
  ...props
}: React.ComponentProps<typeof PaginationLink>) => (
  <PaginationLink
    aria-label="Go to previous page"
    size="default"
    className={cn('gap-1 pl-2.5', className)}
    {...props}
  >
    <ChevronLeft className="h-4 w-4" />
    <span>Previous</span>
  </PaginationLink>
);
PaginationPrevious.displayName = 'PaginationPrevious';

const PaginationNext = ({
  className,
  ...props
}: React.ComponentProps<typeof PaginationLink>) => (
  <PaginationLink
    aria-label="Go to next page"
    size="default"
    className={cn('gap-1 pr-2.5', className)}
    {...props}
  >
    <span>Next</span>
    <ChevronRight className="h-4 w-4" />
  </PaginationLink>
);
PaginationNext.displayName = 'PaginationNext';

const PaginationEllipsis = ({
  className,
  ...props
}: React.ComponentProps<'span'>) => (
  <span
    aria-hidden
    className={cn('flex h-9 w-9 items-center justify-center', className)}
    {...props}
  >
    <MoreHorizontal className="h-4 w-4" />
    <span className="sr-only">More pages</span>
  </span>
);
PaginationEllipsis.displayName = 'PaginationEllipsis';

export {
  Pagination,
  PaginationContent,
  PaginationEllipsis,
  PaginationItem,
  PaginationLink,
  PaginationNext,
  PaginationPrevious,
};


# =================================================================
# Arquivo: .\components\ui\popover.tsx
# =================================================================

'use client';

import * as React from 'react';
import * as PopoverPrimitive from '@radix-ui/react-popover';

import { cn } from '@/lib/utils';

const Popover = PopoverPrimitive.Root;

const PopoverTrigger = PopoverPrimitive.Trigger;

const PopoverContent = React.forwardRef<
  React.ElementRef<typeof PopoverPrimitive.Content>,
  React.ComponentPropsWithoutRef<typeof PopoverPrimitive.Content>
>(({ className, align = 'center', sideOffset = 4, ...props }, ref) => (
  <PopoverPrimitive.Portal>
    <PopoverPrimitive.Content
      ref={ref}
      align={align}
      sideOffset={sideOffset}
      className={cn(
        'z-50 w-72 rounded-md border bg-popover p-4 text-popover-foreground shadow-md outline-none data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2',
        className
      )}
      {...props}
    />
  </PopoverPrimitive.Portal>
));
PopoverContent.displayName = PopoverPrimitive.Content.displayName;

export { Popover, PopoverTrigger, PopoverContent };


# =================================================================
# Arquivo: .\components\ui\progress.tsx
# =================================================================

"use client";

import * as React from "react";
import * as ProgressPrimitive from "@radix-ui/react-progress";

import { cn } from "@/lib/utils";

const Progress = React.forwardRef<
  React.ElementRef<typeof ProgressPrimitive.Root>,
  React.ComponentPropsWithoutRef<typeof ProgressPrimitive.Root>
>(({ className, value, ...props }, ref) => (
  <ProgressPrimitive.Root
    ref={ref}
    className={cn(
      "relative h-2 w-full overflow-hidden rounded-full bg-purple-950/30",
      className
    )}
    {...props}
  >
    <ProgressPrimitive.Indicator
      className="h-full w-full flex-1 bg-gradient-to-r from-purple-500 to-purple-400 transition-all"
      style={{ transform: `translateX(-${100 - (value || 0)}%)` }}
    />
  </ProgressPrimitive.Root>
));
Progress.displayName = ProgressPrimitive.Root.displayName;

export { Progress };

# =================================================================
# Arquivo: .\components\ui\radio-group.tsx
# =================================================================

'use client';

import * as React from 'react';
import * as RadioGroupPrimitive from '@radix-ui/react-radio-group';
import { Circle } from 'lucide-react';

import { cn } from '@/lib/utils';

const RadioGroup = React.forwardRef<
  React.ElementRef<typeof RadioGroupPrimitive.Root>,
  React.ComponentPropsWithoutRef<typeof RadioGroupPrimitive.Root>
>(({ className, ...props }, ref) => {
  return (
    <RadioGroupPrimitive.Root
      className={cn('grid gap-2', className)}
      {...props}
      ref={ref}
    />
  );
});
RadioGroup.displayName = RadioGroupPrimitive.Root.displayName;

const RadioGroupItem = React.forwardRef<
  React.ElementRef<typeof RadioGroupPrimitive.Item>,
  React.ComponentPropsWithoutRef<typeof RadioGroupPrimitive.Item>
>(({ className, ...props }, ref) => {
  return (
    <RadioGroupPrimitive.Item
      ref={ref}
      className={cn(
        'aspect-square h-4 w-4 rounded-full border border-primary text-primary ring-offset-background focus:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50',
        className
      )}
      {...props}
    >
      <RadioGroupPrimitive.Indicator className="flex items-center justify-center">
        <Circle className="h-2.5 w-2.5 fill-current text-current" />
      </RadioGroupPrimitive.Indicator>
    </RadioGroupPrimitive.Item>
  );
});
RadioGroupItem.displayName = RadioGroupPrimitive.Item.displayName;

export { RadioGroup, RadioGroupItem };


# =================================================================
# Arquivo: .\components\ui\resizable.tsx
# =================================================================

'use client';

import { GripVertical } from 'lucide-react';
import * as ResizablePrimitive from 'react-resizable-panels';

import { cn } from '@/lib/utils';

const ResizablePanelGroup = ({
  className,
  ...props
}: React.ComponentProps<typeof ResizablePrimitive.PanelGroup>) => (
  <ResizablePrimitive.PanelGroup
    className={cn(
      'flex h-full w-full data-[panel-group-direction=vertical]:flex-col',
      className
    )}
    {...props}
  />
);

const ResizablePanel = ResizablePrimitive.Panel;

const ResizableHandle = ({
  withHandle,
  className,
  ...props
}: React.ComponentProps<typeof ResizablePrimitive.PanelResizeHandle> & {
  withHandle?: boolean;
}) => (
  <ResizablePrimitive.PanelResizeHandle
    className={cn(
      'relative flex w-px items-center justify-center bg-border after:absolute after:inset-y-0 after:left-1/2 after:w-1 after:-translate-x-1/2 focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring focus-visible:ring-offset-1 data-[panel-group-direction=vertical]:h-px data-[panel-group-direction=vertical]:w-full data-[panel-group-direction=vertical]:after:left-0 data-[panel-group-direction=vertical]:after:h-1 data-[panel-group-direction=vertical]:after:w-full data-[panel-group-direction=vertical]:after:-translate-y-1/2 data-[panel-group-direction=vertical]:after:translate-x-0 [&[data-panel-group-direction=vertical]>div]:rotate-90',
      className
    )}
    {...props}
  >
    {withHandle && (
      <div className="z-10 flex h-4 w-3 items-center justify-center rounded-sm border bg-border">
        <GripVertical className="h-2.5 w-2.5" />
      </div>
    )}
  </ResizablePrimitive.PanelResizeHandle>
);

export { ResizablePanelGroup, ResizablePanel, ResizableHandle };


# =================================================================
# Arquivo: .\components\ui\scroll-area.tsx
# =================================================================

'use client';

import * as React from 'react';
import * as ScrollAreaPrimitive from '@radix-ui/react-scroll-area';

import { cn } from '@/lib/utils';

const ScrollArea = React.forwardRef<
  React.ElementRef<typeof ScrollAreaPrimitive.Root>,
  React.ComponentPropsWithoutRef<typeof ScrollAreaPrimitive.Root>
>(({ className, children, ...props }, ref) => (
  <ScrollAreaPrimitive.Root
    ref={ref}
    className={cn('relative overflow-hidden', className)}
    {...props}
  >
    <ScrollAreaPrimitive.Viewport className="h-full w-full rounded-[inherit]">
      {children}
    </ScrollAreaPrimitive.Viewport>
    <ScrollBar />
    <ScrollAreaPrimitive.Corner />
  </ScrollAreaPrimitive.Root>
));
ScrollArea.displayName = ScrollAreaPrimitive.Root.displayName;

const ScrollBar = React.forwardRef<
  React.ElementRef<typeof ScrollAreaPrimitive.ScrollAreaScrollbar>,
  React.ComponentPropsWithoutRef<typeof ScrollAreaPrimitive.ScrollAreaScrollbar>
>(({ className, orientation = 'vertical', ...props }, ref) => (
  <ScrollAreaPrimitive.ScrollAreaScrollbar
    ref={ref}
    orientation={orientation}
    className={cn(
      'flex touch-none select-none transition-colors',
      orientation === 'vertical' &&
        'h-full w-2.5 border-l border-l-transparent p-[1px]',
      orientation === 'horizontal' &&
        'h-2.5 flex-col border-t border-t-transparent p-[1px]',
      className
    )}
    {...props}
  >
    <ScrollAreaPrimitive.ScrollAreaThumb className="relative flex-1 rounded-full bg-border" />
  </ScrollAreaPrimitive.ScrollAreaScrollbar>
));
ScrollBar.displayName = ScrollAreaPrimitive.ScrollAreaScrollbar.displayName;

export { ScrollArea, ScrollBar };


# =================================================================
# Arquivo: .\components\ui\select.tsx
# =================================================================

'use client';

import * as React from 'react';
import * as SelectPrimitive from '@radix-ui/react-select';
import { Check, ChevronDown, ChevronUp } from 'lucide-react';

import { cn } from '@/lib/utils';

const Select = SelectPrimitive.Root;

const SelectGroup = SelectPrimitive.Group;

const SelectValue = SelectPrimitive.Value;

const SelectTrigger = React.forwardRef<
  React.ElementRef<typeof SelectPrimitive.Trigger>,
  React.ComponentPropsWithoutRef<typeof SelectPrimitive.Trigger>
>(({ className, children, ...props }, ref) => (
  <SelectPrimitive.Trigger
    ref={ref}
    className={cn(
      'flex h-10 w-full items-center justify-between rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 [&>span]:line-clamp-1',
      className
    )}
    {...props}
  >
    {children}
    <SelectPrimitive.Icon asChild>
      <ChevronDown className="h-4 w-4 opacity-50" />
    </SelectPrimitive.Icon>
  </SelectPrimitive.Trigger>
));
SelectTrigger.displayName = SelectPrimitive.Trigger.displayName;

const SelectScrollUpButton = React.forwardRef<
  React.ElementRef<typeof SelectPrimitive.ScrollUpButton>,
  React.ComponentPropsWithoutRef<typeof SelectPrimitive.ScrollUpButton>
>(({ className, ...props }, ref) => (
  <SelectPrimitive.ScrollUpButton
    ref={ref}
    className={cn(
      'flex cursor-default items-center justify-center py-1',
      className
    )}
    {...props}
  >
    <ChevronUp className="h-4 w-4" />
  </SelectPrimitive.ScrollUpButton>
));
SelectScrollUpButton.displayName = SelectPrimitive.ScrollUpButton.displayName;

const SelectScrollDownButton = React.forwardRef<
  React.ElementRef<typeof SelectPrimitive.ScrollDownButton>,
  React.ComponentPropsWithoutRef<typeof SelectPrimitive.ScrollDownButton>
>(({ className, ...props }, ref) => (
  <SelectPrimitive.ScrollDownButton
    ref={ref}
    className={cn(
      'flex cursor-default items-center justify-center py-1',
      className
    )}
    {...props}
  >
    <ChevronDown className="h-4 w-4" />
  </SelectPrimitive.ScrollDownButton>
));
SelectScrollDownButton.displayName =
  SelectPrimitive.ScrollDownButton.displayName;

const SelectContent = React.forwardRef<
  React.ElementRef<typeof SelectPrimitive.Content>,
  React.ComponentPropsWithoutRef<typeof SelectPrimitive.Content>
>(({ className, children, position = 'popper', ...props }, ref) => (
  <SelectPrimitive.Portal>
    <SelectPrimitive.Content
      ref={ref}
      className={cn(
        'relative z-50 max-h-96 min-w-[8rem] overflow-hidden rounded-md border bg-popover text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2',
        position === 'popper' &&
          'data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1',
        className
      )}
      position={position}
      {...props}
    >
      <SelectScrollUpButton />
      <SelectPrimitive.Viewport
        className={cn(
          'p-1',
          position === 'popper' &&
            'h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)]'
        )}
      >
        {children}
      </SelectPrimitive.Viewport>
      <SelectScrollDownButton />
    </SelectPrimitive.Content>
  </SelectPrimitive.Portal>
));
SelectContent.displayName = SelectPrimitive.Content.displayName;

const SelectLabel = React.forwardRef<
  React.ElementRef<typeof SelectPrimitive.Label>,
  React.ComponentPropsWithoutRef<typeof SelectPrimitive.Label>
>(({ className, ...props }, ref) => (
  <SelectPrimitive.Label
    ref={ref}
    className={cn('py-1.5 pl-8 pr-2 text-sm font-semibold', className)}
    {...props}
  />
));
SelectLabel.displayName = SelectPrimitive.Label.displayName;

const SelectItem = React.forwardRef<
  React.ElementRef<typeof SelectPrimitive.Item>,
  React.ComponentPropsWithoutRef<typeof SelectPrimitive.Item>
>(({ className, children, ...props }, ref) => (
  <SelectPrimitive.Item
    ref={ref}
    className={cn(
      'relative flex w-full cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50',
      className
    )}
    {...props}
  >
    <span className="absolute left-2 flex h-3.5 w-3.5 items-center justify-center">
      <SelectPrimitive.ItemIndicator>
        <Check className="h-4 w-4" />
      </SelectPrimitive.ItemIndicator>
    </span>

    <SelectPrimitive.ItemText>{children}</SelectPrimitive.ItemText>
  </SelectPrimitive.Item>
));
SelectItem.displayName = SelectPrimitive.Item.displayName;

const SelectSeparator = React.forwardRef<
  React.ElementRef<typeof SelectPrimitive.Separator>,
  React.ComponentPropsWithoutRef<typeof SelectPrimitive.Separator>
>(({ className, ...props }, ref) => (
  <SelectPrimitive.Separator
    ref={ref}
    className={cn('-mx-1 my-1 h-px bg-muted', className)}
    {...props}
  />
));
SelectSeparator.displayName = SelectPrimitive.Separator.displayName;

export {
  Select,
  SelectGroup,
  SelectValue,
  SelectTrigger,
  SelectContent,
  SelectLabel,
  SelectItem,
  SelectSeparator,
  SelectScrollUpButton,
  SelectScrollDownButton,
};


# =================================================================
# Arquivo: .\components\ui\separator.tsx
# =================================================================

'use client';

import * as React from 'react';
import * as SeparatorPrimitive from '@radix-ui/react-separator';

import { cn } from '@/lib/utils';

const Separator = React.forwardRef<
  React.ElementRef<typeof SeparatorPrimitive.Root>,
  React.ComponentPropsWithoutRef<typeof SeparatorPrimitive.Root>
>(
  (
    { className, orientation = 'horizontal', decorative = true, ...props },
    ref
  ) => (
    <SeparatorPrimitive.Root
      ref={ref}
      decorative={decorative}
      orientation={orientation}
      className={cn(
        'shrink-0 bg-border',
        orientation === 'horizontal' ? 'h-[1px] w-full' : 'h-full w-[1px]',
        className
      )}
      {...props}
    />
  )
);
Separator.displayName = SeparatorPrimitive.Root.displayName;

export { Separator };


# =================================================================
# Arquivo: .\components\ui\sheet.tsx
# =================================================================

'use client';

import * as React from 'react';
import * as SheetPrimitive from '@radix-ui/react-dialog';
import { cva, type VariantProps } from 'class-variance-authority';
import { X } from 'lucide-react';

import { cn } from '@/lib/utils';

const Sheet = SheetPrimitive.Root;

const SheetTrigger = SheetPrimitive.Trigger;

const SheetClose = SheetPrimitive.Close;

const SheetPortal = SheetPrimitive.Portal;

const SheetOverlay = React.forwardRef<
  React.ElementRef<typeof SheetPrimitive.Overlay>,
  React.ComponentPropsWithoutRef<typeof SheetPrimitive.Overlay>
>(({ className, ...props }, ref) => (
  <SheetPrimitive.Overlay
    className={cn(
      'fixed inset-0 z-50 bg-black/80  data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0',
      className
    )}
    {...props}
    ref={ref}
  />
));
SheetOverlay.displayName = SheetPrimitive.Overlay.displayName;

const sheetVariants = cva(
  'fixed z-50 gap-4 bg-background p-6 shadow-lg transition ease-in-out data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:duration-300 data-[state=open]:duration-500',
  {
    variants: {
      side: {
        top: 'inset-x-0 top-0 border-b data-[state=closed]:slide-out-to-top data-[state=open]:slide-in-from-top',
        bottom:
          'inset-x-0 bottom-0 border-t data-[state=closed]:slide-out-to-bottom data-[state=open]:slide-in-from-bottom',
        left: 'inset-y-0 left-0 h-full w-3/4 border-r data-[state=closed]:slide-out-to-left data-[state=open]:slide-in-from-left sm:max-w-sm',
        right:
          'inset-y-0 right-0 h-full w-3/4  border-l data-[state=closed]:slide-out-to-right data-[state=open]:slide-in-from-right sm:max-w-sm',
      },
    },
    defaultVariants: {
      side: 'right',
    },
  }
);

interface SheetContentProps
  extends React.ComponentPropsWithoutRef<typeof SheetPrimitive.Content>,
    VariantProps<typeof sheetVariants> {}

const SheetContent = React.forwardRef<
  React.ElementRef<typeof SheetPrimitive.Content>,
  SheetContentProps
>(({ side = 'right', className, children, ...props }, ref) => (
  <SheetPortal>
    <SheetOverlay />
    <SheetPrimitive.Content
      ref={ref}
      className={cn(sheetVariants({ side }), className)}
      {...props}
    >
      {children}
      <SheetPrimitive.Close className="absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-secondary">
        <X className="h-4 w-4" />
        <span className="sr-only">Close</span>
      </SheetPrimitive.Close>
    </SheetPrimitive.Content>
  </SheetPortal>
));
SheetContent.displayName = SheetPrimitive.Content.displayName;

const SheetHeader = ({
  className,
  ...props
}: React.HTMLAttributes<HTMLDivElement>) => (
  <div
    className={cn(
      'flex flex-col space-y-2 text-center sm:text-left',
      className
    )}
    {...props}
  />
);
SheetHeader.displayName = 'SheetHeader';

const SheetFooter = ({
  className,
  ...props
}: React.HTMLAttributes<HTMLDivElement>) => (
  <div
    className={cn(
      'flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2',
      className
    )}
    {...props}
  />
);
SheetFooter.displayName = 'SheetFooter';

const SheetTitle = React.forwardRef<
  React.ElementRef<typeof SheetPrimitive.Title>,
  React.ComponentPropsWithoutRef<typeof SheetPrimitive.Title>
>(({ className, ...props }, ref) => (
  <SheetPrimitive.Title
    ref={ref}
    className={cn('text-lg font-semibold text-foreground', className)}
    {...props}
  />
));
SheetTitle.displayName = SheetPrimitive.Title.displayName;

const SheetDescription = React.forwardRef<
  React.ElementRef<typeof SheetPrimitive.Description>,
  React.ComponentPropsWithoutRef<typeof SheetPrimitive.Description>
>(({ className, ...props }, ref) => (
  <SheetPrimitive.Description
    ref={ref}
    className={cn('text-sm text-muted-foreground', className)}
    {...props}
  />
));
SheetDescription.displayName = SheetPrimitive.Description.displayName;

export {
  Sheet,
  SheetPortal,
  SheetOverlay,
  SheetTrigger,
  SheetClose,
  SheetContent,
  SheetHeader,
  SheetFooter,
  SheetTitle,
  SheetDescription,
};


# =================================================================
# Arquivo: .\components\ui\skeleton.tsx
# =================================================================

import { cn } from '@/lib/utils';

function Skeleton({
  className,
  ...props
}: React.HTMLAttributes<HTMLDivElement>) {
  return (
    <div
      className={cn('animate-pulse rounded-md bg-muted', className)}
      {...props}
    />
  );
}

export { Skeleton };


# =================================================================
# Arquivo: .\components\ui\slider.tsx
# =================================================================

'use client';

import * as React from 'react';
import * as SliderPrimitive from '@radix-ui/react-slider';

import { cn } from '@/lib/utils';

const Slider = React.forwardRef<
  React.ElementRef<typeof SliderPrimitive.Root>,
  React.ComponentPropsWithoutRef<typeof SliderPrimitive.Root>
>(({ className, ...props }, ref) => (
  <SliderPrimitive.Root
    ref={ref}
    className={cn(
      'relative flex w-full touch-none select-none items-center',
      className
    )}
    {...props}
  >
    <SliderPrimitive.Track className="relative h-2 w-full grow overflow-hidden rounded-full bg-secondary">
      <SliderPrimitive.Range className="absolute h-full bg-primary" />
    </SliderPrimitive.Track>
    <SliderPrimitive.Thumb className="block h-5 w-5 rounded-full border-2 border-primary bg-background ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50" />
  </SliderPrimitive.Root>
));
Slider.displayName = SliderPrimitive.Root.displayName;

export { Slider };


# =================================================================
# Arquivo: .\components\ui\sonner.tsx
# =================================================================

'use client';

import { useTheme } from 'next-themes';
import { Toaster as Sonner } from 'sonner';

type ToasterProps = React.ComponentProps<typeof Sonner>;

const Toaster = ({ ...props }: ToasterProps) => {
  const { theme = 'system' } = useTheme();

  return (
    <Sonner
      theme={theme as ToasterProps['theme']}
      className="toaster group"
      toastOptions={{
        classNames: {
          toast:
            'group toast group-[.toaster]:bg-background group-[.toaster]:text-foreground group-[.toaster]:border-border group-[.toaster]:shadow-lg',
          description: 'group-[.toast]:text-muted-foreground',
          actionButton:
            'group-[.toast]:bg-primary group-[.toast]:text-primary-foreground',
          cancelButton:
            'group-[.toast]:bg-muted group-[.toast]:text-muted-foreground',
        },
      }}
      {...props}
    />
  );
};

export { Toaster };


# =================================================================
# Arquivo: .\components\ui\switch.tsx
# =================================================================

'use client';

import * as React from 'react';
import * as SwitchPrimitives from '@radix-ui/react-switch';

import { cn } from '@/lib/utils';

const Switch = React.forwardRef<
  React.ElementRef<typeof SwitchPrimitives.Root>,
  React.ComponentPropsWithoutRef<typeof SwitchPrimitives.Root>
>(({ className, ...props }, ref) => (
  <SwitchPrimitives.Root
    className={cn(
      'peer inline-flex h-6 w-11 shrink-0 cursor-pointer items-center rounded-full border-2 border-transparent transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 focus-visible:ring-offset-background disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=unchecked]:bg-input',
      className
    )}
    {...props}
    ref={ref}
  >
    <SwitchPrimitives.Thumb
      className={cn(
        'pointer-events-none block h-5 w-5 rounded-full bg-background shadow-lg ring-0 transition-transform data-[state=checked]:translate-x-5 data-[state=unchecked]:translate-x-0'
      )}
    />
  </SwitchPrimitives.Root>
));
Switch.displayName = SwitchPrimitives.Root.displayName;

export { Switch };


# =================================================================
# Arquivo: .\components\ui\table.tsx
# =================================================================

import * as React from 'react';

import { cn } from '@/lib/utils';

const Table = React.forwardRef<
  HTMLTableElement,
  React.HTMLAttributes<HTMLTableElement>
>(({ className, ...props }, ref) => (
  <div className="relative w-full overflow-auto">
    <table
      ref={ref}
      className={cn('w-full caption-bottom text-sm', className)}
      {...props}
    />
  </div>
));
Table.displayName = 'Table';

const TableHeader = React.forwardRef<
  HTMLTableSectionElement,
  React.HTMLAttributes<HTMLTableSectionElement>
>(({ className, ...props }, ref) => (
  <thead ref={ref} className={cn('[&_tr]:border-b', className)} {...props} />
));
TableHeader.displayName = 'TableHeader';

const TableBody = React.forwardRef<
  HTMLTableSectionElement,
  React.HTMLAttributes<HTMLTableSectionElement>
>(({ className, ...props }, ref) => (
  <tbody
    ref={ref}
    className={cn('[&_tr:last-child]:border-0', className)}
    {...props}
  />
));
TableBody.displayName = 'TableBody';

const TableFooter = React.forwardRef<
  HTMLTableSectionElement,
  React.HTMLAttributes<HTMLTableSectionElement>
>(({ className, ...props }, ref) => (
  <tfoot
    ref={ref}
    className={cn(
      'border-t bg-muted/50 font-medium [&>tr]:last:border-b-0',
      className
    )}
    {...props}
  />
));
TableFooter.displayName = 'TableFooter';

const TableRow = React.forwardRef<
  HTMLTableRowElement,
  React.HTMLAttributes<HTMLTableRowElement>
>(({ className, ...props }, ref) => (
  <tr
    ref={ref}
    className={cn(
      'border-b transition-colors hover:bg-muted/50 data-[state=selected]:bg-muted',
      className
    )}
    {...props}
  />
));
TableRow.displayName = 'TableRow';

const TableHead = React.forwardRef<
  HTMLTableCellElement,
  React.ThHTMLAttributes<HTMLTableCellElement>
>(({ className, ...props }, ref) => (
  <th
    ref={ref}
    className={cn(
      'h-12 px-4 text-left align-middle font-medium text-muted-foreground [&:has([role=checkbox])]:pr-0',
      className
    )}
    {...props}
  />
));
TableHead.displayName = 'TableHead';

const TableCell = React.forwardRef<
  HTMLTableCellElement,
  React.TdHTMLAttributes<HTMLTableCellElement>
>(({ className, ...props }, ref) => (
  <td
    ref={ref}
    className={cn('p-4 align-middle [&:has([role=checkbox])]:pr-0', className)}
    {...props}
  />
));
TableCell.displayName = 'TableCell';

const TableCaption = React.forwardRef<
  HTMLTableCaptionElement,
  React.HTMLAttributes<HTMLTableCaptionElement>
>(({ className, ...props }, ref) => (
  <caption
    ref={ref}
    className={cn('mt-4 text-sm text-muted-foreground', className)}
    {...props}
  />
));
TableCaption.displayName = 'TableCaption';

export {
  Table,
  TableHeader,
  TableBody,
  TableFooter,
  TableHead,
  TableRow,
  TableCell,
  TableCaption,
};


# =================================================================
# Arquivo: .\components\ui\tabs.tsx
# =================================================================

'use client';

import * as React from 'react';
import * as TabsPrimitive from '@radix-ui/react-tabs';

import { cn } from '@/lib/utils';

const Tabs = TabsPrimitive.Root;

const TabsList = React.forwardRef<
  React.ElementRef<typeof TabsPrimitive.List>,
  React.ComponentPropsWithoutRef<typeof TabsPrimitive.List>
>(({ className, ...props }, ref) => (
  <TabsPrimitive.List
    ref={ref}
    className={cn(
      'inline-flex h-10 items-center justify-center rounded-md bg-muted p-1 text-muted-foreground',
      className
    )}
    {...props}
  />
));
TabsList.displayName = TabsPrimitive.List.displayName;

const TabsTrigger = React.forwardRef<
  React.ElementRef<typeof TabsPrimitive.Trigger>,
  React.ComponentPropsWithoutRef<typeof TabsPrimitive.Trigger>
>(({ className, ...props }, ref) => (
  <TabsPrimitive.Trigger
    ref={ref}
    className={cn(
      'inline-flex items-center justify-center whitespace-nowrap rounded-sm px-3 py-1.5 text-sm font-medium ring-offset-background transition-all focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 data-[state=active]:bg-background data-[state=active]:text-foreground data-[state=active]:shadow-sm',
      className
    )}
    {...props}
  />
));
TabsTrigger.displayName = TabsPrimitive.Trigger.displayName;

const TabsContent = React.forwardRef<
  React.ElementRef<typeof TabsPrimitive.Content>,
  React.ComponentPropsWithoutRef<typeof TabsPrimitive.Content>
>(({ className, ...props }, ref) => (
  <TabsPrimitive.Content
    ref={ref}
    className={cn(
      'mt-2 ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2',
      className
    )}
    {...props}
  />
));
TabsContent.displayName = TabsPrimitive.Content.displayName;

export { Tabs, TabsList, TabsTrigger, TabsContent };


# =================================================================
# Arquivo: .\components\ui\textarea.tsx
# =================================================================

import * as React from 'react';

import { cn } from '@/lib/utils';

export interface TextareaProps
  extends React.TextareaHTMLAttributes<HTMLTextAreaElement> {}

const Textarea = React.forwardRef<HTMLTextAreaElement, TextareaProps>(
  ({ className, ...props }, ref) => {
    return (
      <textarea
        className={cn(
          'flex min-h-[80px] w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50',
          className
        )}
        ref={ref}
        {...props}
      />
    );
  }
);
Textarea.displayName = 'Textarea';

export { Textarea };


# =================================================================
# Arquivo: .\components\ui\toast.tsx
# =================================================================

'use client';

import * as React from 'react';
import * as ToastPrimitives from '@radix-ui/react-toast';
import { cva, type VariantProps } from 'class-variance-authority';
import { X } from 'lucide-react';

import { cn } from '@/lib/utils';

const ToastProvider = ToastPrimitives.Provider;

const ToastViewport = React.forwardRef<
  React.ElementRef<typeof ToastPrimitives.Viewport>,
  React.ComponentPropsWithoutRef<typeof ToastPrimitives.Viewport>
>(({ className, ...props }, ref) => (
  <ToastPrimitives.Viewport
    ref={ref}
    className={cn(
      'fixed top-0 z-[100] flex max-h-screen w-full flex-col-reverse p-4 sm:bottom-0 sm:right-0 sm:top-auto sm:flex-col md:max-w-[420px]',
      className
    )}
    {...props}
  />
));
ToastViewport.displayName = ToastPrimitives.Viewport.displayName;

const toastVariants = cva(
  'group pointer-events-auto relative flex w-full items-center justify-between space-x-4 overflow-hidden rounded-md border p-6 pr-8 shadow-lg transition-all data-[swipe=cancel]:translate-x-0 data-[swipe=end]:translate-x-[var(--radix-toast-swipe-end-x)] data-[swipe=move]:translate-x-[var(--radix-toast-swipe-move-x)] data-[swipe=move]:transition-none data-[state=open]:animate-in data-[state=closed]:animate-out data-[swipe=end]:animate-out data-[state=closed]:fade-out-80 data-[state=closed]:slide-out-to-right-full data-[state=open]:slide-in-from-top-full data-[state=open]:sm:slide-in-from-bottom-full',
  {
    variants: {
      variant: {
        default: 'border bg-background text-foreground',
        destructive:
          'destructive group border-destructive bg-destructive text-destructive-foreground',
      },
    },
    defaultVariants: {
      variant: 'default',
    },
  }
);

const Toast = React.forwardRef<
  React.ElementRef<typeof ToastPrimitives.Root>,
  React.ComponentPropsWithoutRef<typeof ToastPrimitives.Root> &
    VariantProps<typeof toastVariants>
>(({ className, variant, ...props }, ref) => {
  return (
    <ToastPrimitives.Root
      ref={ref}
      className={cn(toastVariants({ variant }), className)}
      {...props}
    />
  );
});
Toast.displayName = ToastPrimitives.Root.displayName;

const ToastAction = React.forwardRef<
  React.ElementRef<typeof ToastPrimitives.Action>,
  React.ComponentPropsWithoutRef<typeof ToastPrimitives.Action>
>(({ className, ...props }, ref) => (
  <ToastPrimitives.Action
    ref={ref}
    className={cn(
      'inline-flex h-8 shrink-0 items-center justify-center rounded-md border bg-transparent px-3 text-sm font-medium ring-offset-background transition-colors hover:bg-secondary focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 group-[.destructive]:border-muted/40 group-[.destructive]:hover:border-destructive/30 group-[.destructive]:hover:bg-destructive group-[.destructive]:hover:text-destructive-foreground group-[.destructive]:focus:ring-destructive',
      className
    )}
    {...props}
  />
));
ToastAction.displayName = ToastPrimitives.Action.displayName;

const ToastClose = React.forwardRef<
  React.ElementRef<typeof ToastPrimitives.Close>,
  React.ComponentPropsWithoutRef<typeof ToastPrimitives.Close>
>(({ className, ...props }, ref) => (
  <ToastPrimitives.Close
    ref={ref}
    className={cn(
      'absolute right-2 top-2 rounded-md p-1 text-foreground/50 opacity-0 transition-opacity hover:text-foreground focus:opacity-100 focus:outline-none focus:ring-2 group-hover:opacity-100 group-[.destructive]:text-red-300 group-[.destructive]:hover:text-red-50 group-[.destructive]:focus:ring-red-400 group-[.destructive]:focus:ring-offset-red-600',
      className
    )}
    toast-close=""
    {...props}
  >
    <X className="h-4 w-4" />
  </ToastPrimitives.Close>
));
ToastClose.displayName = ToastPrimitives.Close.displayName;

const ToastTitle = React.forwardRef<
  React.ElementRef<typeof ToastPrimitives.Title>,
  React.ComponentPropsWithoutRef<typeof ToastPrimitives.Title>
>(({ className, ...props }, ref) => (
  <ToastPrimitives.Title
    ref={ref}
    className={cn('text-sm font-semibold', className)}
    {...props}
  />
));
ToastTitle.displayName = ToastPrimitives.Title.displayName;

const ToastDescription = React.forwardRef<
  React.ElementRef<typeof ToastPrimitives.Description>,
  React.ComponentPropsWithoutRef<typeof ToastPrimitives.Description>
>(({ className, ...props }, ref) => (
  <ToastPrimitives.Description
    ref={ref}
    className={cn('text-sm opacity-90', className)}
    {...props}
  />
));
ToastDescription.displayName = ToastPrimitives.Description.displayName;

type ToastProps = React.ComponentPropsWithoutRef<typeof Toast>;

type ToastActionElement = React.ReactElement<typeof ToastAction>;

export {
  type ToastProps,
  type ToastActionElement,
  ToastProvider,
  ToastViewport,
  Toast,
  ToastTitle,
  ToastDescription,
  ToastClose,
  ToastAction,
};


# =================================================================
# Arquivo: .\components\ui\toaster.tsx
# =================================================================

'use client';

import { useToast } from '@/hooks/use-toast';
import {
  Toast,
  ToastClose,
  ToastDescription,
  ToastProvider,
  ToastTitle,
  ToastViewport,
} from '@/components/ui/toast';

export function Toaster() {
  const { toasts } = useToast();

  return (
    <ToastProvider>
      {toasts.map(function ({ id, title, description, action, ...props }) {
        return (
          <Toast key={id} {...props}>
            <div className="grid gap-1">
              {title && <ToastTitle>{title}</ToastTitle>}
              {description && (
                <ToastDescription>{description}</ToastDescription>
              )}
            </div>
            {action}
            <ToastClose />
          </Toast>
        );
      })}
      <ToastViewport />
    </ToastProvider>
  );
}


# =================================================================
# Arquivo: .\components\ui\toggle-group.tsx
# =================================================================

'use client';

import * as React from 'react';
import * as ToggleGroupPrimitive from '@radix-ui/react-toggle-group';
import { type VariantProps } from 'class-variance-authority';

import { cn } from '@/lib/utils';
import { toggleVariants } from '@/components/ui/toggle';

const ToggleGroupContext = React.createContext<
  VariantProps<typeof toggleVariants>
>({
  size: 'default',
  variant: 'default',
});

const ToggleGroup = React.forwardRef<
  React.ElementRef<typeof ToggleGroupPrimitive.Root>,
  React.ComponentPropsWithoutRef<typeof ToggleGroupPrimitive.Root> &
    VariantProps<typeof toggleVariants>
>(({ className, variant, size, children, ...props }, ref) => (
  <ToggleGroupPrimitive.Root
    ref={ref}
    className={cn('flex items-center justify-center gap-1', className)}
    {...props}
  >
    <ToggleGroupContext.Provider value={{ variant, size }}>
      {children}
    </ToggleGroupContext.Provider>
  </ToggleGroupPrimitive.Root>
));

ToggleGroup.displayName = ToggleGroupPrimitive.Root.displayName;

const ToggleGroupItem = React.forwardRef<
  React.ElementRef<typeof ToggleGroupPrimitive.Item>,
  React.ComponentPropsWithoutRef<typeof ToggleGroupPrimitive.Item> &
    VariantProps<typeof toggleVariants>
>(({ className, children, variant, size, ...props }, ref) => {
  const context = React.useContext(ToggleGroupContext);

  return (
    <ToggleGroupPrimitive.Item
      ref={ref}
      className={cn(
        toggleVariants({
          variant: context.variant || variant,
          size: context.size || size,
        }),
        className
      )}
      {...props}
    >
      {children}
    </ToggleGroupPrimitive.Item>
  );
});

ToggleGroupItem.displayName = ToggleGroupPrimitive.Item.displayName;

export { ToggleGroup, ToggleGroupItem };


# =================================================================
# Arquivo: .\components\ui\toggle.tsx
# =================================================================

'use client';

import * as React from 'react';
import * as TogglePrimitive from '@radix-ui/react-toggle';
import { cva, type VariantProps } from 'class-variance-authority';

import { cn } from '@/lib/utils';

const toggleVariants = cva(
  'inline-flex items-center justify-center rounded-md text-sm font-medium ring-offset-background transition-colors hover:bg-muted hover:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 data-[state=on]:bg-accent data-[state=on]:text-accent-foreground',
  {
    variants: {
      variant: {
        default: 'bg-transparent',
        outline:
          'border border-input bg-transparent hover:bg-accent hover:text-accent-foreground',
      },
      size: {
        default: 'h-10 px-3',
        sm: 'h-9 px-2.5',
        lg: 'h-11 px-5',
      },
    },
    defaultVariants: {
      variant: 'default',
      size: 'default',
    },
  }
);

const Toggle = React.forwardRef<
  React.ElementRef<typeof TogglePrimitive.Root>,
  React.ComponentPropsWithoutRef<typeof TogglePrimitive.Root> &
    VariantProps<typeof toggleVariants>
>(({ className, variant, size, ...props }, ref) => (
  <TogglePrimitive.Root
    ref={ref}
    className={cn(toggleVariants({ variant, size, className }))}
    {...props}
  />
));

Toggle.displayName = TogglePrimitive.Root.displayName;

export { Toggle, toggleVariants };


# =================================================================
# Arquivo: .\components\ui\tooltip.tsx
# =================================================================

'use client';

import * as React from 'react';
import * as TooltipPrimitive from '@radix-ui/react-tooltip';

import { cn } from '@/lib/utils';

const TooltipProvider = TooltipPrimitive.Provider;

const Tooltip = TooltipPrimitive.Root;

const TooltipTrigger = TooltipPrimitive.Trigger;

const TooltipContent = React.forwardRef<
  React.ElementRef<typeof TooltipPrimitive.Content>,
  React.ComponentPropsWithoutRef<typeof TooltipPrimitive.Content>
>(({ className, sideOffset = 4, ...props }, ref) => (
  <TooltipPrimitive.Content
    ref={ref}
    sideOffset={sideOffset}
    className={cn(
      'z-50 overflow-hidden rounded-md border bg-popover px-3 py-1.5 text-sm text-popover-foreground shadow-md animate-in fade-in-0 zoom-in-95 data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=closed]:zoom-out-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2',
      className
    )}
    {...props}
  />
));
TooltipContent.displayName = TooltipPrimitive.Content.displayName;

export { Tooltip, TooltipTrigger, TooltipContent, TooltipProvider };


# =================================================================
# Arquivo: .\hooks\use-chat-widget.ts
# =================================================================

"use client";

import { create } from 'zustand';

interface ChatWidgetState {
  isOpen: boolean;
  onOpen: () => void;
  onClose: () => void;
  toggle: () => void;
}

// Usando Zustand para um gerenciamento de estado global, limpo e eficiente.
// Se voc√™ ainda n√£o instalou: npm install zustand
export const useChatWidget = create<ChatWidgetState>((set) => ({
  isOpen: false,
  onOpen: () => set({ isOpen: true }),
  onClose: () => set({ isOpen: false }),
  toggle: () => set((state) => ({ isOpen: !state.isOpen })),
}));

# =================================================================
# Arquivo: .\hooks\use-dream-store.ts
# =================================================================

// ARQUIVO FINAL E CORRIGIDO: hooks/use-dream-store.ts

"use client";

import { create } from 'zustand';

export type Dream = {
  id: string;
  user_id: string;
  created_at: string;
  title: string | null;
  content: string;
  mood: string | null;
  tags: string[] | null;
  interpretation: any | null;
};

interface DreamStoreState {
  dreams: Dream[];
  isLoading: boolean;
  fetchDreams: () => Promise<void>;
  addDream: (newDream: Dream) => void;
}

export const useDreamStore = create<DreamStoreState>((set, get) => ({ // Adicionado `get` aqui
  dreams: [],
  isLoading: true, // Come√ßa como true, o que est√° correto para o primeiro carregamento
  
  fetchDreams: async () => {
    // ====================== A MUDAN√áA CR√çTICA EST√Å AQUI ======================
    // 1. Verificamos se j√° temos sonhos no estado.
    if (get().dreams.length > 0) {
      // Se j√° tivermos, garantimos que `isLoading` seja falso e paramos a execu√ß√£o.
      // N√£o h√° necessidade de buscar novamente.
      set({ isLoading: false });
      return; 
    }
    // =========================================================================

    // 2. Se n√£o houver sonhos, o c√≥digo continua como antes, fazendo o fetch inicial.
    try {
      set({ isLoading: true });
      const response = await fetch('/api/journal');
      if (!response.ok) throw new Error('Failed to fetch dreams');
      const data = await response.json();
      set({ dreams: data, isLoading: false });
    } catch (error) {
      console.error("Error fetching dreams:", error);
      set({ dreams: [], isLoading: false });
    }
  },
  
  addDream: (newDream) => {
    set((state) => ({
      dreams: [newDream, ...state.dreams]
    }));
  },
}));

# =================================================================
# Arquivo: .\hooks\use-toast.ts
# =================================================================

'use client';

// Inspired by react-hot-toast library
import * as React from 'react';

import type { ToastActionElement, ToastProps } from '@/components/ui/toast';

const TOAST_LIMIT = 1;
const TOAST_REMOVE_DELAY = 1000000;

type ToasterToast = ToastProps & {
  id: string;
  title?: React.ReactNode;
  description?: React.ReactNode;
  action?: ToastActionElement;
};

const actionTypes = {
  ADD_TOAST: 'ADD_TOAST',
  UPDATE_TOAST: 'UPDATE_TOAST',
  DISMISS_TOAST: 'DISMISS_TOAST',
  REMOVE_TOAST: 'REMOVE_TOAST',
} as const;

let count = 0;

function genId() {
  count = (count + 1) % Number.MAX_SAFE_INTEGER;
  return count.toString();
}

type ActionType = typeof actionTypes;

type Action =
  | {
      type: ActionType['ADD_TOAST'];
      toast: ToasterToast;
    }
  | {
      type: ActionType['UPDATE_TOAST'];
      toast: Partial<ToasterToast>;
    }
  | {
      type: ActionType['DISMISS_TOAST'];
      toastId?: ToasterToast['id'];
    }
  | {
      type: ActionType['REMOVE_TOAST'];
      toastId?: ToasterToast['id'];
    };

interface State {
  toasts: ToasterToast[];
}

const toastTimeouts = new Map<string, ReturnType<typeof setTimeout>>();

const addToRemoveQueue = (toastId: string) => {
  if (toastTimeouts.has(toastId)) {
    return;
  }

  const timeout = setTimeout(() => {
    toastTimeouts.delete(toastId);
    dispatch({
      type: 'REMOVE_TOAST',
      toastId: toastId,
    });
  }, TOAST_REMOVE_DELAY);

  toastTimeouts.set(toastId, timeout);
};

export const reducer = (state: State, action: Action): State => {
  switch (action.type) {
    case 'ADD_TOAST':
      return {
        ...state,
        toasts: [action.toast, ...state.toasts].slice(0, TOAST_LIMIT),
      };

    case 'UPDATE_TOAST':
      return {
        ...state,
        toasts: state.toasts.map((t) =>
          t.id === action.toast.id ? { ...t, ...action.toast } : t
        ),
      };

    case 'DISMISS_TOAST': {
      const { toastId } = action;

      // ! Side effects ! - This could be extracted into a dismissToast() action,
      // but I'll keep it here for simplicity
      if (toastId) {
        addToRemoveQueue(toastId);
      } else {
        state.toasts.forEach((toast) => {
          addToRemoveQueue(toast.id);
        });
      }

      return {
        ...state,
        toasts: state.toasts.map((t) =>
          t.id === toastId || toastId === undefined
            ? {
                ...t,
                open: false,
              }
            : t
        ),
      };
    }
    case 'REMOVE_TOAST':
      if (action.toastId === undefined) {
        return {
          ...state,
          toasts: [],
        };
      }
      return {
        ...state,
        toasts: state.toasts.filter((t) => t.id !== action.toastId),
      };
  }
};

const listeners: Array<(state: State) => void> = [];

let memoryState: State = { toasts: [] };

function dispatch(action: Action) {
  memoryState = reducer(memoryState, action);
  listeners.forEach((listener) => {
    listener(memoryState);
  });
}

type Toast = Omit<ToasterToast, 'id'>;

function toast({ ...props }: Toast) {
  const id = genId();

  const update = (props: ToasterToast) =>
    dispatch({
      type: 'UPDATE_TOAST',
      toast: { ...props, id },
    });
  const dismiss = () => dispatch({ type: 'DISMISS_TOAST', toastId: id });

  dispatch({
    type: 'ADD_TOAST',
    toast: {
      ...props,
      id,
      open: true,
      onOpenChange: (open) => {
        if (!open) dismiss();
      },
    },
  });

  return {
    id: id,
    dismiss,
    update,
  };
}

function useToast() {
  const [state, setState] = React.useState<State>(memoryState);

  React.useEffect(() => {
    listeners.push(setState);
    return () => {
      const index = listeners.indexOf(setState);
      if (index > -1) {
        listeners.splice(index, 1);
      }
    };
  }, [state]);

  return {
    ...state,
    toast,
    dismiss: (toastId?: string) => dispatch({ type: 'DISMISS_TOAST', toastId }),
  };
}

export { useToast, toast };


# =================================================================
# Arquivo: .\hooks\use-user-stats.ts
# =================================================================

"use client";

import { useState, useEffect } from 'react';
import { useAuth } from '@/components/auth-provider';

export function useUserStats() {
  const { user } = useAuth();
  const [stats, setStats] = useState({
    lunarPhase: 'Waxing Crescent',
    streak: 3,
    analysisCredits: 5
  });

  useEffect(() => {
    // TODO: Fetch real stats from API
    if (user) {
      // For now using placeholder data
      setStats({
        lunarPhase: 'Waxing Crescent',
        streak: 3,
        analysisCredits: 5
      });
    }
  }, [user]);

  return stats;
}

# =================================================================
# Arquivo: .\lib\auth.ts
# =================================================================

import { supabase } from './supabase/client';

const isMockSupabase =
  !process.env.NEXT_PUBLIC_SUPABASE_URL ||
  !process.env.NEXT_PUBLIC_SUPABASE_ANON_KEY;

// Mock auth responses for development
const mockAuthResponse = {
  data: { user: { id: '123', email: 'test@example.com', user_metadata: { name: 'Test User' } } },
  error: null
};

export async function resetPassword(email: string) {
  if (isMockSupabase) {
    return mockAuthResponse;
  }
  return supabase.auth.resetPasswordForEmail(email, {
    redirectTo: `${window.location.origin}/reset-password`,
  });
}

export async function signIn(email: string, password: string) {
  if (isMockSupabase) {
    return mockAuthResponse;
  }
  return supabase.auth.signInWithPassword({ email, password });
}

export async function signUp(email: string, password: string, name: string) {
  if (isMockSupabase) {
    return mockAuthResponse;
  }
  return supabase.auth.signUp({
    email,
    password,
    options: {
      data: { name }
    }
  });
}

export async function signOut() {
  if (isMockSupabase) {
    return { error: null };
  }
  return supabase.auth.signOut();
}


# =================================================================
# Arquivo: .\lib\database.types.ts
# =================================================================

export type Json =
  | string
  | number
  | boolean
  | null
  | { [key: string]: Json | undefined }
  | Json[]

export interface Database {
  public: {
    Tables: {
      profiles: {
        Row: {
          id: string
          created_at: string
          name: string
          credits: number
          email: string
        }
        Insert: {
          id: string
          created_at?: string
          name: string
          credits?: number
          email: string
        }
        Update: {
          id?: string
          created_at?: string
          name?: string
          credits?: number
          email?: string
        }
      }
      dream_analyses: {
        Row: {
          id: string
          created_at: string
          user_id: string
          dream_content: string
          analysis: string
        }
        Insert: {
          id?: string
          created_at?: string
          user_id: string
          dream_content: string
          analysis: string
        }
        Update: {
          id?: string
          created_at?: string
          user_id?: string
          dream_content?: string
          analysis?: string
        }
      }
    }
  }
}

# =================================================================
# Arquivo: .\lib\db-queries.ts
# =================================================================

import { supabase } from './supabase/client';

const isMockSupabase =
  !process.env.NEXT_PUBLIC_SUPABASE_URL ||
  !process.env.NEXT_PUBLIC_SUPABASE_ANON_KEY;

// Mock data for development
const mockProfile = {
  id: '123',
  name: 'Test User',
  email: 'test@example.com',
  credits: 5
};

const mockDreamAnalyses = [
  {
    id: '1',
    created_at: new Date().toISOString(),
    user_id: '123',
    dream_content: 'Test dream content',
    analysis: 'Test analysis'
  }
];

export async function createProfile(userId: string, name: string, email: string) {
  if (isMockSupabase) {
    return { data: mockProfile, error: null };
  }

  const { error } = await supabase
    .from('profiles')
    .insert({
      id: userId,
      name,
      email,
      credits: 5
    });
  
  if (error) throw error;
}

export async function getProfile(userId: string) {
  if (isMockSupabase) {
    return { data: mockProfile, error: null };
  }

  const { data, error } = await supabase
    .from('profiles')
    .select('*')
    .eq('id', userId)
    .single();
  
  if (error) throw error;
  return data;
}

export async function getDreamAnalyses(userId: string) {
  if (isMockSupabase) {
    return { data: mockDreamAnalyses, error: null };
  }

  const { data, error } = await supabase
    .from('dream_analyses')
    .select('*')
    .eq('user_id', userId)
    .order('created_at', { ascending: false });
  
  if (error) throw error;
  return data;
}

export async function createDreamAnalysis(userId: string, dreamContent: string, analysis: string) {
  if (isMockSupabase) {
    return { data: mockDreamAnalyses[0], error: null };
  }

  const { error } = await supabase
    .from('dream_analyses')
    .insert({
      user_id: userId,
      dream_content: dreamContent,
      analysis: analysis
    });
  
  if (error) throw error;
}

export async function updateCredits(userId: string, credits: number) {
  if (isMockSupabase) {
    return { data: { ...mockProfile, credits }, error: null };
  }

  const { error } = await supabase
    .from('profiles')
    .update({ credits })
    .eq('id', userId);
  
  if (error) throw error;
}


# =================================================================
# Arquivo: .\lib\index.ts
# =================================================================

export * from './services/auth-service';
export * from './services/profile-service';
export * from './services/dream-service';
export * from './config/supabase';

# =================================================================
# Arquivo: .\lib\utils.ts
# =================================================================

import { clsx, type ClassValue } from 'clsx';
import { twMerge } from 'tailwind-merge';

export function cn(...inputs: ClassValue[]) {
  return twMerge(clsx(inputs));
}


# =================================================================
# Arquivo: .\lib\config\constants.ts
# =================================================================

export const DEVELOPMENT_CONFIG = {
  supabaseUrl: 'https://mock-project-id.supabase.co',
  supabaseKey: 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.mock-key'
} as const;

# =================================================================
# Arquivo: .\lib\services\ai-services.ts
# =================================================================

// ARQUIVO FINAL E ATUALIZADO: lib/services/ai.service.ts

const OPENROUTER_API_KEY = process.env.OPENROUTER_API_KEY;

// Definimos a estrutura da resposta que esperamos da IA
export type DreamAnalysisResult = {
  isDream: false;
} | {
  isDream: true;
  title: string;
  mood: 'neutral' | 'happy' | 'sad' | 'anxious' | 'exciting' | 'fearful' | 'confused';
  tags: string[];
};

/**
 * Analisa um texto de entrada para determinar se √© um sonho e, em caso afirmativo,
 * extrai t√≠tulo, humor e tags.
 * @param userInput O texto digitado pelo usu√°rio.
 * @returns Um objeto com a an√°lise completa do sonho ou indicando que n√£o √© um sonho.
 */
export async function analyzeDreamInput(userInput: string): Promise<DreamAnalysisResult> {
  if (!OPENROUTER_API_KEY) {
    console.error("[AI Service] OpenRouter API Key n√£o est√° configurada.");
    return { isDream: false };
  }

  if (userInput.trim() === '') {
    return { isDream: false };
  }
  
  console.log(`[AI Service] Sending input to LLM for full analysis: "${userInput}"`);

  try {
    const response = await fetch("https://openrouter.ai/api/v1/chat/completions", {
      method: "POST",
      headers: {
        "Authorization": `Bearer ${OPENROUTER_API_KEY}`,
        "Content-Type": "application/json"
      },
      body: JSON.stringify({
        model: "google/gemini-2.5-flash-preview-09-2025", 
        messages: [
          {
            role: "system",
            // ====================== PROMPT ATUALIZADO ======================
            content: `Voc√™ √© um assistente de an√°lise de sonhos para o aplicativo Bloomed Dreams. Sua fun√ß√£o √© analisar a mensagem do usu√°rio e retornar um objeto JSON.

Regras:
1.  Primeiro, determine se a mensagem √© uma descri√ß√£o de um sonho.
2.  Se N√ÉO for um sonho (ex: um cumprimento, uma pergunta), retorne: \`{"isDream": false}\`.
3.  Se FOR um sonho, retorne um JSON com a seguinte estrutura:
    - "isDream": true
    - "title": Um t√≠tulo po√©tico e curto (3 a 7 palavras) para o sonho.
    - "mood": O sentimento principal do sonho. Escolha UMA das seguintes op√ß√µes: 'neutral', 'happy', 'sad', 'anxious', 'exciting', 'fearful', 'confused'.
    - "tags": Um array com 3 a 5 tags (palavras-chave √∫nicas, em min√∫sculas) que resumem os elementos principais do sonho.

Exemplo de Sonho: "sonhei que estava voando sobre uma cidade de cristal e me sentia livre"
Sua Resposta: \`{"isDream": true, "title": "Voo sobre a Cidade de Cristal", "mood": "happy", "tags": ["voar", "cidade", "cristal", "liberdade"]}\`

Exemplo de N√£o-Sonho: "oi tudo bem"
Sua Resposta: \`{"isDream": false}\``
            // =================================================================
          },
          {
            role: "user",
            content: userInput
          }
        ],
        response_format: { "type": "json_object" }, 
        temperature: 0.2, // Um pouco de criatividade para o t√≠tulo
      })
    });

    if (!response.ok) {
      console.error(`[AI Service] Erro na chamada ao OpenRouter: ${response.status} ${response.statusText}`);
      return { isDream: false };
    }

    const data = await response.json();
    const rawContent = data.choices[0].message.content;
    console.log(`[AI Service] Raw output from LLM: ${rawContent}`);

    try {
      const jsonString = rawContent.replace(/```json\n/g, '').replace(/```/g, '');
      const parsedJson = JSON.parse(jsonString);

      // Se for um sonho, retorne a estrutura completa. Caso contr√°rio, a simples.
      if (parsedJson.isDream === true) {
        return {
          isDream: true,
          title: parsedJson.title || "Untitled Dream",
          mood: parsedJson.mood || "neutral",
          tags: parsedJson.tags || []
        };
      } else {
        return { isDream: false };
      }
    } catch (e) {
      console.error("[AI Service] Failed to parse JSON from LLM.", e);
      return { isDream: false };
    }
    
  } catch (error) {
    console.error("[AI Service] Erro de rede ao tentar analisar a mensagem:", error);
    return { isDream: false };
  }
}

# =================================================================
# Arquivo: .\lib\supabase\client.ts
# =================================================================

// Em: lib/supabase/client.ts
import { createClientComponentClient } from '@supabase/auth-helpers-nextjs'
import type { Database } from '../types/database.types' // Ajuste o caminho se necess√°rio

// Crie e exporte uma √∫nica inst√¢ncia do cliente Supabase para ser usada em todo o lado do cliente.
// Isso resolve o aviso "Multiple GoTrueClient instances".
export const supabase = createClientComponentClient<Database>()

# =================================================================
# Arquivo: .\lib\types\database.types.ts
# =================================================================

export type Json =
  | string
  | number
  | boolean
  | null
  | { [key: string]: Json | undefined }
  | Json[]

export interface Database {
  public: {
    Tables: {
      profiles: {
        Row: {
          id: string
          created_at: string
          name: string
          credits: number
          email: string
        }
        Insert: {
          id: string
          created_at?: string
          name: string
          credits?: number
          email: string
        }
        Update: {
          id?: string
          created_at?: string
          name?: string
          credits?: number
          email?: string
        }
      }
      dream_analyses: {
        Row: {
          id: string
          created_at: string
          user_id: string
          dream_content: string
          analysis: string
        }
        Insert: {
          id?: string
          created_at?: string
          user_id: string
          dream_content: string
          analysis: string
        }
        Update: {
          id?: string
          created_at?: string
          user_id?: string
          dream_content?: string
          analysis?: string
        }
      }
    }
  }
}

# =================================================================
# Arquivo: .\pages\api\interpret-dream.ts
# =================================================================

import type { NextApiRequest, NextApiResponse } from 'next';

type Data = {
  interpretation?: string;
  error?: string;
};

export default async function handler(
  req: NextApiRequest,
  res: NextApiResponse<Data>
) {
  if (req.method !== 'POST') {
    res.setHeader('Allow', 'POST');
    return res.status(405).json({ error: 'Method not allowed' });
  }

  const { dream } = req.body;

  if (!dream || typeof dream !== 'string') {
    return res.status(400).json({ error: 'Invalid dream input' });
  }

  try {
    // Call to n8n webhook or serverless function that integrates with GPT-4
    // For MVP, simulate the call here or replace with actual fetch to n8n endpoint

    // Example: Replace with your actual n8n webhook URL
    const n8nWebhookUrl = process.env.N8N_WEBHOOK_URL;
    if (!n8nWebhookUrl) {
      return res.status(500).json({ error: 'N8N webhook URL not configured' });
    }

    const response = await fetch(n8nWebhookUrl, {
      method: 'POST',
      headers: {
        'Content-Type': 'application/json',
      },
      body: JSON.stringify({ dream }),
    });

    if (!response.ok) {
      throw new Error('Failed to get interpretation from n8n');
    }

    const data = await response.json();

    // Assuming n8n returns { interpretation: string }
    return res.status(200).json({ interpretation: data.interpretation });
  } catch (error: any) {
    return res.status(500).json({ error: error.message || 'Internal server error' });
  }
}


# =================================================================
# Arquivo: .\scripts\compile_project_knowledge.py
# =================================================================

import os

# List of files to include in the knowledge compilation
files_to_compile = [
    "pages/api/interpret-dream.ts",
    "app/page.tsx",
    "app/(dashboard)/dashboard/decoder/page.tsx",
    "lib/services/dream-service.ts",
    "lib/services/profile-service.ts",
    "lib/types/database.types.ts",
    "types/dreams.ts",
    "lib/config/constants.ts",
    "lib/utils.ts",
    "components/chat/voiceflow-chat.tsx",
    "app/(dashboard)/dashboard/journal/page.tsx",
    "components/journal/dream-journal.tsx",
    "components/journal/dream-card.tsx",
    "components/journal/dream-grid.tsx",
    "components/journal/tag-selector.tsx"
]

def compile_files(base_path: str, output_file: str):
    with open(output_file, "w", encoding="utf-8") as outfile:
        for file_path in files_to_compile:
            full_path = os.path.join(base_path, file_path)
            if os.path.exists(full_path):
                with open(full_path, "r", encoding="utf-8") as infile:
                    content = infile.read()
                outfile.write(f"// ===== File: {file_path} =====\\n")
                outfile.write(content)
                outfile.write("\\n\\n")
            else:
                outfile.write(f"// ===== File: {file_path} NOT FOUND =====\\n\\n")

if __name__ == "__main__":
    # Adjust base_path if running from a different directory
    base_path = os.path.dirname(os.path.abspath(__file__)) + "/../"
    output_file = os.path.join(base_path, "compiled_project_knowledge.txt")
    compile_files(base_path, output_file)
    print(f"Compiled knowledge written to {output_file}")


# =================================================================
# Arquivo: .\types\dreams.ts
# =================================================================

export type DreamMood = 'positive' | 'neutral' | 'negative';

export interface Symbol {
  name: string;
  category: string;
  relevance: number;
  occurrences: number;
  description: string;
}

export interface Connection {
  dreamId: number;
  date: string;
  commonSymbols: Symbol[];
  strength: number;
}

export interface Dream {
  id: number;
  date: string;
  content: string;
  analysis: string;
  mood: DreamMood;
  clarity: number;
  symbols: Symbol[];
  hasConnections: boolean;
  connections?: Connection[];
  lunarPhase: string;
  dayOfWeek: string;
  sleepQuality: number;
  insights: number;
  patterns: string[];
}
